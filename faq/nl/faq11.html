<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>11 - Prestatie Tuning</title>

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta name="description" content="the OpenBSD FAQ page">
<meta name="keywords" content="openbsd,faq">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1998-2009 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">

<a href="../../nl/index.html">
<img alt="[OpenBSD]" src="../../images/smalltitle.gif" border="0" height="30" width="141">    
</a>
<p>
<font color="#0000e0">
<a href="index.html">[FAQ Index]</a>
<a href="faq10.html">[Naar Sectie 10 - Systeembeheer]</a>
<a href="faq12.html">[Naar Sectie 12 - Hardware- en Platform-Specifieke Vragen]</a>
</font>

<h1><font color="#e00000">11 - Het X Window Systeem</font></h1>
<hr>

<p>
<h3>Inhoudsopgave</h3>
<ul>
<li><a href="#Intro">11.1 - Introductie van X</a>
<li><a href="#ConfigX">11.2 - Configuratie van X</a>
<li><a href="#amd64i386">11.3 - Configuratie van X op amd64 en i386</a>
<li><a href="#StartingX">11.4 - Starten van X</a>
<li><a href="#CustomizingX">11.5 - Aanpassen van X</a>
<!-- li><a href="#XF86">11.9 - Uw monitorresolutie tunen onder X</a -->
</li>
</ul>

<hr>

<p>
<a name="Intro"></a>

<h2>11.1 - Introductie van X</h2>

Het X Window System (soms slechts "X" genoemd, soms ook, echter onjuist,
genoemd "X Windows") is de omgeving die grafische services aan OpenBSD
en andere Unix-gebaseerde systemen aanbiedt.
Echter, op zichzelf biedt X erg weinig: men heeft ook een "Window Manager"
nodig om een gebruikersinterface te presenteren.
Het meerendeel van de "persoonlijkheid" die men merkt aan X komt van de
window manager en niet van X zelf.
OpenBSD levert een vrije versie van de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fvwm&amp;sektion=1">fvwm(1)</a>
window manager, maar u mag ook aan van de andere window manager gebruiken die
beschikbaar zijn als <a href="faq15.html">package</a>.
Zoek met "<tt>window manager</tt>" als sleutel naar een lijst van de vele
beschikbare window managers.

<p>
X wordt beschouwd als een "client-server" gesstrucuteerd protocol, maar de
terminologie is soms verwarrend.
De computer met de grafische elementen op het scherm is de "X Server".
De applicatie die bepaalt wat de X server op het scherm moet zetten
is de "X Client", ook al kan deze een veel krachtiger computer in een
datacenter zijn.
Dit model kan worden gebruikt om grote, processor-intensieve applicaties
(X clients) te draaien op een zeer krachtige machine, met als X server
een kleine, weinig energie verbruikende machine op uw bureau als interface
naar de gebruiker.

<p>
Het is mogelijk om X clients te draaien op systemen zonder enige grafische
ondersteuning.
Bij voorbeeld, men kan een applicatie (de X client) draaien op een mvme88k
met uitvoer op het grafische scherm van een alpha (de X server).
Omdat X een goed-gedefinieerd, cross-platform protocol is, is het zelfs
mogelijk om een X applicatie op (bijvoorbeeld) een Solaris machine, een
OpenBSD machine te laten gebruiken als beeldscherm.

<p>
De client en machine kunnen ook draaien op dezelfde machine en voor
de rest van deze sectie wordt daar ook vanuit gegaan.


<h3>11.1.1 - Hoe snel moet mijn computer zijn om X te draaien?</h3>
X zelf is een behoorlijk groot programma en een snelle computer zal worden
gewaardeerd als het regelmatig gestart en gestopt wordt.
Echter, als het draait, reageert het tamelijk vlot op een bescheiden
computer.
Op sommige platformen zult u zeker X willen gebruiken, ook voor alleen
maar tekst, om er vlot mee te kunnen werken.
Deze platformen, zoals <a href="../../sparc.html">sparc</a> en
<a href="../../sparc64.html">sparc64</a>, zijn ontworpen om te worden gebruikt
met een grafische interface en de prestaties van de tekst console is erg
slecht.

<p>
Dat gezegd hebbende, is het doel van X normaliter om X applicaties te
draaien.
Sommige X applicaties zijn erg slank, andere lijken de complete processer
en al het geheugen te gebruiken dat je ze maar kunt geven.
Natuurlijk zijn er gebruikers die alleen maar X draaien om een groot aantal
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xterm&amp;sektion=1">xterm(1)</a>s
te kunnen gebruiken, wat met zeer bescheiden hardware mogelijk is.

<h3>11.1.2 - Heb ik X nodig voor grafische uitvoer?</h3>
Ervanuitgaande dat je
<a href="http://en.wikipedia.org/wiki/ASCII_Art">ASCII graphics</a>
niet accepteert, heb je voor grafische uitvoer minstens een stuurprogramma
nodig voor een framebuffer console.
Dat kan bij sommige besturingssystemen, maar momenteel beschikt
OpenBSD daar niet over en er is onder de ontwikkelaars ook weinig
behoefte aan.


<a name="ConfigX"></a>
<h2>11.2 - Configuratie van X</h2>
De configuratie van X varieert behoorlijk van platform tot platform.
Er staan in ieder geval instructies en andere platform-specifieke informatie
in <tt>/usr/X11R6/README</tt> op het geïnstalleerde systeem.

<p>
Verschillende platformen hebben het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xf86&amp;sektion=4">xf86(4)</a>
X aperture stuurprogramma nodig, dat toegang geeft tot het geheugen en de
I/O poorten van de VGA-kaart en de PCI-configuratieregisters die nodig zijn
voor de X servers.
Dit stuurprogramma moet ingeschakeld worden voordat het wordt gebruikt,
ofwel door "yes" te antwoorden op de volgende vraag tijdens de installatie:

<blockquote><pre>
Do you expect to run the X window System [no]
</pre></blockquote>

ofwel door de waarde van <tt>machdep.allowaperture</tt> in
<tt>/etc/sysctl.conf</tt> te wijzigen in de waarde die voor uw platform van
toepassing is en de machine te herstarten (deze sysctl kan na het volledig
opstarten niet meer gewijzigd worden om veiligheidsredenen).
Dit heeft consequenties voor de veiligheid, dus doe dit niet als het niet
nodig is.



<h3>11.2.1 - alpha</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.alpha"
>/usr/X11R6/README</a> voor alpha.

<p>
Zet <tt>machdep.allowaperture=1</tt> in <tt>/etc/sysctl.conf</tt>.

<p>
De TGA and sommige VGA kaarten worden ondersteund.
Er zou geen aanvullende configuratie nodig moeten zijn.

<h3>11.2.2 - amd64</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.amd64"
>/usr/X11R6/README</a> voor amd64.


<p>
Zet <tt>machdep.allowaperture=2</tt> in <tt>/etc/sysctl.conf</tt>.

<p>
X op amd64 configureert zichzelf vaak zeer succesvol, dus aanvullende
configuratie is meestal niet nodig.
Indien aanvullende configuratie nodig is, gebruik dan het
<a href="#amd64i386">X&nbsp;-configure</a>
proces <a href="#amd64i386example">hieronder</a>.

<h3>11.2.3 - armish</h3>

Geen X servers, alleen X clients.

<h3>11.2.4 - hp300</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.hp300"
>/usr/X11R6/README</a> voor hp300.

<h3>11.2.5 - hppa</h3>
Geen X servers, alleen X clients.

<h3>11.2.6 - i386</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.i386"
>/usr/X11R6/README</a> voor i386.

<p>
Zet <tt>machdep.allowaperture=2</tt> in <tt>/etc/sysctl.conf</tt>.


<p>
Vanwege het ongelooflijk grote aantal videokaarten, muizen, toetsenborden en
andere hardware, kan het configureren van een i386 systeem een uitdaging zijn.
Uitdagend genoeg om er een <a href="#amd64i386">afzonderlijke paragraaf</a>
aan te wijden.

<p>
Gelukkig zijn de dingen niet altijd zo slecht als ze eruit zien -- in veel
gevallen "werkt het gewoon" als je "startx" intypt.
In deze gevallen wordt uw hardware gedetecteerd en ondervraagd naar zijn
mogelijkheden en draait X zeer goed.


<h3>11.2.7 - landisk</h3>
Geen X servers, alleen X clients.

<h3>11.2.8 - luna88k</h3>
Geen X servers, alleen X clients.

<h3>11.2.9 - mac68k</h3>
Geen X servers, alleen X clients.

<h3>11.2.10 - macppc</h3>

<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.macppc"
>/usr/X11R6/README</a> voor macppc.
   
<p>
Zet <tt>machdep.allowaperture=2</tt> in <tt>/etc/sysctl.conf</tt>.

<p> 
De ondersteunde PPC systemen kunnen draaien op twee verschillende manieren:
"geaccellereerd" en "framebuffer" (niet geaccellereerd).

<p>
In de "framebuffer" modus zal het systeem draaien met 8 bits per pixel en
wordt de videoresolutie bepaald door de Macintosh-omgeving, dus zult u
een klein MacOS gedeelte op uw harde schijf willen behouden om deze
instellingen te kunnen wijzigen.
Deze modus heeft als voordeel dat "het gewoon werkt", maar het kan
frustrerend inflexibel zijn (het kan bijvoorbeeld nodig zijn om MacOS
op te starten om de resolutie te veranderen).

<p>
Indien uw Macintosh een ATI-gebaseerde videokaart heeft, kan het draaien
met een geaccellereerde X server, wat betere prestaties geeft en meer controle
vanuit de OpenBSD omgeving.
De NVIDIA videokaarten in sommige macppc-systemen zullen in veel gevallen
ook werken.
Het README bestand bevat details over het configureren van het geaccellereerde
stuurpgroramma, begin met het voorbeeld bestand daarin.

<p>
Alhoewel het README bestand details geeft om de standaard één-knops-muis
te gebruiken met X, heeft het de sterke voorkeur om een moderne USB-muis
te kopen van een derde partij, tenzij u een laptop gebruikt.


<h3>11.2.11 - mvme68k</h3>
Geen X servers, alleen X clients.

<h3>11.2.12 - mvme88k</h3>
Geen X servers, alleen X clients.

<h3>11.2.13 - sgi</h3>
X draait op de frame buffer van O2 systemen in niet-geaccellereerde mode.

<h3>11.2.14 - sparc</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.sparc"
>/usr/X11R6/README</a> voor sparc.

<p>
Met een enkele ondersteunde framebuffer is er geen configuratie nodig.
Indien u een configuratie met meerdere beeldschermen wilt gebruiken,
raadpleeg dan het README bestand voor details.

<p>
De resolutie wordt bepaald door de firmware voor het starten van OpenBSD.

<h3>11.2.15 - sparc64</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.sparc64"
>/usr/X11R6/README</a> voor sparc64.

<p>
Er zijn een aantal varianten van deze machines, u dient te weten welke
bus uw systeem heeft (PCI of SBus), op welke poort uw muis is aangesloten
(zstty, com, of USB/PS2) en welke soort videokaart u heeft.
Begin met het voorbeeld <tt>xorg.conf</tt> bestand in het <tt>README</tt>
bestand en pas het aan zoals aangegeven voor uw daadwerkelijke hardware en
behoefte.
<i>Verwacht niet dat het voorbeeldbestand zonder aanpassingen werkt
op uw machine!</i>

<h3>11.2.16 - vax</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.vax"
>/usr/X11R6/README</a> voor vax.

<p>
Momenteel werkt de X server alleen op VAXstation 4000 modellen met een
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lcg&amp;sektion=4&amp;arch=vax">lcg(4)</a>
of een
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lcspx&amp;sektion=4&amp;arch=vax">lcspx(4)</a>
framebuffer.

<h3>11.2.17 - zaurus</h3>
<a href="http://www.openbsd.org/cgi-bin/cvsweb/~checkout~/xenocara/distrib/notes/README.zaurus"
>/usr/X11R6/README</a> voor zaurus.

<p>
Geen configuratie nodig, X "werkt gewoon".


<p>
<a name="amd64i386"></a>
<h2>11.3 - Configuratie van X op amd64 en i386</h2>
De variëteit van hardwareopties op deze platformen maakt het configuratieproces
van X "lastig".

<h3>11.3.1 - X.Org configuratie</h3>
X.Org heeft veel vooruitgang geboekt met ervoor zorgen dat hun X servers
"gewoon werken".
In veel gevallen werkt het gewoon zonder een <tt>/etc/X11/xorg.conf</tt>
bestand.
Maar niet altijd en soms wilt u iets dat werkt toch aanpassen.

<p>
Er zijn twee programma's die gebruikt kunnen worden om half-automatisch een
configuratiebestand te maken voor de i386 X servers van X.org.
Helaas heeft u bij allebei geen garantie dat er een bruikbaar xorg.conf
bestand gecreëerd wordt.


<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=Xorg&amp;sektion=1">Xorg(1)</a>
gedraaid in de "X -configure" modus, laadt alle beschikbare
video-stuurprogramma's, zoekt naar andere hardware en schrijft een xorg.conf
bestand, gebaseerd op wat er wordt gevonden.  Dit bestand kan wel of niet
werken, maar al werkt het niet dan kan het een nuttig startpunt zijn om
er een vanaf nul te creëren.

<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xorgconfig&amp;sektion=1">xorgconfig</a>
is een ander programma dat probeert om interactief een xorg.conf bestand te
creëren in een puur tekst-gebaseerde applicatie.

</ul>

Naast bovenstaande applicaties, is er nog een manier die zichzelf in de loop
der tijd heeft bewezen: speur met je favoriete zoekmachine naar iemand die
hetzelfde probleem al een keer heeft opgelost.
Ook al is dat geen slechte manier, we besteden er hier geen verdere aandacht
aan.

<p>

<a name="amd64i386example"></a>
<h3>11.3.2 - Onze voorbeeldmachine</h3>
Als demonstratie voor het instellen van X, zullen we een oud Celeron 400MHz
systeen gebruiken met een AGP video slot.
De videokaart is een oude AGP-kaart, die in de dmesg getoond wordt als:

<blockquote><pre>
vga1 at pci1 dev 0 function 0 "3DFX Interactive Banshee" rev 0x03
</pre></blockquote>

Dit is kaart die ooit high-end was, met 16M RAM, maar die nu meestal
niet meer ondersteund wordt op moderne versie van de gebruikelijke
besturingssystemen.
De monitor die met dit systeem is verbonden is een Sony Multiscan
G400 19" beeldscherm en het zou prettig zijn om dit scherm te gebruiken
met een resolutie van 1280x1024 bij een fatsoenlijke verversingsfrequentie
en 24 bit kleur.

<p>
Laten we om te beginnen, na het installeren van OpenBSD met X (en ervoor
te zorgen dat het aperture stuurprogramma is ingeschakeld in de kernel),
eens kijken wat de autodetectie en configuratie van X.Org doen.  We kunnen
tenslotte geluk hebben.
Dus loggen we simpelweg in en gebruiken het commando
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=startx&amp;sektion=1">startx(1)</a>.
Het scherm wordt enkele tellen zwart, daarna krijgen we de geblokte
achtergrond van X, de "X" cursor en vervolgens een xterm venster.

<p>
Het werkt!

<p>
Min of meer.
Hoewel het systeem volledig functioneert, lijkt het erop dat het niet de
mogelijkheden van de monitor heeft gevonden en draait het duidelijk op
een lage resolutie (640x480).
Dat zou toch beter moeten kunnen.
Veel beter.
Dat betekent echter wel dat we ons eigen xorg.conf bestand moeten maken.

<p>
We gebruiken het "X -configure" proces om een <tt>xorg.conf</tt> bestand
aan te maken om mee te starten.
U zult dit moeten doen als root:
<blockquote><pre>
# <b>X -configure</b>

 [...]
Your xorg.conf file is /root/xorg.conf.new

To test the server, run 'X -config /root/xorg.conf.new'
</pre></blockquote>

Overigens is deze melding serieus -- gebruik het volledige pad naar uw
<tt>xorg.conf.new</tt> bestand, ook al staat het in de huidige
directory.
Als u dat niet doet, zal
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=X&amp;sektion=7">X(7)</a>
het bestand niet vinden en zal het stilletjes de standaardconfiguratie
gebruiken die niets te maken heeft met het bestand waar u aan werkt.
Dit kan het foutzoeken behoorlijk verstoren.
Vertrouw ons hierin.

<p>
Laten we doen wat er staat en kijken wat er gebeurt:
<blockquote><pre>
# <b>X -config /root/xorg.conf.new</b>

</pre></blockquote>

Nu krijgen we alleen een zwart scherm.
En het begon nog wel zo goed...

<p>
Dit is een goed moment om iets te vertellen over de manieren
om X af te sluiten als het op deze manier gestart is.
In volgorde van voorkeur:
<ul>
<li><b>CTRL-ALT-Backspace</b>:  Dit zorgt er hopenlijk voor dat X direct
wordt afgesloten, met alle X applicaties die draaien.
Uiteraard zijn er tijdens het configuratieproces nog geen draaiende
applicaties, dus dat is geen probleem (feitenlijk is het op dit moment
de <i>beste</i> manier om X af te sluiten).
<li><b>SSH naar de machine</b> en
"<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkill&amp;sektion=1">pkill</a>
Xorg", wat het X process kan beëindigen en u terugbrengt naar een bruikbare
console.
<li><b>SSH naar de machine</b> en start opnieuw op.

<li><b>Reset of de aan/uit-knop.</b>  Soms gaat het echt mis.
Ja, het is meestal een goed idee om X draaiend te krijgen voordat u
kritische apllicaties op het systeem start.
Soms zorgt een slechte X configuratie ervoor dat het volledige systeem
hangt tot op het punt dat alleen een harde reset het probleem kan
verhelpen.
</ul>

Gelukkig werkt CTRL-ALT-Backspace in ons geval en keren we terug
naar de commando prompt.
Nu moeten we dus uitzoeken wat er mis is.
Om te beginnen zouden we moeten kijken naar wat er volgens Xorg gebeurt
en dat wordt opgeslagen in het bestand <tt>/var/log/Xorg.0.log</tt>.
In dit geval lijkt het erop dat X denkt dat alles in orde is, er zijn
geen duidelijke foutmeldingen in het logbestand (regels die beginnen met
"<tt>(EE)</tt>" zijn foutmeldingen).

<p>
Op dit moment komt het van pas dat u uw hardware kent.
Als we een andere monitor op dit systeem aansluiten terwijl het zwarte
beeld zichtbaar is, dan zien we een "Sync. Out of Range" melding op het
scherm.
Blijkbaar draait de configuratie die X ons gaf niet op deze monitor
en mogelijk op GEEN ENKELE monitor, als er een videomode geselecteerd is
die niet mogelijk is op dit type kaart (denk eraan dat X naar de chip
op de kaart kijkt en wat deze zou moeten kunnen, niet hoe de fabrikant
het samengevoegd heeft).
Verschillende monitoren gedragen zich verschillend als de timing compleet
verkeerd is, sommigen doen een poging om te laten zien wat ze kunnen,
andere gaan in een energiebesparingsstand, enkele maken verschrikkelijke
geluiden en sommigen laten nuttige meldingen op het scherm zien.
Deze monitor blijkt geen van allen te doen.
Er is een notitie gemaakt om deze monitor NIET meer te gebruiken voor de
initiële configuratie van X.

<p>
Kijkend naar het gegenereerde xorg.conf.new bestand, dan zien we het volgende:
<blockquote><pre>
Section "Monitor"
        #DisplaySize      370   270     # mm
        Identifier   "Monitor0"
        VendorName   "SNY"
        ModelName    "SONY CPD-G400"
 ### Comment all HorizSync and VertSync values to use DDC:
        HorizSync    30.0 - 107.0
        VertRefresh  48.0 - 120.0
        Option      "DPMS"
EndSection
</pre></blockquote>

Laten we proberen om DDC ("Data Display Channel", een manier om de monitor
aan de computer en videokaart te vertellen wat zijn mogelijkheden zijn) te
gebruiken als test en kijken wat er gebeurt.
Deze keer zien we het X maaspatroon en een bewegende cursur, wat alles is
wat we verwachten als we X op deze manier starten (we beëindigen X met de
CTRL-ALT-Backspace truuk van hierboven).
Het is (alweer) een erg lage resolutie, maar het werkt en dus kunnen we
er vrij zeker van zijn dat we een timing en resolutieprobleem hebben.
We zetten de "HorizSync" en "VertRefresh" regels terug zoals ze waren,
aangezien we de specificaties van de monitor hebben geverifieerd met
behulp van enig zoekwerk op Internet.

<p>
Laten we proberen om Xorg te dwingen een bepaalde resolutie te gebruiken
en zien of we geluk hebben.
In het <tt>Section "Screen"</tt> gedeelte van het xorg.conf bestand willen
we een aantal regels toevoegen.
De toegevoegde regels zijn vetgedrukt:

<blockquote><pre>
Section "Screen"
        Identifier "Screen0"
        Device     "Card0"
        Monitor    "Monitor0"
<b>        DefaultDepth   24</b>
        SubSection "Display"
                Viewport   0 0
                Depth     1
        EndSubSection
        SubSection "Display"
                Viewport   0 0
                Depth     4
        EndSubSection
        SubSection "Display"
                Viewport   0 0
                Depth     8
        EndSubSection
        SubSection "Display"
                Viewport   0 0
                Depth     15
        EndSubSection
        SubSection "Display"
                Viewport   0 0 
                Depth     16
        EndSubSection
        SubSection "Display"
                Viewport   0 0
                Depth     24
<b>                Modes	"1280x1024"</b>

        EndSubSection
EndSection
</pre></blockquote>

Deze twee wijzigingen vertellen X dat we een 24 bit schermdiepte willen
gebruiken en voor 24 bit diepte willen we een resolutie van 1280x1024.
Aangezien er geen andere resolutie is gegeven voor "Depth 24" wordt het
systeem gedwongen om die resolutie te gebruiken.

<p>
We testen het als hierven, en ... SUCCES!
We hebben op het oog een heel mooi, hoge resolutie beeldscherm.
Merk op dat ALLES wat we verwachten een maaspatroon is (zeer goed om te zien
hoe goed een monitor ECHT is en ook geweldig om LCD-schermen te calibreren,
genaamd het
"<a href="http://www.openbsd.org/cgi-bin/cvsweb/xenocara/data/bitmaps/root_weave">root
weave</a>") en een beweegbare cursor.
Het is niet bedoeld om functioneel te zijn op dit moment.

<p>
Nu willen we het xorg.conf bestand installeren zodat we kunnen zien of
X ook op de gebruikelijke manier goed draait.

<blockquote><pre>
# cp xorg.conf.new /etc/X11/xorg.conf
</pre></blockquote>

We kunnen nu X proberen met het normale startx(1) commando.
Het werkt!

<p>
Het zou waarschijnlijk goed zijn om te verifiëren of we de resolutie en
kleurdiepte hebben die we wensen en ook dat we draaien met een aanvaardbare
verversingsfrequentie.
Dat kunnen we doen met de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xrandr&amp;sektion=1">xrandr(1)</a>
en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdpyinfo&amp;sektion=1">xdpyinfo(1)</a>
commando's.
xdpyinfo(1) vertelt ons onder andere:
<blockquote><pre>
    [...]
screen #0:
  print screen:    no
  dimensions:    1280x1024 pixels (433x347 millimeters)
  resolution:    75x75 dots per inch
  depths (7):    24, 1, 4, 8, 15, 16, 32
  root window id:    0x44
  depth of root window:    24 planes
    [...]
</pre></blockquote>

Dus ja, we draaien op 1280x1024 met een diepte van 24 planes (bits).

<p>
xrandr(4) vertelt ons:
<blockquote><pre>
 SZ:    Pixels          Physical       Refresh
*0   1280 x 1024   ( 433mm x 347mm )  *85   75   60  
 1   1280 x 960    ( 433mm x 347mm )   85   60  
    [...]
</pre></blockquote>

dat ons vertelt dat we draaien met een verversingsfrequentie van 85 Hz, dus
dat zou een zeer comfortabele instellingen moten zijn voor de meeste
gebruikers.

<p>
<h3>11.3.3 - Wat als het niet zo "makkelijk" is?</h3>
Soms werken dingen gewoon niet goed samen.
Hier zijn wat tips.

<ul>
<li>Lees de man pagina voor de X server die u gebruikt.
In ons voorbeeld laat <tt>/var/log/Xorg.0.log</tt> zien dat X
het TDFX stuurprogramma gebruikt, dus dat zou de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tdfx&amp;sektion=4">tdfx(4)</a>
man pagina zijn.
U vindt vaak tips, beperkingen en opties om uw videokaart te configureren.
Deze variëren van stuurprogramma tot stuurprogramma, dus neem niet aan dat
u de man pagina niet hoeft te lezen voor het stuurprogramma dat u nu
gebruikt omdat u eerder een andere hebt gelezen.

<li>Probeer andere monitoren.
Zoals we in ons voorbeeld hebben ontdekt, geven andere monitoren vaak
aanwijzigen over wat er mis kan zijn.

<li>Probeer het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vesa&amp;sektion=4">vesa(4)</a>
X stuurprogramma.
Dit is absoluut een "laatste keus" vanwege de prestaties, maar het werkt
op bijna alle videokaarten, inclusief degenen waarbij de "betere" X server
stuurprogramma's het niet doen.

<li>Gebruik andere hardware.
Indien u een keus hebt met betrekking tot de videokaart, probeer dan enkele
andere kaarten.


</ul>

<a name="StartingX"></a>
<h2>11.4 - Starten van X</h2>
Er zijn twee gebruikelijke manieren om X te draaien:

<h3>11.4.1 - Indien Nodig:</h3>
Log in op een console zoals gebruikelijk, type dan
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=startx&amp;sektion=1">startx(1)</a>.

<h3>11.4.2 - Boot rechtstreeks in X:</h3>
Dit wordt gedaan met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&amp;sektion=1">xdm(1)</a>,
de X Display Manager.
xdm(1) wordt gestart als root, normaliter door <a href="faq10.html#rc">rc</a>,
en geeft een login prompt.
Na succesvol inloggen, wordt er een X sessie gestart voor die gebruiker.
Indien die X sessie wordt beëindigd (inclusief drukken op
CTRL-ALT-Backspace), dan zal xdm(1) terugkeren en opnieuw vragen om in te
loggen.
Probeer daarom NIET om xdm(1) te starten vanuit
<tt>/etc/rc.conf.local</tt> totdat je geverifieerd hebt dat X werkt zoals
gewenst of het wordt zeer moeilijk om uw machine te beheren!
(in het slechtste geval: boot single user, alsof u <a href="faq8.html#LostPW">
uw wachtwoord vergeten bent</a> en verwijder de xdm_flags regel in uw
<tt>/etc/rc.conf.local</tt> bestand.)

<p>
Op sommige platformen moet u de console
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=getty&amp;sektion=8">getty(8)</a>
uitschakelen om xdm(1) te kunnen gebruiken.


<a name="CustomizingX"></a>
<h2>11.5 - Aanpassen van X</h2>

<h3>11.5.1 - Introductie</h3>
De standaard X omgeving van OpenBSD functioneert volledig, maar u wilt
deze wellicht aanpassen.
U wilt misschien het achtergrondpatroon of de kleur aanpassen, of u wilt
de Window Manager veranderen (het programma dat uw X omgeving bepaalt), of
de applicaties die worden gestart wanneer X start.

<p>
De standaard window manager in OpenBSD is
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fvwm&amp;sektion=1">fvwm(1)</a>.
Fvwm is een goede window manager voor algemeen gebruik, maar het is zelden uw
enige keus; het is niet eens de enige window manager die met OpenBSD wordt
meegeleverd (zie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwm&amp;sektion=1">cwm(1)</a>
en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=twm&amp;sektion=1">twm(1)</a>).
Een groot aantal window managers is ook beschikbaar als
<a href="faq15.html">package</a>.

<p>
Net als het <a href="faq10.html#rc">system startup script</a>, heeft
X een proces dat wordt doorlopen om de gebruikersomgeving in te stellen.
Beter gezegd, het heeft meer dan een proces; welk proces wordt gebruikt
hangt af van hoe u <a href="#StartingX">X start</a>.
Het begrijpen van de wijze waarop X start helpt om te begrijpen hoe u uw
werkomgeving kunt aanpassen aan uw eigen wensen.

<p>
Merk op dat u de omgeving kunt aanpassen zowel op een systeembreed als
op een gebruikersniveau.
Het is waarschijnlijk beter om op gebruikersniveau veranderingen door
te voeren dan om de systeeminstallingen te wijzigen, aangezien de
scripts van de gebruiker in zijn eigen homedirectory worden opgeslagen,
dus u heeft minder bestanden samen te voegen als u uw OpenBSD versie
upgradet.

De systeembrede instellingen staan in <tt>/etc/X11</tt> en zijn oorspronkelijk
afkomstig van <a href="faq4.html#FilesNeeded">xetcXX.tgz</a>, die niet wordt
overschreven bij het <a href="../upgrade46.html">aanbevolen upgrade proces</a>,
dus als u systeembrede instellingen wijzigt blijven ze behouden, maar u moet
deze wellicht samenvoegen met latere versie van bestanden.



<h3>11.5.2 - startx(1) startup</h3>
startx(1) zoekt naar het bestand <tt>.xinitrc</tt> in de homedirectory
van de gebruiker.
<tt>.xinitrc</tt> is normaal gesproken een shell script, dat zoveel
X "client" (applicaties die X gebruiken) programma's als gewenst kan starten.
Als dit script eindigt, wordt de X server gestopt.
In het algemeen worden de meeste programma's vanuit dit script in de
achtergrond gestart, de laatste moet echter op de voorgrond draaien
(normaal gesproken de window manager).  Als deze afsluit, eindigt het
script en wordt X afgesloten.

<p>
In het simpelste geval kan dit zo kort zijn als slechts de naam van de
window manager die u wilt gebruiken:

<blockquote><pre>
cwm
</pre></blockquote>

U kunt het ook wat sjieker maken:

<blockquote><pre>

xconsole -geometry -0+0 -fn 5x7 &
oclock -geometry 75x75-0-0 &
xsetroot -solid grey &
cwm
</pre></blockquote>

Dit start de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xconsole&amp;sektion=1">xconsole(1)</a>
die een kopie laat zien van alle tekst die de kernel naar de console stuurt
(die nu bedekt is door het grafische scherm), een analoge klok
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=oclock&amp;sektion=1">oclock(1)</a>,
en zet de achtergrond op een volledige grijze achtergrond met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xsetroot&amp;sektion=1">xsetroot(1)</a>
allemaal voor het aanroepen van de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cwm&amp;sektion=1">cwm(1)</a>
window manager.
Merk op dat slechts de window manager niet in de achtergrond is gestart met
een "&amp;" karakter.
Dit betekent dat X blijft draaien totdat cwm(1) afsluit.

<p>
Indien de homedirectory van een gebruiker geen <tt>.xinitrc</tt> bestand heeft,
wordt het <tt>/etc/X11/xinit/xinitrc</tt> bestand van het systeem gebruikt.
Dit bestand kan u enkele aanvullende ideeën voor uw .xinitrc script geven.


<h3>11.5.3 - xdm(1) startup</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xdm&amp;sektion=1">xdm(1)</a>
wordt meestal gestart door het <a href="faq10.html#rc">system startup
script</a>, maar voor testdoeleinden (aanbevolen, totdat u weet dat u X
goed heeft geconfigureerd) kan het als root worden gedraaid.


<p>
xdm(1) heeft veel andere functionaliteiten die we hier niet aanstippen,
maar voor ons doel presenteert xdm de gebruiker een loginscherm, ontvangt
en controleert een gebruikersnaam en wachtwoord en geeft de gebruiker
vervolgens zijn X omgeving.
Als X afsluit, bewust of per ongeluk, zal xdm het opnieuw starten.
Dit is de reden dat u zeker wilt zijn dat X goed is geconfigureerd voordat
xdm(1) wordt gestart, en zeker voordat xdm(1) bij het booten wordt gestart,
anders kan het lastig zijn om de machine onder controle te krijgen.

<p>
Als xdm(1) start, wordt <tt>/etc/X11/xdm/Xsession</tt> gestart, wat
controleert of de gebruiker een <tt>.xsession</tt> bestand in zijn
homedirectory heeft.
Dus als u uw standaard window manager wilt wijzigen, roep hem dan simpelweg
aan in <tt>.xsession</tt> (en wellicht ook andere dingen).
Alle programma's die u met X wilt starten (bijvoorbeeld drie xterm(1)s)
kunt u hier plaatsen, maar ze moeten allemaal in de achtergrond worden
gestart op de window manager na, omdat, ook hier, X afsluit wanneer
de window manager afsluit.
In dit geval zal xdm(1) X herstarten en u terugvoeren naar het loginscherm.

<h3>11.5.4 - Een nieuwe window manager proberen</h3>
U kunt als volgt een specifieke window manager aanroepen wanneer u X start
zonder enige instelling te veranderen:

<blockquote><pre>
$ startx /usr/local/bin/fluxbox
</pre></blockquote>

Verschillende window managers (waaronder cwm(1) and fvwm(1)) bieden de
mogelijkheid om on the fly van window manager te wisselen, zonder X of
een van uw applicaties opnieuw te hoeven starten.
Uw nieuwe window manager vervangt de oude en het afsluiten van de nieuwe
window manager sluit ook X af, het leidt u niet naar uw vorige window
manager.
fvwm(1) laat u een andere window manager starten door met links te klikken
op de achtergrond ("root venster"), "(Re)Start" te kiezen en dan de window
manager van uw keuze te kiezen (merk echter op dat u uw alternatieve
window managers moet toevoegen aan uw <tt>.fvwmrc</tt> bestand (de
systeembrede standaard is <tt>/usr/X11R6/lib/X11/fvwm/.fvwmrc</tt>)).
cwm(1) laat u een andere window manager kiezen door op Ctrl-Alt-w te drukken
en door de naam van de window manager te typen waarnaar u wilt omschakelen.

<p>
Als u eenmaal een window manager heeft gevonden die u bevalt, dan kunt u
deze als het laatste programma in uw startup scripts zetten zoals hierboven
beschreven.



<p>
<!-- a name= "TuningRes"></a>
<h2>11.9 - Uw monitorresolutie tunen onder X</h2>

<i>Opmerking: De meeste gebruikers hoeven zich GEEN zorgen te maken over het
handmatig aanmaken van een ModeLine in moderne versies van X.
NOCHTANS, soms is het nodig voor ongebruikelijke situaties.</i>

<p>
Een X server werkende krijgen bij een aanvaardbare resolutie is met vele
multi-sync monitoren mogelijk.  Als iemand dit heeft proberen te doen met de
standaard xorgconfig of XF86Setup utilities, hebben ze waarschijnlijk niet
de best mogelijke resultaten verkregen. Een van de meer pijnlijke aspecten is
gewoon uw monitor te laten werken met de resolutie die uw voorkeur geniet, en
vervolgens de verticale scansnelheid ingesteld krijgen op ten minste 72-75 Hz,
een snelheid waarbij het schermgeflikker veel minder zichtbaar is voor mensen.
Daarentegen, wat als u de verticale scansnelheid op heel lage waarden probeert
in te stellen?
U kan ze op 50 Hz instellen zodat het op video kan vastgelegd worden zonder
geflikker, maar de methodes om dit te doen zijn niet vanzelfsprekend met de
standaard X tools en documentatie.

<p>
Tenslotte, bij de resoluties die veel mensen gewoonlijk gebruiken met
goedkope VGA monitoren (800x600, 1024x768, 1152x900, 1280x1024), is het
mogelijk (althans op nieuwere monitoren) om verticale scansnelheden van 85Hz en
hoger te gebruiken, om een extreem zuiver, aangenaam beeld te bekomen.
De X server heeft een mechanisme dat u toelaat om in detail de video
modus die u wil gebruiken, dit is de ModeLine, te beschrijven. Een ModeLine
heeft vier secties, een enkel getal voor de pixelklok, vier getallen voor
horizontale timings, vier getallen voor verticale timings, en een optionele
sectie met een lijst vlaggen die andere eigenschappen van de modus
specificeren (zoals Interlace, DoubleScan, en meer... zie de xorg.conf(5)
manual pagina voor meer ModeLine details).

<p>
Een ModeLine genereren is zwarte magie... Gelukkig zijn er verscheidene
scripts die dit voor u kunnen doen. Eén ervan is
<a href="http://koala.ilog.fr/cgi-bin/nph-colas-modelines">
Colas XFree86 ModeLine Generator</a>.  Een ander is
<a href="http://xtiming.sourceforge.net/">The XFree86 Modeline Generator</a>
gehost op SourceForge, en er zijn er verscheidene andere beschikbaar op
<a href="http://freshmeat.net/search/?q=modeline">Freshmeat</a>.
Alvorens u deze ModeLine generators kan gebruiken, moet u de verticale en
horizontale sync limieten voor uw monitor te weten komen. Dit wordt vaak
gedocumenteerd in de handleiding, of op de website van de fabrikant.
Als u geen van die kan vinden, zoek dan gewoon op het web naar het monitor
merk en model, verscheidene mensen zijn zo vriendelijk geweest om lijsten
samen te stellen met deze informatie.

<p>
Stel bijvoorbeeld dat u een Dell D1226H monitor hebt.  U zocht in kwelling
op de website van Dell om te vinden dat hij een 30-95 kHz horizontaal
scanbereik heeft, en een 50-160 Hz verticaal scanbereik.  Bezoek de
ModeLine generator pagina, en voer deze informatie in. Vervolgens moet u de
minimale verticale scan rate ingeven die u wenst. Gelijk welke rate op of
boven 72 Hz zou in het algemeen weinig zichtbaar geflikker moeten hebben.
Naarmate u hoger gaat, wordt het beeld op uw scherm helderder en scherper.

<p>
Met al deze stukjes informatie zal het script een ModeLine genereren voor
elke mogelijke 4x3 resolutie die uw monitor kan ondersteunen, boven de
minimale verticale scan rate die u ingeeft. Als iemand de Dell specs en een
75 Hz verticaal scan minimum ingeeft, geeft het script iets als het volgende:

<pre>
ModeLine "320x240" 20.07 320 336 416 448 240 242 254 280 #160Hz
ModeLine "328x246" 20.86 328 344 424 456 246 248 260 286 #160Hz
...
ModeLine "816x612" 107.39 816 856 1056 1136 612 614 626 652 #145Hz
ModeLine "824x618" 108.39 824 864 1064 1144 618 620 632 658 #144Hz
ModeLine "832x624" 109.38 832 872 1072 1152 624 626 638 664 #143Hz
...
ModeLine "840x630" 109.58 840 880 1080 1160 630 632 644 670 #141Hz
ModeLine "848x636" 110.54 848 888 1088 1168 636 638 650 676 #140Hz
...
ModeLine "1048x786" 136.02 1048 1096 1336 1432 786 788 800 826 #115Hz
ModeLine "1056x792" 136.58 1056 1104 1344 1440 792 794 806 832 #114Hz
ModeLine "1064x798" 137.11 1064 1112 1352 1448 798 800 812 838 #113Hz
...
ModeLine "1432x1074" 184.07 1432 1496 1816 1944 1074 1076 1088 1114 #85Hz
ModeLine "1576x1182" 199.86 1576 1648 2008 2152 1182 1184 1196 1222 #76Hz
ModeLine "1584x1188" 198.93 1584 1656 2016 2160 1188 1190 1202 1228 #75Hz
</pre>

<p>
Nu beweert deze monitor 1600x1200 @ 75 Hz te doen, maar het script zegt niet
dat dit binnen 75 Hz valt.  Dus, als u echt precies 1600x1200 wil, ga dan
een stapje naar beneden met uw minimale verticale rate... (Hier gaan we
naar beneden tot 70 Hz)

<pre>
ModeLine "1592x1194" 197.97 1592 1664 2024 2168 1194 1196 1208 1234 #74Hz
ModeLine "1600x1200" 199.67 1600 1672 2032 2176 1200 1202 1214 1240 #74Hz
ModeLine "1608x1206" 198.65 1608 1680 2040 2184 1206 1208 1220 1246 #73Hz
ModeLine "1616x1212" 197.59 1616 1688 2048 2192 1212 1214 1226 1252 #72Hz
ModeLine "1624x1218" 199.26 1624 1696 2056 2200 1218 1220 1232 1258 #72Hz
ModeLine "1632x1224" 198.15 1632 1704 2064 2208 1224 1226 1238 1264 #71Hz
ModeLine "1640x1230" 199.81 1640 1712 2072 2216 1230 1232 1244 1270 #71Hz
ModeLine "1648x1236" 198.64 1648 1720 2080 2224 1236 1238 1250 1276 #70Hz
</pre>

<p>
Hier zien we dat de monitor echt 1600x1200 @ 74 Hz doet wanneer de dotclock
(bandbreedte) beperkt is tot 200MHz. Stel de bandbreedte in overeenkomstig
de beperkingen gedefinieerd door de monitor.

<p>
Zodra u uw ModeLines hebt, zet ze dan in uw /etc/X11/xorg.conf bestand.
Commentarieer de oude ModeLines, zodat u ze opnieuw kan gebruiken als de
nieuwe niet zouden werken.
Kies vervolgens welke resolutie u eigenlijk wil draaien. Zoek eerst uit of
X in geaccelereerde modus draait (wat het met de meeste videokaarten doet),
zodat u weet welke <tt>"Screen"</tt> sectie van de xorg.conf u moet
wijzigen. Of wijzig gewoon al de Screen secties.

<pre>
Section "Screen"
   Driver          "Accel"
   Device          "Primary Card"
   Monitor         "Primary Monitor"
   DefaultColorDepth 32
   SubSection "Display"
      Depth        32
      Modes        "1280x1024" "1024x768"
   EndSubSection
</pre>

<p>
De eerste resolutie die u ziet na het "Modes" sleutelwoord is de resolutie
waarmee X gaat starten. Door CTRL-ALT-KEYPAD MIN, of CTRL-ALT-KEYPAD PLUS
te drukken kan u omschakelen tussen de resoluties die u hier opgeeft.
Volgens de bovenstaande sectie zal X proberen te starten in 32-bit
kleurenmodus (via het DefaultColorDepth opdracht, zonder dit zal X starten
in 8-bit kleurenmodus.)
De eerste resolutie die het zal proberen gebruiken is 1280x1024 (het volgt de
volgorde van de Modes lijn.)  Merk op dat "1280x1024" gewoon een label is
voor de waarden in de ModeLine.

<p>
Merk op dat het ModeLine generatorscript opties heeft om de timings te
verzwakken voor oudere of kleinere monitoren, en ook de mogelijkheid heeft om
ModeLines voor specifieke resoluties aan te bieden. Afhankelijk van het type
hardware dat u hebt, kan het misschien niet zo gemakkelijk te gebruiken zijn
met de standaardopties. Als het beeld te groot, te breed, of te klein is, of
horizontaal of verticaal verschoven is, en de bediening van de monitor volstaat
niet om het beeld te corrigeren, kan men xvidtune(1) gebruiken om de ModeLine
aan te passen zodat ze beter past bij de timings van de monitor.

<p>
Op de meeste moderne monitoren staat er geen vaste limiet op de bandbreedte,
dus deze worden vaak niet meer vermeld in de specificaties. Wat er gebeurt is
dat hoe hoger u gaat in bandbreedte, hoe waziger het beeld wordt.
Dus u wil misschien de bandbreedte van uw kaart (ook "dotclock" genoemd)
ingeven om te testen (u kan de monitor op deze manier niet beschadigen) en
gestaag lager gaan in bandbreedte om een mooi scherp beeld te bekomen.

<p>
Als dit nodeloos complex lijkt, dan is dat omdat het zo is. X.Org
pakt dit aan, en maakt dit proces veel gemakkelijker omdat het verscheidene
ingebouwde modi heeft en mogelijkheden vanuit "plug en play" monitoren kan
inlezen door DDC en DDC2.

<p>
U kan het Colas XFree86 ModeLine Generator script downloaden op:
<a href="http://koala.ilog.fr/ftp/pub/Klone/">http://koala.ilog.fr/ftp/pub/Klone/</a>.
U moet de Klone interpreter nemen en hem compileren. Deze zit in de ports als
<tt>lang/klone</tt>.  De scripts staan onder de scripts directory in de Klone
distributie. (De port installeert ze naar /usr/local/lib/klone/scripts.)

<p>
Er zijn twee versies van het script inbegrepen, de eerste is een CGI versie
identiek aan de bovenstaande webpagina. De tweede is een niet-CGI versie die
uw volledig xorg.conf bestand neemt, uw monitor specs decodeert die u hebt
ingegeven in xorgconfig/XF86Setup (Denk nu na, hebt u werkelijk de specs voor
uw monitor ingegeven of gewoon de algemene gekozen?),
en de bestaande ModeLines overeenkomstig opknapt.

<p -->
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq10.html">[Naar Sectie 10 - Systeembeheer]</a>
<a href= "faq12.html">[Naar Sectie 12 - Hardware- en Platform-Specifieke Vragen]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[terug]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq11.html,v 1.82 ]<br>
$Translation: faq11.html,v 1.18 2010/02/09 18:16:33 maurice Exp $<br>
-->
$OpenBSD: faq11.html,v 1.16 2010/02/16 09:19:53 ajacoutot Exp $
</small>
</body>
</html>
