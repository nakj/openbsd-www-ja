<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5 - Het Systeem vanaf Broncode Bouwen</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2007 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<a href="../../nl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[Naar Sectie 4 - Installatiegids]</a>
<a href= "faq6.html">[Naar Sectie 6 - Netwerken]</a>
</font>

<h1><font color="#e00000">5 - Het Systeem vanaf Broncode Bouwen</font></h1>
<hr>

<p>
<h3>Inhoudsopgave</h3>
<ul>
<li><a href="#Flavors">5.1 - OpenBSD's Flavors</a>
<li><a href="#WhySrc">5.2 - Waarom zou ik mijn systeem vanaf broncode moeten bouwen?</a>
<li><a href="#Bld">5.3 - OpenBSD vanaf broncode bouwen</a>
<ul>
  <li><a href="#BldOverview">5.3.1 - Overzicht</a>
  <li><a href="#BldBinary">5.3.2 - Installeren of upgraden naar de
    dichtstbijzijnde beschikbare binary</a>
  <li><a href="#BldGetSrc">5.3.3 - De gepaste broncode afhalen</a>
  <li><a href="#BldKernel">5.3.4 - De kernel bouwen</a>
  <li><a href="#BldUserland">5.3.5 - Userland bouwen</a>
</ul>
<li><a href="#Release">5.4 - Een release bouwen</a>
<li><a href="#Xbld">5.5 - X bouwen</a>
<li><a href="#Why">5.6 - Waarom heb ik een op maat gemaakte kernel nodig?</a>
<li><a href="#Options">5.7 - Een op maat gemaakte kernel bouwen</a>
<li><a href="#BootConfig">5.8 - Boot-time configuratie</a>
<li><a href="#config">5.9 - config(8) gebruiken om uw kernel te wijzigen</a>
<li><a href="#VerboseBoot">5.10 - Meer uitgebreide uitvoer bekomen tijdens het
  opstarten</a>
<li><a href="#buildprobs">5.11 - Vaak voorkomende problemen, tips en vragen
  tijdens het compileren en bouwen</a>
   <ul>
   <li><a href="#sig11">5.11.1 - De build stopte met een "Signal 11" fout</a>
   <li><a href="#snake">5.11.2 - "make build" mislukt met "cannot open output
     file snake: is a directory"</a>
   <li><a href="#ProbIPv6">5.11.3 - Mijn IPv6-loos systeem werkt niet!</a>
   <li><a href="#ProbObj">5.11.4 - Oeps! Ik vergat eerst de <tt>/usr/obj</tt>
     directory aan te maken!</a>
   <li><a href="#ProbObjPt">5.11.5 - Zet <tt>/usr/obj</tt> op zijn eigen
     partitie</a>
   <li><a href="#ProbSKIPDIR">5.11.6 - Hoe bouw ik delen van de tree niet?</a>
   <li><a href="#ProbMoreInfo">5.11.7 - Waar kan ik meer leren over het
     bouwproces?</a>
   <li><a href="#NoSnaps">5.11.8 - Ik zag geen snapshots op de FTP site.
     Waar zijn ze naartoe?</a>
   <li><a href="#NewCompiler">5.11.9 - Hoe bootstrap ik een nieuwere versie
     van de compiler (<i>gcc</i>)?</a>
   <li><a href="#UpdateEtc">5.11.10 - Wat is de beste manier om
     <tt>/etc</tt>, <tt>/var</tt> en <tt>/dev</tt> te updaten?</a>
   <li><a href="#Hierarchy">5.11.11 - Is er een gemakkelijke manier om alle
     veranderingen aan de bestandshiërarchie uit te voeren?</a>
   <li><a href="#ProbXComp">5.11.12 - Kan ik cross-compileren? Waarom niet?</a>
   </ul>
</ul>
<hr>
<br>


<a name="Flavors"></a>
<h2>5.1 - OpenBSD's Flavors</h2>
<!-- XXXversion - revise doodle -->
Er zijn drie "flavors" van OpenBSD:
<ul>
<li><b>-release:</b> De versie van OpenBSD die elke zes maanden op CD
    verdeeld wordt.
<li><b>-stable:</b>  Release, plus patches die kritiek beschouwd worden voor
    beveiliging en betrouwbaarheid.
<li><b>-current:</b> Waar nieuwe ontwikkeling momenteel gebeurt, en
    uiteindelijk zal dit de volgende release worden.
</ul>

Grafisch ziet de ontwikkeling van deze flavors er ongeveer zo uit:

<blockquote>
<pre>
       ,------o-----------o----X                    4.3 Stable
       |      .           .
       |      .    ,------o---------o----X          4.4 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 4.5 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 4.6 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;4.3Rel-----&gt;4.4Rel-----&gt;4.5Rel-----&gt;4.6Rel----&gt; Current 

          Tijd ---&gt;
</pre>
</blockquote>

<p>
<i>-Current</i> is waar actieve ontwikkeling gebeurt, en uiteindelijk zal
dit de volgende <i>-release</i> van OpenBSD worden.
Elke zes maanden, wanneer een nieuwe versie van OpenBSD vrijgegeven wordt,
wordt <i>-current</i> getagged, en wordt <i>-release</i>: een bevroren punt
in de geschiedenis van de source tree.
Elke <i>-release</i> wordt nooit meer verandered; dit is wat
op de <a href="../../nl/orders.html">CD's</a> en
<a href="../../nl/ftp.html">FTP servers</a> staat.

<p>
<i>-stable</i> is gebaseerd op <i>-release</i>,
en is een vertakking ("branch") van het hoofdontwikkelingspad van OpenBSD.
Wanneer heel belangrijke correcties aangebracht worden aan <i>-current</i>,
worden deze ge"back-ported" ("merged") in de <i>-stable</i> branches;
om deze reden staat <i>-stable</i> ook bekend als de <i>patch branch</i>.
In de bovenstaande illustratie geven de verticale stippellijnen
bugcorrecties aan die in de <i>-stable</i> branches opgenomen worden.
U zal ook merken dat in het bovenstaande voorbeeld, de <i>4.3-stable</i>
branch aan zijn einde kwam bij <i>4.5-release</i>, en de <i>4.4-stable</i>
aan zijn einde kwam bij <i>4.6-release</i> -- oude releases worden typisch
tot twee releases terug ondersteund. Het vergt middelen en tijd om oudere
versies te ondersteunen, en hoewel we voortdurende ondersteuning voor oude
releases graag zouden aanbieden, zouden we ons liever toespitsen op nieuwe
functionaliteiten. De <i>-stable</i> branch is, door ontwerp, heel
gemakkelijk op te bouwen vanaf <i>-release</i> van dezelfde versie
(dus gaande van <i>4.6-release</i> naar <i>4.6-stable</i>).

<p>
De <i>-stable</i> branch is <i>-release</i> plus patches die terug te vinden
zijn op de <a href="../../errata.html">errata pagina</a>.
De werking van <i>-stable</i> is dezelfde als de <i>-release</i>
waarop het gebaseerd is.
Als de <a href="http://www.openbsd.org/cgi-bin/man.cgi">man pagina's</a> moeten
veranderen, zal het waarschijnlijk niet in <i>-stable</i> gaan.
Met andere woorden, nieuwe device ondersteuning en nieuwe functionaliteit
zullen NIET toegevoegd worden aan <i>-stable</i>.

<p>
Het loont de moeite er op te wijzen dat de naam "<i>-stable</i>" niet bedoeld
is om te impliceren dat <i>-current</i> onbetrouwbaar is.
<i>-current</i> verandert en evolueert eerder, terwijl de werking en API's van
<i>-stable</i> niet zullen veranderen, dus u zal uw systeem niet opnieuw moeten
leren of configuratiebestanden wijzigen, of problemen hebben met het
toevoegen van bijkomende toepassingen aan uw systeem.

<p>
In feite, aangezien het onze hoop is om OpenBSD voortdurend te verbeteren,
is het de bedoeling dat <i>-current</i> meer betrouwbaar en veiliger is,
en uiteraard meer mogelijkheden heeft dan <i>-stable</i>.
Om het cru te zeggen, de "beste" versie van OpenBSD is <i>-current</i>.

<p>
De meeste gebruikers draaien best ofwel <i>-stable</i> of <i>-release</i>.
Dat gezegd zijnde, draaien veel mensen <i>-current</i> op productiesystemen,
en het is belangrijk dat mensen dat doen om bugs op te sporen en
nieuwe functionaliteiten te testen. Als u echter niet weet hoe een probleem
behoorlijk te beschrijven, te diagnosticeren en ermee om te gaan, zeg dan
niet tegen uzelf (of iemand anders) dat u "het project helpt" door
<i>-current</i> te draaien.  "Het werkte niet!" is geen
<a href="../../nl/report.html#bugtypes">nuttige bug melding</a>.  "De recente
wijzigingen aan de pciide driver hebben de compatibiliteit met mijn
Slugchip-gebaseerde IDE interface gebroken, dmesg van werkende en gebroken
systemen volgen..." zou een nuttige melding kunnen zijn.

<p>
Er zijn momenten wanneer "gewone" gebruikers misschien op het scherp van de
snee willen leven en <i>-current</i> draaien. De meest voorkomende reden is
dat de gebruiker een device heeft dat niet
ondersteund wordt door <i>-release</i> (en dus ook niet door <i>-stable</i>),
of verkiest om een nieuwe functionaliteit van <i>-current</i> te gebruiken.
In dit geval kan de keuze zijn om ofwel
<i>-current</i> te gebruiken ofwel het device niet te gebruiken, en
<i>-current</i> kan het kleinste kwaad zijn. Men moet echter geen
"handjes vasthouden" van de ontwikkelaars verwachten.

<h3>Snapshots</h3>
Tussen formele releases van OpenBSD worden er <i>snapshots</i> beschikbaar
gemaakt via de <a href="../../nl/ftp.html">FTP sites</a>. Zoals de naam impliceert,
zijn dit builds van welke code er ook in de tree zit op het ogenblik dat de
builder een kopie nam van de code voor dat bepaald platform.
Onthou dat, op sommige platformen, het DAGEN kan duren voor de snapshot
build voltooid is en voor verspreiding vrijgegeven wordt. Er is geen belofte
dat de snapshots volledig functioneel zijn, of zelfs goed installeren. Vaak
kan een verandering die getest moet worden, het aanmaken van snapshots
teweegbrengen.
Voor sommige platformen worden bijna dagelijks snapshots gebouwd, voor andere
zal dit veel minder frequent gebeuren. Als u <i>-current</i> wenst te draaien,
is een recent snapshot vaak al wat u nodig hebt, en naar een snapshot upgraden
is een vereist vertrekpunt alvorens <i>-current</i> proberen te bouwen
vanaf broncode.

<p>
Soms wordt gevraagd of er een manier is om precies de broncode te verkrijgen
die gebruikt werd om een snapshot te bouwen. Het antwoord is neen. Ten eerste
biedt dit geen aanzienlijk voordeel. Ten tweede worden snapshots gebouwd zoals
gewenst, naarmate de tijd het toelaat, en naarmate middelen beschikbaar worden.
Op snelle platformen is het mogelijk dat er meerdere snapshots uitgebracht
worden op één dag. Op tragere platformen kan het een week of
langer duren om een snapshot te bouwen. Etiketten ("tags") of kentekens
voorzien in de source tree voor elk snapshot zou erg onpraktisch zijn.
Ten derde bevatten snapshots vaak experimentele code die nog niet
gecommitted is in de tree.

<h3>Upgrade vs. Update</h3>
U zal dikwijls verwijzingen vinden naar het "upgraden" en "updaten" van OpenBSD
installaties.
Hoewel deze begrippen gelijkaardige betekenissen hebben, wordt
er toch een onderscheid gemaakt onder OpenBSD.

<p>
<b>Upgraden</b> betekent een nieuwe versie van OpenBSD installeren, met
nieuwe functionaliteiten. Bijvoorbeeld, van v4.5 naar v4.6 gaan, of van
de snapshot van 12 juni naar de snapshot van 20 juni gaan.
Bij het upgraden moet u doorgaans
<a href="../current.html">Following -current</a> of de
<a href="../upgrade46.html">Upgrade gids</a> (wanneer u van release
verandert) raadplegen, om de nodige veranderingen voor de geüpgraded
versie van OpenBSD te kunnen maken.

<br>
<b>Updaten</b> is het proces van patches aanbrengen op een systeem
om de werking te verbeteren ZONDER de basisfunctionaliteit of
binaire compatibiliteit te veranderen.
Dit wordt doorgaans gedaan door het
<a href="faq10.html#Patches">patchen van broncode</a> of door
<a href="../../nl/stable.html">-stable (de "patch branch")</a> te volgen.
Wanneer u uw systeem updatet, gaat het van een <i>-release</i> naar een
<i>-stable</i> (of gepatchte <i>-release</i>) van de zelfde release
versie, bijvoorbeeld van 4.6-release naar 4.6-stable.
U kan dan later updaten naar een nieuwere <i>-stable</i> van dezelfde
release versie.
Het update proces verloopt doorgaans zonder problemen, omdat geen <tt>/etc</tt>
bestanden of andere systeemconfiguraties moeten veranderd worden.

<p>
U kan dus een systeem installeren (bijvoorbeeld, 4.4-release) van CD,
nadien meermaals updaten naar 4.4-stable, vervolgens upgraden naar
4.5-release van CD, en deze dan weer meermaals updaten alvorens het weer
te upgraden naar de 4.6-release.

<h3>De Dingen in Sync houden</h3>
Het is belangrijk om te begrijpen dat OpenBSD een Besturingssysteem is,
bedoeld om als een geheel genomen te worden, niet als een kernel met een
hoop utilities er op gekleefd. U moet ervoor zorgen dat uw kernel, "userland"
(de ondersteunende utilities en bestanden) en
<a href="faq15.html#Ports"><tt>ports</tt></a> tree allemaal in sync zijn, of
er zullen onaangename dingen gebeuren. Anders gezegd (omdat de mensen de fout
gewoon blijven maken), u kan geen splinternieuwe <tt>ports</tt> draaien op
een systeem van een maand oud, of een kernel van <i>-current</i> broncode
herbouwen en verwachten dat deze werkt met een <i>-release</i> userland. Ja,
dit betekent dat u uw systeem moet upgraden als u een nieuw programma wil
draaien dat vandaag aan de ports tree werd toegevoegd. Sorry, maar opnieuw,
OpenBSD heeft beperkte middelen ter beschikking.

<p>
Men zou ook moeten begrijpen dat het upgrade
proces in <b>slechts één richting: van ouder naar nieuwer</b>
ondersteund wordt, en van <i>-stable</i> naar <i>-current</i>. U kan niet
<i>4.6-current</i> (of een snapshot) draaien, vervolgens beslissen dat u te
gevaarlijk aan het leven bent, en een stap terugzetten naar <i>4.6-stable</i>.
U staat er alleen voor als u een ander pad verkiest dan de ondersteunde optie
om uw systeem vanaf nul te herladen, verwacht geen assistentie van het
OpenBSD ontwikkelingsteam.

<p>
Ja, dit betekent dat u lang en hard moet nadenken alvorens u zichzelf aan
het gebruik van <i>-current</i> waagt.

<a name="WhySrc"></a>
<h2>5.2 - Waarom moet ik mijn systeem vanaf broncode bouwen?</h2>
Eigenlijk is het heel waarschijnlijk dat u dat niet moet.

<p>
Enkele redenen waarom NIET vanaf broncode te bouwen:
<ul>
<li>Uw eigen systeem compileren als een manier van upgraden wordt niet
ondersteund.
<li>U zal GEEN betere systeemprestatie krijgen door uw eigen systeem te
compileren.
<li>Compileropties wijzigen zal waarschijnlijk eerder uw systeem breken dan
verbeteren.
</ul>

Enkele redenen waarom u misschien vanaf broncode wil of moet bouwen:
<ul>
<li>Testen of ontwikkelen van nieuwe functionaliteiten.
<li>Het systeem compileren zet veel stress op de computer, het kan een
manier zijn om te verzekeren dat het systeem dat u net samenstelde of bekwam
eigenlijk in vrij goede operationele conditie is.
<li>U wenst de <a href="../../nl/stable.html">stable branch</a> te volgen.
<li>U wenst een uiterst op maat gemaakte versie van OpenBSD te maken voor
een of andere speciale toepassing.
</ul>

<p>
Het OpenBSD team geeft op heel regelmatige basis voor alle platformen nieuwe
snapshots vrij, gebaseerd op <i>-current</i> code.
Waarschijnlijk zal dit alles zijn wat u nodig hebt om <i>-current</i>
te draaien.

<p>
De meest voorkomende reden om vanaf broncode te bouwen is om de <i>-stable</i>
branch te volgen, waarbij vanaf broncode bouwen de enige ondersteunde optie
is.

<a name="Bld"></a>
<h2>5.3 - OpenBSD vanaf broncode bouwen</h2>

<a name="BldOverview"></a>
<h3>5.3.1 - Overzicht van het bouwproces</h3>

OpenBSD vanaf broncode bouwen brengt een aantal stappen met zich mee:
<ul>
<li><a href="#BldBinary">Upgraden naar de dichtstbijzijnde beschikbare binary.</a>
<li><a href="#BldGetSrc">De gepaste broncode afhalen.</a>
<li><a href="#BldKernel">De nieuwe kernel bouwen en ermee booten.</a>
<li><a href="#BldUserland">"userland" bouwen ("make build").</a>
</ul>

Er zijn een paar bijkomende stappen die sommige gebruikers misschien wensen
uit te voeren, afhankelijk van het doel van het bouwen en of X al dan niet
geïnstalleerd is:
<ul>
<li><a href="#Release">Een "release" bouwen.</a>
<li><a href="#Xbld">X bouwen.</a>
</ul>


<a name="BldBinary"></a>
<h3>5.3.2 - Installeren of upgraden naar de dichtstbijzijnde beschikbare binary</h3>

De eerste stap bij het bouwen vanaf broncode is er zeker van zijn dat de
dichtstbijzijnde beschikbare binary geïnstalleerd hebt.

Gebruik deze tabel om op te zoeken waar u bent, waar u naartoe wil, en met
welke binary u moet beginnen:

<p>
<table border="1" style="empty-cells: show;">
<tr>
  <td><b>U bent op</b></td> <td><b>Doel</b></td>
  <td><b>Binary upgrade naar</b></td> <td><b>vervolgens ...</b></td>
</tr>
<tr>
  <td> Oude -release </td> <td> Nieuwe release </td> <td> Nieuwste release </td>
  <td> Klaar! </td>
</tr>
<tr>
  <td> -release </td> <td> -stable </td> <td> Nieuwste release </td>
  <td>Afhalen &amp; bouwen van <i>-stable</i></td>
</tr>
<tr>
  <td> Oude -stable</td> <td> -stable </td> <td> Nieuwste release </td>
  <td>Afhalen &amp; bouwen van <i>-stable</i></td>
</tr>
<tr>
  <td> -release </td> <td> -current </td> <td> Laatste Snapshot </td>
  <td> (optioneel) Afhalen &amp; bouwen van <i>-current</i>
</tr>
<tr>
  <td> Oude -current </td> <td> -current </td> <td> Laatste Snapshot </td>
  <td> (optioneel) Afhalen &amp; bouwen van <i>-current</i>
</tr>
</table>

<p>
Het wordt aanbevolen dat u de binary installeert door de "Upgrade" optie
van het installatiemedium te gebruiken.
Als dat niet mogelijk is, kan u ook de binaries uitpakken zoals
<a href="../upgrade46.html">hier</a> beschreven.
Hoe dan ook, u moet het volledige upgrade proces doen, inclusief het
aanmaken van gebruikers of andere benodigde veranderingen in de
<tt>/etc</tt> directory.


<a name="BldGetSrc"></a>
<h3>5.3.3 - De gepaste broncode afhalen</h3>
OpenBSD broncode wordt beheerd met het
<a href="http://ximbiot.com/cvs/cvshome/">CVS</a>
versiebeheersysteem, en
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>
wordt gebruikt om een kopie van de gewenste broncode naar uw lokale machine
af te halen voor compilatie.  Dit kan gedaan worden door gebruik te maken
van een <a href="../../nl/anoncvs.html">AnonCVS</a>
server (een machine waarop een publiek toegankelijke kopie staat van de
volledige CVS repository gebruikt door het OpenBSD project) of van een
lokale CVS repository die u beheert met de
<a href="../../cvsup.html">CVSup</a> of
<a href="../../nl/cvsync.html">CVSync</a> programma's, beschikbaar via
<a href="faq15.html#PkgMgmt">packages</a>.
CVSup kan ook gebruikt worden in een "checkout" modus, maar dat zal hier niet
behandeld worden.
Als u meerdere machines hebt waarop u source trees op wil onderhouden, kan u
het de moeite vinden een lokale CVS repository te hebben, aangemaakt en
onderhouden met CVSup of CVSync.

<p>
Nadat u beslist hebt welke <a href="../../nl/anoncvs.html">AnonCVS server</a>
u wenst te gebruiken, moet u een "checkout" van de source tree uitvoeren,
daarna onderhoudt u dan de tree door "updates" uit te voeren, om geüpdatet
bestanden naar u lokale tree te halen.

<p>
Het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">CVS(1)</a>
commando heeft vele opties, sommige ervan zijn <i><b>vereist</b></i> voor
de checkout en update van een nuttige tree.
Andere commando's kunnen een gebroken tree veroorzaken.
Aanwijzingen volgen en begrijpen is hier belangrijk.

<p>
<b><i>-current</i> volgen</b><br>
<blockquote>
In dit geval zullen we veronderstellen dat we een publieke AnonCVS
server, <b>anoncvs@anoncvs.example.org:/cvs</b>, gebruiken.
We zullen ook veronderstellen dat u
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh(1)</a>
als uw commando-shell gebruikt, indien u een andere shell gebruikt, zal u
sommige van deze commando's moeten aanpassen.

<p>
Voor de checkout van een <i>-current</i> CVS src tree, kan u het volgende
gebruiken:

<pre>
    # <b>cd /usr</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT checkout -P src</b>
</pre>

<p>
Zodra u de tree hebt, kan u hem op een later tijdstip updaten:
<pre>
    # <b>cd /usr/src</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT up -Pd</b>
</pre>
</blockquote>

<!-- XXXrelease -->
<b><i>-Stable</i> volgen</b><br>
<blockquote>
Indien u een checkout wil doen van een alternatieve "branch" van de tree,
zoals de <i>-stable</i> branch, zal u de "<tt>-r</tt>" modifier gebruiken
voor uw checkout:
<pre>
    # <b>cd /usr</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT checkout -rOPENBSD_4_6 -P src</b>
</pre>

Dit zal de src bestanden van de OPENBSD_4_6 branch afhalen, die ook bekend
staat als de "Patch branch" of "<a href="../../nl/stable.html">-stable</a>".
U zou de code gelijkaardig updaten:
<pre>
    # <b>cd /usr/src</b>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cvs -d$CVSROOT up -rOPENBSD_4_6 -Pd</b>
</pre>

In feite is CVS vriendelijk genoeg om een "Tag" in het uitgecheckte
bestandssysteem te plakken, zodat u het "<tt>-rOPENBSD_4_6</tt>" gedeelte
van de commandolijn niet moet onthouden, het zal dit zelf onthouden totdat
u ze expliciet wist of een nieuwe tag instelt door de "<tt>-A</tt>" optie
bij "<tt>update</tt>" te gebruiken.
Het is waarschijnlijk echter beter om te veel info in uw CVS commandolijn
mee te geven dan te weinig.
</blockquote>

<p>
Hoewel tot nu toe alleen de "<tt>src</tt>" tree getoond werd, zal u dezelfde
stappen uitvoeren voor "<tt>xenocara</tt>" en "<tt>ports</tt>".
Aangezien alle delen van OpenBSD in sync gehouden moeten worden, moeten alle
trees die u gebruikt op hetzelfde moment uitgecheckt en geüpdatet worden.
U kan de checkouts in een lijn combineren (<i>-stable</i> getoond):
<pre>
    # <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
    # <b>cd /usr</b>
    # <b>cvs -d$CVSROOT checkout -rOPENBSD_4_6 -P src ports xenocara</b>
</pre>

Updates moeten echter directory-per-directory gedaan worden.

<p>
Op dit punt, of u nu <i>-stable</i> of <i>-current</i> gevolgd hebt, zou u
een bruikbare source tree moeten hebben.
Wees heel voorzichtig met welke tree u afhaalt -- het is gemakkelijk om
<i>-current</i> te proberen compileren wanneer u op <i>-stable</i> uit bent.

<h4>De tree vooraf laden: <tt>src.tar.gz, sys.tar.gz</tt></h4>
Hoewel u de volledige source tree vanaf een AnonCVS server kan downloaden,
kan u vaak veel tijd en bandbreedte besparen door uw source tree "vooraf
te laden" met de bronbestanden ofwel van de OpenBSD CD ofwel van een FTP
server.
Dit is vooral zo als u <a href="../../nl/stable.html"><i>-stable</i></a> draait,
aangezien relatief weinig bestanden veranderen tussen deze versie en de
<i>-release</i> waarop ze gebaseerd is.
 
<p>
Om de source tree vanaf CD uit te pakken in <i>/usr/src</i> (in de
veronderstelling dat de CD gemount is op /mnt):
<pre>
    # <b>cd /usr/src; tar xzf /mnt/src.tar.gz</b>
    # <b>cd /usr; tar xzf /mnt/xenocara.tar.gz</b>
    # <b>cd /usr; tar xzf /mnt/ports.tar.gz</b>
</pre>

De bronbestanden beschikbaar om te downloaden vanaf de FTP servers zijn
afgezonderd in twee bestanden om de downloadtijd te minimaliseren voor
hen die met slechts één deel van de tree willen werken.
De twee bestanden zijn <tt>sys.tar.gz</tt>, dat de bestanden bevat die
gebruikt worden om de kernel te maken, en <tt>src.tar.gz</tt> dat al de
andere "userland" utilities bevat, behalve de ports tree en de X11 broncode.
In het algemeen zal u ze echter allebei geïnstalleerd willen hebben.
In de veronderstelling dat de gedownloade bestanden, <tt>src.tar.gz</tt>
en <tt>sys.tar.gz</tt>, in <tt>/usr</tt> staan:
  
<pre>
    # <b>cd /usr/src</b>
    # <b>tar xzf ../sys.tar.gz</b>
    # <b>tar xzf ../src.tar.gz</b>
    # <b>cd /usr</b>
    # <b>tar xzf xenocara.tar.gz</b>
    # <b>tar xzf ports.tar.gz</b>
</pre>

<p>
Niet alle mensen zullen al de bestandensets willen uitpakken, maar
aangezien het systeem in sync gehouden moet worden, zal u in het algemeen
alle delen van de tree moeten opstellen.


<a name="CVSTips"></a>
<h4>Algemene CVS tips</h4>

Zoals eerder aangegeven, zijn sommige opties verplicht om een geldige
<tt>src</tt> tree te krijgen in OpenBSD.
De "<tt>-P</tt>" optie hierboven is daar een van: Deze verwijdert ("prune")
directories die leeg zijn.
Over de jaren zijn er directories aangemaakt en verwijderd in de OpenBSD
source tree, en soms worden de namen van oude directories momenteel gebruikt
als bestandsnamen.
Zonder de "<tt>-P</tt>" optie ZAL uw zonet uitgecheckte tree NIET
succesvol compileren.

<p>
Vrijwel hetzelfde voor de <tt>-d</tt> optie bij het 'update' commando -- het
maakt nieuwe directories aan die mogelijk aan de tree zijn toegevoegd
sedert uw initiele checkout.
Om een succesvolle update te bekomen, moet u de <tt>-Pd</tt> opties gebruiken.

<p>
Ervaren CVS gebruikers kunnen zich afvragen waarom de CVSROOT in dit
voorbeeld gespecificeerd en gebruikt werd, aangezien cvs(1) de lokatie
van de CVS server zal registreren in de uitgecheckte tree.
Dit is correct, men moet misschien echter vaak genoeg de standaard anoncvs
server opheffen, veel mensen bevelen aan <i>altijd</i> de repository
expliciet te specificeren.
Het loont ook de moeite op te merken dat hoewel de CVSROOT omgevingsvariabele
rechtstreeks door cvs(1) kan gebruikt worden, deze alleen gebruikt wordt
als niets anders hem opheft (bv., zonder zou cvs(1) een fout geven), terwijl
het specificeren ervan in de cvs(1) commandolijn alle andere waarden opheft.

<p>
Het is vaak nuttig om een <tt>.cvsrc</tt> in uw home directory te gebruiken
om standaardwaarden voor sommige van deze opties te specificeren.
Een voorbeeld <tt>.cvsrc</tt> bestand:
<pre>
    $ <b>more ~/.cvsrc</b>
    cvs -q -danoncvs@anoncvs.example.org:/cvs
    diff -up
    update -Pd
    checkout -P
</pre>

Dit bestand zou ervoor zorgen dat cvs(1) de
<tt>anoncvs@anoncvs.example.org:/cvs</tt> server gebruikt, gewoonlijk
onnodige uitvoer onderdrukt ("<tt>-q</tt>" is "quiet") voor alle operaties,
een "cvs up" commando gebruikt standaard <tt>-Pd</tt>,
een "cvs diff" geeft standaard "unified diffs" door de "<tt>-u</tt>",
en een "cvs checkout" zal de "<tt>-P</tt>" optie gebruiken.
Hoewel dit handig is, als u vergeet dat dit bestand bestaat, of commando's
probeert uit te voeren waaraan u gewend bent geraakt op een machine zonder
dit bestand, zal u problemen hebben.

<p>
Aangezien de source trees bestaan uit grote hoeveelheden van meestal kleine
bestanden, zal het inschakelen van <a href="faq14.html#SoftUpdates">soft
updates</a> voor de partitie waarop de source tree staat vaak aanzienlijk
betere prestatie geven.


<a name="BldKernel"></a>
<a name="Building"></a>  <!-- Old tag -->
<h3>5.3.4 - De kernel bouwen</h3>
We zullen hier veronderstellen dat u een standaard (GENERIC of GENERIC.MP)
kernel wenst te bouwen.
Normaal gezien is dit wat u wil doen.
Overweeg <i>niet</i> een op maat gemaakte kernel te bouwen als u het
standaard bouwproces niet beheerst.

<p>
Vanzelfsprekend is de kernel een HEEL hardware-afhankelijk gedeelte van het
systeem.
De broncode van de kernel staat in de <tt>/usr/src/sys</tt> directory.
Sommige delen van de OpenBSD kernel code worden op alle platformen gebruikt,
andere zijn heel specifiek voor één processor of één architectuur.
Als u in de <tt>/usr/src/sys/arch/</tt> directory kijkt, kan u enkele dingen
zien die er een beetje verwarrend uitzien -- er zijn bijvoorbeeld
<tt>mac68k</tt>, <tt>m68k</tt> en <tt>mvme68k</tt> directories.
In dit geval gebruiken de mvme68k en mac68k systemen allebei dezelfde
processor, maar de machines waarop ze gebaseerd zijn, zijn heel verschillend,
en vereisen dus een heel verschillende kernel (er is meer aan het ontwerp
van een computer dan zijn processor!).
Delen van de kernel zijn echter gemeenschappelijk, die delen worden in de
m68k directory gehouden.
Als u gewoon een kernel bouwt, zijn de basis architectuurdirectories als
<tt>m68k</tt> niets om zich zorgen over te maken, u zal uitsluitend werken
met de "compound architecture" directories,
zoals <tt>mvme68k</tt>.

<p>
Kernels worden gebouwd gebaseerd op <a href="#Options">kernel
configuratiebestanden</a>, die in de
<tt>/usr/src/sys/arch/&lt;<i>uw platform</i>&gt;/conf</tt> directory staan.
De kernel bouwen bestaat uit het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
programma gebruiken om een kernel compileerdirectory aan te maken en te vullen,
die in
<tt>/usr/src/sys/arch/&lt;<i>your platform</i>&gt;/compile/&lt;<i>KernelName</i>&gt;</tt> zal komen te staan.
Voor dit voorbeeld zullen we veronderstellen dat u het i386 platform gebruikt:

<blockquote><pre>
# <b>cd /usr/src/sys/arch/i386/conf</b>
# <b>config GENERIC</b>
# <b>cd ../compile/GENERIC</b>
# <b>make clean && make depend && make</b>
    <i>[...veel uitvoer...]</i>
# <b>make install</b>
</pre></blockquote>

Vervang "<tt>i386</tt>" in de eerste lijn door de naam van uw platform.
Het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=machine&amp;sektion=1">machine(1)</a>
commando kan u vertellen wat uw huidige machinenaam is, dus een voor de hand
liggende veralgemening zou zijn om in de plaats het commando "<tt>cd
/usr/src/sys/arch/`machine`/conf</tt>" op de eerste lijn te gebruiken.

<p>
Herstart op dit punt uw machine om deze nieuwe kernel te activeren.
Merk op dat de nieuwe kernel moet draaien voor de volgende stap, hoewel
als u de raad <a href="#BldBinary">hierboven</a> over upgraden naar de meest
recente snapshot gevolgd hebt, kan het dat het niet zo heel veel uitmaakt.
Soms veranderen API's echter, en zal de oude kernel nieuwe toepassingen niet
kunnen uitvoeren, maar de nieuwe kernel zal in het algemeen de oude wel
ondersteunen.

<h4>Variatie op het bovenstaande proces: Read-only source tree</h4>
Soms kan u er wensen voor te zorgen dat uw <tt>/usr/src/sys</tt> directory
onaangeroerd blijft.
Dit kan gedaan worden door het volgende proces te gebruiken:

<blockquote><pre>
$ <b>cd <i>/ergens</i></b>
$ <b>cp /usr/src/sys/arch/i386/conf/GENERIC .</b>
$ <b>config -s /usr/src/sys -b . GENERIC</b>
$ <b>make clean && make depend && make</b>
   ... veel uitvoer ...
</pre></blockquote>

Merk op dat u een kernel kan bouwen zonder root toegang, maar u moet root
hebben om de kernel te installeren.


<a name="BldUserland"></a>
<h3>5.3.5 - Het userland bouwen</h3>

Er is een specifiek proces dat OpenBSD gebruikt.
Processen gebruikt op andere besturingssystemen waarmee u misschien vertrouwd
bent geweest, zullen heel waarschijnlijk niet werken op OpenBSD, en zullen
ervoor zorgen dat u uitgelachen wordt wanneer u vraagt waarom.

<p>
<ul>
<li>Maak uw <tt>/usr/obj</tt> directory leeg en herbouw symbolische
koppelingen:
<blockquote><pre>
# <b>rm -rf /usr/obj/*</b>
# <b>cd /usr/src</b>
# <b>make obj</b>
</pre></blockquote>

Merk op dat het gebruik van de <tt>/usr/obj</tt> directory verplicht is.
Nalaten deze stap te doen alvorens de rest van de tree te bouwen zal
waarschijnlijk uw <tt>src</tt> tree in slechte staat achterlaten.

<p>
<li>Zorg ervoor dat al de gepaste directories aangemaakt worden.
<blockquote><pre>
# <b>cd /usr/src/etc && env DESTDIR=/ make distrib-dirs</b>
</pre></blockquote>

<p>
<li>Bouw het systeem:
<blockquote><pre>
# <b>cd /usr/src</b>
# <b>make build</b>
</pre></blockquote>
Dit compileert en installeert al de "userland" utilities in de
gepaste volgorde.
Dit is een tamelijk tijdrovende stap -- een heel snelle machine kan dit
misschien voltooien in goed minder dan een uur, een heel trage machine kan
er vele dagen over doen.
Wanneer deze stap voltooid is, hebt u nieuw gecompileerde binaries op hun
plaats op uw systeem.

<p>
<li><b>Indien u <i>-current</i> bouwt:</b> Update <tt>/dev</tt> en
<tt>/etc</tt>, met de wijzigingen vermeld in
<a href="../current.html">current.html</a>.
Indien u -stable volgt na een correct <a href="../upgrade46.html">upgrade
proces</a> of een installatie van de <a href="#BldBinary">juiste
vertrek-binary</a>, is deze stap niet nodig of gewenst.

</ul>


<a name="Release"></a>
<a name="BldRelease"></a> <!-- old tag -->
<h2>5.4 - Een Release bouwen</h2>
<h3>Wat is een "release", en waarom zou ik er één willen maken?</h3>
Een release is de volledige set van bestanden die kan gebruikt worden om
OpenBSD op een andere computer te installeren.
Indien u slechts één computer hebt die OpenBSD draait, hebt u echt geen
enkele reden om een release te maken, aangezien het bouwproces
<a href="#Bld">hierboven</a> alles zal doen dat u nodig hebt.
Een voorbeeldgebruik van het release proces zou zijn om <i>-stable</i> te
bouwen op een snelle machine, en vervolgens een release te maken die
geïnstalleerd wordt op al uw andere machines in uw kantoor.

<p>
Het release-proces gebruikt de binaries aangemaakt in de <tt>/usr/obj</tt>
directory in het bovenstaande bouwproces, dus u moet eerst succesvol het
bouwen voltooien, en niets mag de <tt>/usr/obj</tt> directory verstoren.
Een moment waarop dit een probleem kan zijn is als u een
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_mfs&amp;sektion=8">geheugenschijf</a>
als uw <tt>/usr/obj</tt> gebruikt voor een beetje extra prestatie in het
bouwproces, u zou de computer niet willen herstarten tussen de "build" en
"release" stappen!

<p>
Het release-proces gebruikt twee werkdirectories, die we
DESTDIR en RELEASEDIR zullen noemen.
Alle bestanden die deel uitmaken van een "schone" OpenBSD installatie zullen
gekopieerd worden naar hun juiste plaats binnen de DESTDIR.
Zij zullen dan getar(1)d worden en in de RELEASEDIR geplaatst.
Aan het einde van het proces zal RELEASEDIR de voltooide OpenBSD release
bevatten.
Het release-proces zal ook de <tt>/mnt</tt> lokatie gebruiken, dus dit zou
door niets mogen gebruikt worden terwijl het release-proces draait.
Voor het doel van het voorbeeld, zullen we de DESTDIR
<tt>/usr/dest</tt> en de RELEASEDIR <tt>/usr/rel</tt> gebruiken.


<p>
Het release-proces omvat een utility,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crunchgen&amp;sektion=8">crunchgen(8)</a>,
die gebruikt wordt om één enkel uitvoerbaar bestand aan te maken
bestaande uit vele individuele binaries.
De naam waarmee dit enkel uitvoerbaar bestand aangeroepen wordt,
bepaalt welke component-binary uitgevoerd wordt.
Dit is hoe een aantal individuele programmabestanden in de ramschijf-kernel
geperst worden die op bootdiskettes en andere bootmedia zit.

<p>
U moet root privileges hebben om een release te maken.

<p>
<h3>Een release doen</h3>

Definieer onze DESTDIR en RELEASEDIR omgevingsvariabelen:
<blockquote><pre>
# <b>export DESTDIR=/usr/dest</b>
# <b>export RELEASEDIR=/usr/rel</b>
</pre></blockquote>

We maken nu de DESTDIR leeg en maken de directories aan indien nodig:
<blockquote><pre>
# <b>test -d ${DESTDIR} && mv ${DESTDIR} ${DESTDIR}.old && rm -rf ${DESTDIR}.old &</b>
# <b>mkdir -p ${DESTDIR} ${RELEASEDIR}</b>
</pre></blockquote>

RELEASEDIR hoeft normaal gezien niet leeg te zijn alvorens het release proces
te starten, als er echter wijzigingen zijn in de release bestanden of hun
namen, kunnen oude bestanden achtergelaten worden.
U kan verkiezen om ook deze directory leeg te maken alvorens te beginnen.

<p>
We maken nu de release zelf:
<blockquote><pre>
# <b>cd /usr/src/etc</b>
# <b>make release</b>
</pre></blockquote>

Nadat de release gemaakt is, is het een goed idee om de release na te kijken
om er zeker van te zijn dat de tar bestanden overeenstemmen met wat er in
de DESTDIR staat.
De uitvoer van deze stap zou heel minimaal moeten zijn.

<blockquote><pre>
# <b>cd /usr/src/distrib/sets</b>
# <b>sh checkflist</b>
</pre></blockquote>

U hebt nu volledige en nagekeken release bestandensets in de RELEASEDIR.
Deze bestanden kunnen nu gebruikt worden om OpenBSD te installeren of te
upgraden op andere machines.

<p>
De gezaghebbende instructies over het maken van een release staan in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>.

<p>
Opmerking: als u de resulterende bestanden over HTTP wil verspreiden voor
gebruik door de upgrade- of installatiescripts, zal u een bestand "index.txt"
moeten toevoegen, dat de lijst bevat van al de bestanden in uw nieuwe
aangemaakte release.
<blockquote><pre>
# <b>/bin/ls -1 >index.txt</b>
</pre></blockquote>

Zodra u de complete release compleet klaar heeft, kunt u die bestanden
gebruiken voor een standaard <a href="faq4.html">installatie</a> of
<a href="../upgrade46.html">upgrade</a> op een andere machine, of u kunt
de tar bestanden simpelweg <a href="faq4.html#AddFileSet">uitpakken</a>
in de root directory van een machine om hem te updaten naar een nieuwe
<i>-stable</i>.

<a name="Xbld"></a>
<h2>5.5 - X bouwen (Xenocara)</h2>
Vanaf <a href="http://x.org/">X.org v7</a> is X omgeschakeld naar een
"modulair bouwsysteem", waarbij de x.org source tree in meer dan driehonderd
min of meer onafhankelijke packages opgedeeld werd.

<p>
Om het leven te vereenvoudigen voor OpenBSD gebruikers, werd een
"meta-bouwproces" ontwikkeld met de naam
<a href="http://xenocara.org">Xenocara</a>.
Dit systeem zet X terug in één grote tree die in één proces kan
gebouwd worden.
Het bijkomend voordeel is dat dit bouwproces veel meer dan de vorige versies
lijkt op het bouwproces dat door de rest van OpenBSD gebruikt wordt.

<p>
De officiële instructies om X te bouwen zitten in het
<tt>/usr/xenocara/README</tt> bestand op uw machine en in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>.

<h3>Broncode bekomen</h3>
De "gewoonlijke" locatie voor de xenocara source tree is
<tt>/usr/xenocara</tt>, en de source wordt in CVS bewaard in de
<tt>xenocara</tt> module.
Het checkout proces is dus dit:
<blockquote><pre>
$ <b>cd /usr</b>
$ <b>cvs -qdanoncvs@anoncvs.example.org:/cvs checkout -P xenocara</b>
</pre></blockquote>

<h3>Xenocara bouwen</h3>
Om de standaard xenocara tree te bouwen zoals ondersteund door OpenBSD,
zijn geen externe tools nodig.

<blockquote><pre>
# <b>cd /usr/xenocara</b>
# <b>rm -rf /usr/xobj/*</b>
# <b>make bootstrap</b>
# <b>make obj</b>
# <b>make build</b>
</pre></blockquote>

Indien u werkelijk wijzigingen wil aanbrengen aan de broncode, zal u
waarschijnlijk verscheidene <a href="faq15.html">packages</a> moeten
toevoegen.
Details staan in het <tt>/usr/xenocara/README</tt> bestand.

<h3>Een release maken</h3>
Dit is gelijkaardig aan het hoofdsysteem release-proces.
Na succesvol X te bouwen, zal u een DESTDIR en RELEASEDIR definieren,
met dezelfde doelen als hierboven.
De RELEASEDIR kan dezelfde directory zijn als de hoofdsysteem RELEASEDIR,
maar DESTDIR zal leeggemaakt en herbouwd worden in dit proces.
Indien het voorzichtig gedaan wordt, is dit geen probleem, maar een
afzonderlijke DESTDIR gebruiken kan "veiliger" zijn.

<p>
Voor dit voorbeeld zullen we een DESTDIR en RELEASEDIR,
respectievelijk /usr/dest en /usr/rel, gebruiken.
Dit moet gedaan worden na het bovenstaande bouwproces.

<blockquote><pre>
# <b>export DESTDIR=/usr/dest</b>
# <b>export RELEASEDIR=/usr/rel</b>
# <b>test -d ${DESTDIR} && mv ${DESTDIR} ${DESTDIR}- && \</b>
  <b>   rm -rf ${DESTDIR}- &</b>
# <b>mkdir -p ${DESTDIR} ${RELEASEDIR}</b>
# <b>make release</b>
</pre></blockquote>

Als dit proces voltooid is, zal u een verzameling release bestanden hebben
in de $RELEASEDIR.

<p>
<a name="Why"></a>
<h2>5.6 - Waarom heb ik een op maat gemaakte kernel nodig?</h2>

<p>
Eigenlijk hebt u dat waarschijnlijk niet nodig.

<p>
Een op maat gemaakte kernel is een kernel gebouwd met een configuratiebestand
verschillend van het meegeleverde <tt>GENERIC</tt> configuratiebestand.
Een op maat gemaakte kernel kan gebaseerd zijn op <a href="#Flavors"><i>-release,
-stable</i> of <i>-current</i></a> code, net zoals een <tt>GENERIC</tt>
kernel dat kan zijn.
Terwijl het compileren van uw eigen <tt>GENERIC</tt> kernel ondersteund is
door het OpenBSD team, is dit <i>niet</i> zo voor het compileren van uw eigen
op maat gemaakte kernel.

<p>
De standaard OpenBSD kernelconfigurate (<tt>GENERIC</tt>) is ontworpen om
geschikt te zijn voor de meeste mensen.
Door het proberen tweaken van hun kernel hebben er meer mensen hun systeem
gebroken dan er de werking van het systeem verbeterd hebben.
Er zijn mensen die geloven dat u uw kernel en systeem moet aanpassen voor
optimale performantie, maar dit is niet waar voor OpenBSD.
Alleen de meest geavanceerde en best geïnformeerde gebruikers met de
meest veeleisende toepassingen hoeven zich zorgen te maken over een
op maat gemaakte kernel of systeem.

<p>
Enkele redenen waarom u misschien een op maat gemaakte kernel zou willen of
moeten bouwen:
<ul>
  <li>U weet echt wat u doet, en wil OpenBSD persen op een computer met een
      kleine hoeveelheid RAM door device drivers die u niet nodig hebt, te
      verwijderen.
  <li>U weet echt wat u doet, en wenst de standaardopties te verwijderen of
      opties toe te voegen die misschien standaard niet ingeschakeld zijn
      (en u hebt een goede reden om dat te doen).
  <li>U weet echt wat u doet, en wenst experimentele opties in te schakelen.
  <li>U weet echt wat u doet, en hebt een speciale behoefte waaraan niet
      voldaan wordt door <tt>GENERIC</tt>, en
      u gaat niet vragen waarom het niet werkt indien er iets verkeerd gaat.
</ul>

<p>
Enkele redenen waarom u beter niet een op maat gemaakte kernel bouwt:
<ul>
  <li>Normaal gezien hoeft u dit niet te doen.
  <li>U zal geen sneller systeem verkrijgen.
  <li>U zal waarschijnlijk een minder betrouwbare machine maken.
  <li>U zal geen ondersteuning krijgen van ontwikkelaars.
  <li>Er zal van u verwacht worden dat u gelijk welk probleem reproduceert
      met een <tt>GENERIC</tt> kernel alvorens ontwikkelaars een
      probleemmelding ernstig nemen.
  <li>Gebruikers en ontwikkelaars zullen u uitlachen wanneer u uw systeem
      breekt.
  <li>Aangepaste compileropties leggen gewoonlijk beter compilerproblemen
      bloot dan dat ze de prestatie van het systeem verbeteren.

</ul>

<p>
Het verwijderen van device drivers kan het bootproces op uw systeem
versnellen, maar kan het herstel bemoeilijken als u een hardware probleem
hebt, en het wordt heel vaak verkeerd gedaan.
Het verwijderen van device drivers zal uw systeem <i>NIET</i> met een merkbare
hoeveelheid sneller laten draaien, maar kan wel een kleinere kernel produceren.
Het verwijderen van debugging en errorcontrole kan tot een meetbare
prestatiewinst leiden, maar zal het onmogelijk maken om een systeem
te onderzoeken als er iets verkeerd gaat.


<p>
Opnieuw, ontwikkelaars zullen gewoonlijk bugmeldingen negeren die te maken
hebben met op maat gemaakte kernels, tenzij het probleem ook in een
<tt>GENERIC</tt> kernel kan gereproduceerd worden.
U bent gewaarschuwd.

<p>
<a name="Options"></a>
<h2>5.7 - Een op maat gemaakte kernel bouwen</h2>
Er wordt verondersteld dat u het <a href="#Why">bovenstaande</a> gelezen hebt,
en echt geniet van pijn.
Er wordt ook verondersteld dat u een doel hebt dat niet kan bereikt worden
door ofwel een <a href="#BootConfig">Boot time configuratie (UKC>)</a> of
door <a href="#config">een GENERIC kernel te config(8)en</a>.
Als dit allebei niet waar is, blijft u beter bij het gebruik van GENERIC.
Echt.

<p>
OpenBSD kernel generatie wordt gestuurd door configuratiebestanden,
die standaard in de <tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt>
directory staan. Alle architecturen hebben een bestand, <tt>GENERIC</tt>,
dat gebruikt wordt om de standaard OpenBSD kernel voor dat platform te
genereren.
Het kan dat er ook andere configuratiebestanden zijn die gebruikt worden
om kernels met verschillende doelen aan te maken, bijvoorbeeld, voor
minimale RAM, schijfloze werkstations, etc.

<p>
Het configuratiebestand wordt verwerkt door
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>,
dat een compilatiedirectory aanmaakt en opvult in <tt>../compile</tt>,
op een typische installatie zou dat in
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt> zijn. config(8) maakt
ook een <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">Makefile</a> aan,
en andere bestanden die vereist zijn om met succes de kernel te bouwen.

<p>
Kernel Configuratie Opties zijn opties die u aan uw kernelconfiguratie
toevoegt en die bepaalde functionaliteiten in uw kernel plaatsen. Dit laat u
toe om precies de ondersteuning te hebben die u wenst, zonder ondersteuning te
hebben voor onnodige devices. Er zijn een veelheid aan opties die u toelaten
om uw kernel aan te passen. Hier zullen we er slechts enkele overlopen,
degene die het vaakst gebruikt worden. Bekijk de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
man pagina voor een volledige lijst van opties, en aangezien deze van tijd tot
tijd veranderen, moet u ervoor zorgen dat u een man pagina gebruikt voor
dezelfde versie van OpenBSD die u aan het bouwen bent. U kan ook de
voorbeeldconfiguratiebestanden nakijken die beschikbaar zijn voor uw
architectuur.

<p>
<b>Gelieve geen opties toe te voegen, te verwijderen of te veranderen in uw
kernel tenzij u werkelijk een reden hebt om dat te doen!  Bewerk niet het
<tt>GENERIC</tt> configuratiebestand!!</b>
De enige kernelconfiguratie
die ondersteund wordt door het OpenBSD team is de GENERIC kernel,
de combinatie van de opties in
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt>
en <tt>/usr/src/sys/conf/GENERIC</tt> <i>zoals verdeeld door het OpenBSD
team</i> (dus NIET bewerkt). Een probleem melden over een aangepaste kernel zal
er bijna altijd toe leiden dat u gezegd wordt om het probleem trachten te
reproduceren met een GENERIC kernel. Niet alle opties zijn compatibel met
elkaar, en vele opties zijn vereist opdat het systeem zou werken. Er is geen
garantie dat, louter omdat u er in slaagt om een aangepaste kernel te
compileren, deze ook werkelijk zal draaien.
Er is geen garantie dat een kernel die kan "geconfig(8)ed" worden, gebouwd
kan worden.

<p>
U kan hier de platform-specifieke configuratiebestanden zien:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">alpha Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">i386 Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">macppc Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">sparc Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">sparc64 Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">vax Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/hppa/conf/">hppa Kernel Configuratiebestanden</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Andere Architecturen</a>
</ul>

<p>
Bekijk deze bestanden van nabij en u zal bovenaan een lijn opmerken
gelijkaardig aan:
<pre>
     include "../../../conf/GENERIC"
</pre>
Dit betekent dat het naar een ander configuratiebestand verwijst,
één dat de platform-onafhankelijke opties bewaart. Wanneer u
uw kernelconfiguratie aanmaakt, overloop dan zeker
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">sys/conf/GENERIC</a>. 
<p>
Kernel configuratie-opties moeten in uw kernelconfiguratiebestand geplaatst
worden in het volgende formaat:
<blockquote>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>name</i>
</blockquote>
of
<blockquote><pre>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>name=value</i> 
</pre></blockquote>


Bijvoorbeeld, om de optie "DEBUG" in de kernel te plaatsen, voegt u een lijn
als deze toe:

<blockquote><pre>
option      DEBUG
</pre></blockquote>

Opties in de OpenBSD kernel worden vertaald in compiler preprocessor opties,
daarom zou een optie als DEBUG ervoor zorgen dat de broncode gecompileerd
wordt met de optie -DDEBUG, wat equivalent is met een <tt>#define DEBUG</tt>
te doen doorheen de hele kernel.

<p>
Soms kan het dat u een optie wenst uit te schakelen die reeds gedefinieerd is,
typisch in het "<tt>src/sys/conf/GENERIC</tt>" bestand. Hoewel u een kopie
van dat bestand zou kunnen wijzigen, is het een betere keuze om de
<i>rmoption</i> opdracht te gebruiken. Als u bijvoorbeeld echt de in-kernel
debugger wil uitschakelen (<i>niet aanbevolen!</i>), zou u een lijn als deze
toevoegen:
<pre>
     rmoption DDB
</pre>
in uw kernelconfiguratiebestand. <tt>option DDB</tt> wordt gedefinieerd in
<tt>src/sys/conf/GENERIC</tt>, maar de bovenstaande <tt>rmoption</tt> lijn
deactiveert ze.

<p>
Nog eens, zie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
voor meer informatie over de bijzonderheden van deze opties. Merk ook op
dat veel van de opties ook hun eigen manual pagina's hebben -- lees steeds
alles wat over een optie beschikbaar is alvorens deze toe te voegen aan of te
verwijderen uit uw kernel.

<p>
<h3>Een op maat gemaakte kernel bouwen</h3>

In dit geval zullen we een kernel bouwen die de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boca&amp;sektion=4">boca(4)</a>
ISA multi-poort seriële kaart ondersteunt.
Deze kaart is niet aanwezig in de GENERIC kernel, door conflicten met andere
drivers.

Een andere veel voorkomende reden om een kernel op maat te maken zou zijn om
RAIDframe te gebruiken, dat te groot is om in de stock kernel te hebben.
Er zijn twee veel voorkomende manieren om een kernel op maat te maken:
kopieer het GENERIC config bestand naar een andere naam en bewerk het, of
maak een "wrapper" bestand aan dat de standaard GENERIC kernel "include"t
en gelijk welke opties die u nodig hebt en niet in GENERIC staan.
In dit geval ziet ons wrapper bestand er zo uit:
<blockquote><pre>
include "arch/i386/conf/GENERIC"

boca0  at       isa? port 0x100 irq 10     # BOCA 8-port serial cards
pccom* at       boca? slave ?
</pre></blockquote>

De twee lijnen met betrekking tot de boca(4) kaart zijn gekopieerd van de
uitgecommentarieerde lijnen in <tt>GENERIC</tt>, met het IRQ aangepast zoals
nodig.
Het voordeel van dit "wrapper" bestand te gebruiken is dat gelijk welke
ongerelateerde wijzigingen in GENERIC automatisch geüpdatet worden bij
gelijk welke andere broncode update. Het nadeel is dat men geen devices kan
verwijderen (hoewel dat in het algemeen toch een slecht idee is).

<p>
Een andere manier om een op maat gemaakte kernel te genereren is om een kopie
te maken van de standaard <tt>GENERIC</tt>, deze een andere naam te geven,
en vervolgens te bewerken zoals nodig.
Het nadeel hiervan is dat latere updates aan het GENERIC configuratiebestand
in uw kopie moeten ge"merged" worden, of dat u uw configuratiebestand
opnieuw moet maken.

<p>
In beide gevallen, na het op maat maken van uw kernel configuratiebestand,
gebruikt u config(8) en maakt de kernel zoals gedocumenteerd
<a href="#BldKernel">hierboven</a>.


<p>
Volledige instructies voor het aanmaken van uw eigen kernel staan in de
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8#EXAMPLES+(kernel">
config(8)</a> man pagina.


<a name="BootConfig"></a>
<h2>5.8 - Boot-Time Configuratie</h2>

<p>
Soms wanneer u uw systeem boot, zou het kunnen dat u opmerkt dat de kernel
uw device vindt maar misschien op de verkeerde IRQ. En misschien moet u dit
device meteen gebruiken. Wel, zonder de kernel opnieuw te bouwen, kan u
OpenBSD's boot time kernelconfiguratie gebruiken. Dit zal uw probleem slechts
voor één keer corrigeren. Als u herstart, zal u deze procedure
moeten herhalen. Dus, dit is slechts als tijdelijke oplossing bedoeld, en u
corrigeert het probleem best door <a href="#config">config(8)</a> te gebruiken.
Uw kernel heeft echter <strong>option BOOT_CONFIG</strong> nodig, wat het
geval is bij GENERIC.

<p>
Het grootste deel van dit document kan u vinden in de man pagina
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;sektion=8">boot_config(8)</a>.

<p>
Om in de User Kernel Config, of UKC, te booten, gebruikt u de -c optie bij
het booten.

<blockquote><pre>
boot&gt; <strong>boot hd0a:/bsd -c</strong>
</pre></blockquote>

Of welke kernel u ook wil booten. Dit zal een UKC prompt tevoorschijn brengen.
Van daar kan u rechtstreeks aan de kernel commando's opgeven die devices
specificeren die u wil veranderen of uitschakelen of zelfs inschakelen.

<p>
Hier is een lijst van vaak voorkomende commando's in de UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - Voeg een device toe door een ander te kopiëren
<li><tt>change <strong>devno | device </strong></tt> - Wijzig één of meer devices
<li><tt>disable <strong>devno | device </strong></tt> - Schakel één of meer devices uit
<li><tt>enable <strong>devno | device </strong></tt> - Schakel één of meer devices in
<li><tt>find <strong>devno | device </strong></tt> - Vind één of meer devices
<li><tt>help</tt> - Korte samenvatting van deze commando's
<li><tt>list</tt> - Toon ALLE gekende devices
<li><tt>exit/quit</tt> - Ga verder met Booten
<li><tt>show <strong>[attr [val]]</strong></tt> - Toon devices met een attribuut en optioneel met een gespecificeerde waarde
</ul>

<p>
Zodra u uw kernel geconfigureerd hebt, gebruikt u <tt>quit</tt> of
<tt>exit</tt> en gaat u verder met booten.
Daarna zou u de verandering blijvend moeten maken in uw kernel image,
zoals beschreven in <a href="#config">Uw kernel aanpassen met
config(8)</a>.


<p>
<a name="config"></a>
<h2>5.9 - Uw kernel aanpassen met config(8)</h2>
<p>
De <b>-e</b> en <b>-u</b> opties van
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
kunnen erg behulpzaam zijn en tijdsverspilling vermijden bij het compileren
van uw kernel. De <b>-e</b> vlag laat u toe om de UKC of User Kernel Config
binnen te gaan op een draaiend systeem. Deze veranderingen zullen dan
plaatsvinden bij de volgende reboot.
De <b>-u</b> vlag test om te zien of er tijdens het booten veranderingen
gedaan werden aan de draaiende kernel, wat betekent dat u <b>boot -c</b>
gebruikte om de UKC binnen te gaan tijdens het booten van uw systeem.

<p>
Het volgende voorbeeld toont het uitschakelen van de ep* devices in de
kernel. Voor de veiligheid moet u de <b>-o</b> optie gebruiken die de
veranderingen wegschrijft naar het aangegeven bestand. Bijvoorbeeld:
<strong>config -e -o bsd.new /bsd</strong> zal de veranderingen schrijven naar
bsd.new. Het voorbeeld gebruikt de <b>-o</b> optie niet, daarom worden
veranderingen gewoon genegeeerd, en niet teruggeschreven naar de kernel binary.
Voor meer informatie relevant voor fout- en waarschuwingsboodschappen, leest u
de 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
man pagina.

<!--XXXver -->
<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
OpenBSD 4.6 (GENERIC) #58: Thu Jul  9 21:24:42 MDT 2009
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
warning: no output file specified
Enter 'help' for information
ukc&gt; <strong>?</strong>
        help                                Command help list
        add             dev                 Add a device
        base            8|10|16             Base on large numbers
        change          devno|dev           Change device
        disable         attr val|devno|dev  Disable device
        enable          attr val|devno|dev  Enable device
        find            devno|dev           Find device
        list                                List configuration
        lines           count               # of lines per page
        show            [attr [val]]        Show attribute
        exit                                Exit, without saving changes
        quit                                Quit, saving current changes
        timezone        [mins [dst]]        Show/change timezone
        bufcachepercent [number]            Show/change BUFCACHEPERCENT
        nkmempg         [number]            Show/change NKMEMPAGES
        shmseg          [number]            Show/change SHMSEG
        shmmaxpgs       [number]            Show/change SHMMAXPGS
ukc&gt; <strong>list</strong>
  0 video* at uvideo* flags 0x0
  1 audio* at uaudio*|btsco*|sb0|sb*|gus0|pas0|sp0|ess*|wss0|wss*|ym*|eap*|envy*
|eso*|sv*|neo*|cmpci*|clcs*|clct*|auacer*|auglx*|auich*|auixp*|autri*|auvia*|aza
lia*|fms*|maestro*|esa*|yds*|emu* flags 0x0
  2 midi* at umidi*|sb0|sb*|opl*|opl*|opl*|opl*|opl*|ym*|mpu*|mpu*|autri*|eap* f
lags 0x0
  3 midi* at pcppi0 flags 0x0
  4 drm* at inteldrm*|radeondrm* flags 0x0
  5 inteldrm* at vga0|vga* flags 0x0
  6 radeondrm* at vga0|vga* flags 0x0
  7 radio* at udsbr*|bktr0|fms* flags 0x0
  8 softraid0 at root flags 0x0
  9 nsphy* at url*|udav*|mos*|axe*|aue*|xe*|ef*|hme*|lii*|bce*|ale*|age*|jme*|et
*|nfe*|stge*|vge*|bnx*|bge*|lge*|nge*|msk*|sk*|ste*|sis*|wb*|tl*|vr*|pcn*|sf*|ge
m*|ne0|ne1|ne2|ne*|ne*|ne*|epic*|sm0|sm*|dc*|dc*|re*|re*|rl*|rl*|mtd*|fxp*|fxp*|
xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
 10 nsphyter* at url*|udav*|mos*|axe*|aue*|xe*|ef*|hme*|lii*|bce*|ale*|age*|jme*
|et*|nfe*|stge*|vge*|bnx*|bge*|lge*|nge*|msk*|sk*|ste*|sis*|wb*|tl*|vr*|pcn*|sf*
|gem*|ne0|ne1|ne2|ne*|ne*|ne*|epic*|sm0|sm*|dc*|dc*|re*|re*|rl*|rl*|mtd*|fxp*|fx
p*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
[...snip...]
ukc&gt; <strong>disable ep</strong>
 98 ep0 disabled
 99 ep* disabled
100 ep* disabled
278 ep0 disabled
279 ep0 disabled
280 ep* disabled
281 ep* disabled
344 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
In het bovenstaande voorbeeld worden alle ep* devices uitgeschakeld in de
kernel en ze zullen niet gezocht worden. In sommige situaties waarbij u
tijdens het booten de UKC gebruikt hebt, via <b>boot -c</b>, zal u deze
veranderingen permanent moeten wegschrijven. Om dit te doen moet u de
<b>-u</b> optie gebruiken.
In het volgende voorbeeld werd de computer geboot naar de UKC en werd het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wi&amp;sektion=4">wi(4)</a>
device uitgeschakeld. Aangezien veranderingen gemaakt met boot -c
NIET blijvend zijn, moeten deze veranderingen weggeschreven worden.
Dit voorbeeld schrijft de veranderingen gemaakt met boot -c naar een
nieuwe kernel binary bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 4.6 (GENERIC) #58: Thu Jul  9 21:24:42 MDT 2009
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
162 wi* disabled
163 wi* disabled
416 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>


<a name="VerboseBoot"></a>
<h2>5.10 - Meer uitgebreide uitvoer bekomen tijdens het opstarten</h2>

Meer uitgebreide uitvoer bekomen kan heel nuttig zijn bij het proberen
debuggen van problemen bij het booten. Als u een probleem hebt waarbij uw
bootdiskette niet wil booten en u meer informatie moet verkrijgen, herstart
dan gewoon. Wanneer u aan de &quot;boot&gt;&quot; prompt bent gekomen, boot
dan met boot -c. Dit brengt u naar de UKC&gt;, doe vervolgens:

<blockquote><pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre></blockquote>

<p>
Nu zal u extreem uitvoerige uitvoer gegeven worden bij het booten.



<p>
<a name="buildprobs"></a>
<h2>5.11 - Vaak voorkomende problemen, tips en vragen bij het compileren en
bouwen</h2>

Meestal worden problemen in het bouwproces veroorzaakt door de bovenstaande
richtlijnen niet nauwkeurig te volgen.
Er zijn soms echte problemen bij het bouwen van <i>-current</i> vanuit het
meest recente snapshot, maar mislukking bij het bouwen van <i>-release</i>
of <i>-stable</i> zijn bijna altijd een fout van de gebruiker.

<p>
De meeste problemen zijn gewoonlijk één van de volgende:
<ul>
<li>Niet starten vanaf de <a href="#BldBinary">gepaste binary</a>,
inclusief proberen te upgraden vanaf broncode of veronderstellen dat
een snapshot van een week oud "dichtbij genoeg" is.
<li><a href="#BldGetSrc">Checkout</a> van een verkeerde branch van de tree.
<li>Het <a href="faq5.html">proces</a> niet volgen.
<li>Uw systeem proberen <a href="#Why">aan te passen</a> of te "optimaliseren".
</ul>

Hier zijn echter nog bijkomende problemen die u kan tegenkomen:

<a name="sig11"></a>
<h3>5.11.1 - De build stopte met een "Signal 11" fout</h3>

<p>
OpenBSD en andere programma's vanaf broncode bouwen, is een taak die meer
van hardware vergt dan de meeste andere, het gebruikt intensief de CPU, de
schijf en het geheugen. Dit heeft als gevolg dat, indien u hardware hebt die
een probleem heeft, het meest waarschijnlijke moment waarop dit probleem zich
zal voordoen, gedurende een build is. Signal 11 fouten worden <i>typisch</i>
veroorzaakt door hardwareproblemen, heel vaak geheugenproblemen, maar het
kunnen ook problemen met CPU, moederbord of warmte zijn. Uw systeem kan
verder eigenlijk heel stabiel zijn, maar het kan geen programma's compileren.

<p>
U zal het waarschijnlijk het best vinden om de componenten die problemen
veroorzaken, te vervangen, aangezien de problemen zich in de toekomst op andere
manieren kunnen manifesteren. Als u hardware hebt die u echt wenst te
gebruiken en die u geen andere problemen geeft, installeer dan gewoon een
snapshot of een release.

<p>
Voor veel meer informatie, zie de
<a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a>.

<a name="snake"></a>
<h3>5.11.2 - "make build" mislukt met "cannot open output file snake: is
a directory"</h3>

Dit is het resultaat van twee afzonderlijke fouten:
<ul>
<li><b>Het niet juist afhalen of updaten van uw CVS tree.</b>  Wanneer u
een CVS checkout handeling doet, moet u de "<tt>-P</tt>" optie gebruiken,
bij een update van uw source tree met CVS moet u de "<tt>-Pd</tt>"
opties van
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a> gebruiken,
zoals gedocumenteerd <a href="#BldGetSrc">hierboven</a>.
Deze opties zorgen ervoor dat nieuwe directories worden toegevoegd aan en
verwijderd uit de tree naarmate OpenBSD evolueert.

<li><b>U hebt de <tt>obj</tt> directory niet juist aangemaakt
vóór uw build.</b>  De tree bouwen zonder een <tt>/usr/obj</tt>
directory wordt niet ondersteund.

</ul>
Het is belangrijk om nauwkeurig de instructies te volgen bij het
<a href="#BldGetSrc">afhalen</a> en <a href="#Bld">bouwen</a> van uw
tree.

<a name="ProbIPv6"></a>
<h3>5.11.3 - Mijn IPv6-loos systeem werkt niet!</h3>
Ja.
Breng alstublieft geen wijzigingen in het basissysteem aan waarvan u de
implicaties niet begrijpt.
Een "kleine" verandering in de kernel kan een heel grote impact hebben op
de volledige rest van het systeem.
Herlees alstublieft <a href="#Why">dit</a>.


<a name="ProbObj"></a>
<h3>5.11.4 - Oeps! Ik vergat eerst de <tt>/usr/obj</tt> directory aan te
maken!</h3>

Door een "make build" te doen voor een "make obj" zal u met de object
bestanden verstrooid in uw <tt>/usr/src</tt> directory komen te zitten.
Dit is een slechte zaak.
Als u wenst te vermijden om uw volledige src tree opnieuw af te halen, kan
u het volgende proberen om obj bestanden er uit te poetsen:
<pre>
    # <b>cd /usr/src</b>
    # <b>find . -type l -name obj | xargs rm</b>
    # <b>make cleandir</b>
    # <b>rm -rf /usr/obj/*</b>
    # <b>make obj</b>
</pre>

<a name="ProbObjPt"></a>
<h3>5.11.5 - Tip: Zet <tt>/usr/obj</tt> op zijn eigen partitie</h3>
Indien u vaak bouwt, kan u het sneller vinden om <tt>/usr/obj</tt> op zijn
eigen partitie te zetten.
Het voordeel is eenvoudig, het is typisch sneller om
<pre>
    # <b>umount /usr/obj</b>
    # <b>newfs <i>YourObjPartition</i></b>
    # <b>mount /usr/obj</b>
</pre>
dan om "rm -rf /usr/obj/*" te doen.

<a name="ProbSKIPDIR"></a>
<h3>5.11.6 - Hoe bouw ik delen van de tree niet?</h3>
Soms kan u wensen bepaalde delen van de tree niet te bouwen, typisch omdat
u een vervanging hebt geïnstalleerd voor een gebundelde toepassing vanuit
packages, of een "kleinere" release wenst te maken om welke reden dan ook.
De oplossing hiervoor is om de SKIPDIR optie te gebruiken in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mk.conf&amp;sektion=5">/etc/mk.conf</a>.

<p>
Opmerking: het is mogelijk om op deze manier een gebroken systeem te maken.
De resultaten van deze optie worden niet ondersteund door het OpenBSD project.

<a name="ProbMoreInfo"></a>
<h3>5.11.7 - Waar kan ik meer leren over het bouwproces?</h3>
Hier zijn enkele andere bronnen:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8#COMPILING+A">afterboot(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mk.conf&amp;sektion=5">mk.conf(5)</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/Makefile"><tt>/usr/src/Makefile</tt></a>
<li><a href="../../nl/stable.html">Patch Branches</a> (<i>-stable</i>)
<li>(voor X) <tt>/usr/X11R6/README</tt> op uw geïnstalleerd systeem

</ul>

<a name="NoSnaps"></a>
<h3>5.11.8 - Ik zag geen snapshots op de FTP site. Waar zijn ze naartoe?</h3>

<p>
Snapshots kunnen verwijderd worden naarmate ze oud (of niet langer relevant)
worden wanneer het moment van een nieuwe <i>-release</i> nadert.

<a name="NewCompiler"></a>
<h3>5.11.9 - Hoe bootstrap ik een nieuwere versie van de compiler
(<i>gcc</i>)?</h3>

U zou echt best gewoon <a href="#BldBinary">het laatste snapshot
installeren</a>.

<p>
OpenBSD ondersteunt nu twee compilers in-tree, gcc v3.3.5 gebruikt door de
meeste platformen, maar ook gcc v2.95.3 gebruikt door enkele platformen die
nog niet omgeschakeld werden, of misschien nooit omgeschakeld zullen worden
door gebrek aan gcc3 ondersteuning of slechte gcc3 prestatie.

<p>
De twee compilers staan in verschillende delen van de tree:
<ul>
<li>gcc3: <tt>/usr/src/gnu/usr.bin/gcc</tt>
<li>gcc2: <tt>/usr/src/gnu/egcs/gcc</tt>
</ul>

<p>
Omdat een compiler upgraden een beetje een kip-en-ei probleem is,
vereisen veranderingen aan de in-tree compiler een beetje extra aandacht.
U moet de compiler tweemaal bouwen -- de eerste bouw produceert een
compiler die nieuwe code genereert maar draait met code gegenereerd door de
oude compiler, de tweede bouw maakt er een volledig nieuwe compiler van.
In het algemeen zal u de volgende procedure willen uitvoeren:

<pre> 
    <b>Indien uw platform gcc 2.95.3 gebruikt:</b>
       # rm -r /usr/obj/gnu/egcs/gcc/*
       # cd /usr/src/gnu/egcs/gcc     
        <i>- or -</i>
    <b>Indien uw platform gcc 3.3.5: gebruikt:</b>
       # rm -r /usr/obj/gnu/usr.bin/gcc/*  
       # cd /usr/src/gnu/usr.bin/gcc

    <b>Gemeenschappelijke bouwprocedure voor v3.3.5 of v2.95.3</b>
    # make -f Makefile.bsd-wrapper clean
    # make -f Makefile.bsd-wrapper obj
    # make -f Makefile.bsd-wrapper depend
    # make -f Makefile.bsd-wrapper
    # make -f Makefile.bsd-wrapper install
    # make -f Makefile.bsd-wrapper clean
    # make -f Makefile.bsd-wrapper depend
    # make -f Makefile.bsd-wrapper
    # make -f Makefile.bsd-wrapper install
</pre>

<p>
En vervolgens voert u een normale <a href="#BldUserland">make build</a> uit.

<a name="UpdateEtc"></a>
<h3>5.11.10 - Wat is de beste manier om <tt>/etc</tt>, <tt>/var</tt>,
en <tt>/dev</tt> te updaten?</h3>

<p>Als beleid, wijzigt software in de OpenBSD tree niet automatisch bestanden
in <tt>/etc</tt>.
Dit betekent dat het <i>altijd</i> aan de beheerder is om daar de nodige
wijzigingen uit te voeren.
Upgrades vormen geen uitzondering.
Om bestanden in deze directories te updaten, bepaalt u eerst welke
veranderingen zich hebben voorgedaan in de basis (distributie) bestanden, en
vervolgens brengt u deze wijzigingen handmatig opnieuw aan.

<p>
Om bijvoorbeeld de bestanden in de tree te zien die het meest recent
veranderd zijn, doet u:

<pre>
    # cd /usr/src/etc
    # ls -lt |more
</pre>

<!-- XXXversion -->
<p>Om alle veranderingen in <tt>/etc</tt> te zien tussen willekeurige versies
van OpenBSD, kan u <a href="../../nl/anoncvs.html">CVS</a> gebruiken.
Om bijvoorbeeld de veranderingen te zien tussen 4.5 en 4.6, doet u:

<pre>
    # cd /usr/src/etc
    # cvs diff -u -rOPENBSD_4_5 -rOPENBSD_4_6
</pre>

Om de veranderingen te zien tussen 4.6 en <i>-current</i> ("HEAD"), gebruikt u:
<pre>
    # cd /usr/src/etc
    # cvs diff -u -rOPENBSD_4_6 -rHEAD
</pre>

Het
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">/dev/MAKEDEV</a>
script wordt niet automatisch geüpdatet als onderdeel van het make build
proces, het wordt echter geïnstalleerd als onderdeel van een
<a href="#BldBinary">binaire upgrade</a>.
Als algemene regel is het een goed idee om dit script (indien nodig) te
kopieren en uit te voeren vanuit uw source tree wanneer u een upgrade uitvoert:

<pre>
    # cd /dev
    # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
    # ./MAKEDEV all
</pre>

<p>
Zodra u de veranderingen geïdentificeerd hebt, brengt u ze opnieuw aan in uw
lokale tree, en behoudt daarbij gelijk welke lokale configuratie die u hebt
gedaan.

<p>
Typische <tt>/etc</tt> veranderingen om voor uit te kijken tussen releases
omvatten:

<ul>
<li>Toevoegingen aan <tt>/etc/protocols</tt> en <tt>/etc/services</tt></li>
<li>Nieuwe sysctls (zie <tt>/etc/sysctl.conf</tt>)</li>
<li>Veranderingen aan de standaard cron jobs. Zie <tt>/etc/daily</tt>,
  <tt>/etc/weekly</tt>, <tt>/etc/monthly</tt> en <tt>/etc/security</tt>
<li>Alle rc scripts, inclusief netstart</li>
<li>Device veranderingen, zie boven
<li>Bestandshierarchie-veranderingen in <tt>/etc/mtree</tt>, zie
  <a href="#Hierarchy">hieronder</a>
<li>Nieuwe gebruikers (<tt>/etc/passwd</tt>) en groepen (<tt>/etc/group</tt>)
</ul>

<!-- XXXversion -->
Deze veranderingen worden samengevat in
<a href="../upgrade46.html">upgrade46.html</a> (om naar 4.6-release te gaan)
of <a href="../current.html">current.html</a> (om naar <i>-current</i> te gaan).


<a name="Hierarchy"></a>
<h3>5.11.11 - Is er een gemakkelijke manier om alle veranderingen aan de
bestandshiërarchie uit te voeren?</h3>

<p>
Van tijd tot tijd worden bestanden of directories toegevoegd aan of verwijderd
uit de bestands<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hier&amp;sektion=7">hiërarchie</a>.
Ook kan eigendomsinformatie voor delen van het bestandssysteem veranderen.
Een gemakkelijke manier om ervoor te zorgen dat uw bestandshiërarchie
up-to-date is, is om de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>
utility te gebruiken.

<p>
Haal eerst de laatste broncode af, en doe vervolgens:

<pre>
    # cd /usr/src/etc/mtree
    # install -c -o root -g wheel -m 600 special /etc/mtree
    # install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
    # mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>

<p>
Uw bestandshiërarchie zou nu up to date moeten zijn.

<a name="ProbXComp"></a>
<h3>5.11.12 - Kan ik cross-compileren? Waarom niet?</h3>
Er zitten cross-compileertools in het systeem, voor gebruik door ontwikkelaars
die een nieuw platform lanceren.
Ze worden echter niet onderhouden voor algemeen gebruik.

<p>
Wanneer de ontwikkelaars ondersteuning voor een nieuw platform lanceren,
is één van de eerste grote tests een "native build".
Het systeem vanaf broncode bouwen zet een aanzienlijke belasting op het OS
en de machine, en laat toe heel goed te testen hoe goed het systeem echt werkt.
Om deze reden doet OpenBSD het hele bouwproces op het platform waarvoor
de build gebruikt wordt, ook bekend als "native building".
Zonder native building is het veel moeilijker om er zeker van te zijn dat
de verscheidene platformen werkelijk betrouwbaar draaien, en niet enkel
opstarten.

<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[Naar Sectie 4 - Installatiegids]</a>
<a href= "faq6.html">[Naar Sectie 6 - Netwerken]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[terug]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq5.html,v 1.177 ]<br>
$Translation: faq5.html,v 1.61 2009/11/30 18:27:32 maurice Exp $<br>
-->
$OpenBSD: faq5.html,v 1.52 2009/12/09 08:30:06 ajacoutot Exp $
</small>
</body>
</html>
