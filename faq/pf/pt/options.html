<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Opções em Tempo de Execução</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../pt/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="shortcuts.html">Anterior: Atalhos na Criação de
Conjuntos de Regras</a>]
[<a href="index.html">Conteúdo</a>]
[<a href="anchors.html">Próximo: Âncoras</a>]

<p>
<h1><font color="#e00000">PF: Opções em Tempo de Execução</font></h1>

<hr>

<p>
Opções são usadas para controlar a operação do PF. Elas são
especificadas no <tt>pf.conf</tt> usando a diretiva <tt>set</tt>.

<p>
<b><font color="#ff0000">NOTA:</font></b> No OpenBSD 3.7 e posteriores,
o comportamento das opções em tempo de execução foi modificado.
Anteriormente, uma vez que uma opção foi definida ela nunca seria
redefinida para seu valor padrão, mesmo se o conjunto de regras fosse
recarregado.
A partir do OpenBSD 3.7, quando um conjunto de regras é carregado, as
opções em tempo de execução são redefinidas para os valores padrão antes
do conjunto de regras ser carregado.
Assim, se uma opção é definida e é então removida do conjunto de regras,
e o conjunto de regras for recarregado, a opção será redefinida para o
seu valor padrão.

<a name="block-policy"></a>
<p>
<dl>
<dt><tt>set block-policy <i>opção</i></tt><br>
<dd>Define o comportamento padrão para regras de <a href="filter.html">
filtragem</a> que especifiquem <tt>block</tt> como ação.
<ul>
<li><tt>drop</tt> - o pacote é descartado silenciosamente.
<li><tt>return</tt> - um pacote TCP RST é retornado para pacotes TCP
    bloqueados e um pacote ICMP de Inalcançável é enviado para todos os
    outros pacotes.
</ul>
<dd>Note que regras de filtragem individuais podem sobrescrever
a resposta padrão.
O padrão é <tt>drop</tt>.
</dl>

<a name="debug"></a>
<p>
<dl>
<dt><tt>set debug <i>opção</i></tt><br>
<dd>Define o nível de depuração do PF.
<ul>
<li><tt>none</tt> - mensagens de depuração não são mostradas.
<li><tt>urgent</tt> - mensagens de depuração para erros sérios.
<li><tt>misc</tt> - mensagens de depuração geradas por vários erros
    (por exemplo, para ver o status do normalizador de pacotes/scrubber
    e para falhas na criação de estados de conexões).
<li><tt>loud</tt> - mensagens de depuração geradas por condições normais
    (por exemplo, para ver o status da detecção passiva de SO).
</ul>
<dd>O padrão é <tt>urgent</tt>.
</dl>

<a name="fingerprints"></a>
<p>
<dl>
<dt><tt>set fingerprints <i>arquivo</i></tt><br>
<dd>Define o arquivo do qual carregar as impressões digitais
de sistemas operacionais. Para uso com
<a href="filter.html#osfp">detecção passiva de SO</a>.
O padrão é <tt>/etc/pf.os</tt>.

</dl>

<a name="limit"></a>
<p>
<dl>
<dt><tt>set limit <i>opção</i></tt><br>
<dd>Configura vários limites da operação do pf.
<ul>
<li><tt>frags</tt> - número máximo de entradas na área de memória usada
    para reconstrução de pacotes (regras scrub). O padrão é 5000.
<li><tt>src-nodes</tt> - número máximo de entradas na área de memória
    destinada ao registro de endereços IP de origem (gerados pelas
    opções <tt>sticky-address</tt> e <tt>source-track</tt>).
    O padrão é 10000.
<li><tt>states</tt> - número máximo de entradas na área de memória usada
    para as entradas na tabela de estados (regras de
    <a href="filter.html">filtragem</a> que especificam
    <tt>keep state</tt>). O padrão é 10000.
<li><tt>tables</tt> - número máximo de
    <a href="tables.html">tabelas</a> que podem ser criadas.
    O padrão é 1000.
<li><tt>table-entries</tt> - o limite geral de quantos endereços podem
    ser armazenados em todas as tabelas.
    O padrão é 200000.
    Se o sistema tem menos que 100MB de memória física, o valor padrão
    é definido para 100000.
</ul>
</dl>

<a name="loginterface"></a>
<p>
<dl>
<dt><tt>set loginterface <i>interface</i></tt><br>
<dd>Define a interface onde o PF deve colher estatísticas, como bytes
entrando/saindo e pacotes permitidos/bloqueados. Estatísticas podem ser
obtidas de apenas <i>uma</i> interface por vez. Perceba que os
contadores <tt>match</tt>, <tt>bad-offset</tt>, etc., e os contadores
das tabelas de estado são registrados independente da opção
<tt>loginterface</tt> estar definida ou não.
Para desabilitar essa opção, configure-a para <tt>none</tt>.
O padrão é <tt>none</tt>.
</dl>

<a name="optimization"></a>
<p>
<dl>
<dt><tt>set optimization <i>opção</i></tt><br>
<dd>Otimiza o PF para um dos ambientes de rede a seguir:
<ul>
<li><tt>normal</tt> - adequado para a maioria das redes.
<li><tt>high-latency</tt> - redes de alta latência, como conexões via
    satélite.
<li><tt>aggressive</tt> - expira agressivamente conexões da tabela de
    estados. Isso pode diminuir drasticamente os requisitos de memória
    em um firewall muito carregado, o preço é o risco de se descartar
    conexões inativas muito cedo.
<li><tt>conservative</tt> - configurações extremamente conservadoras.
    Evita o descarte de conexões inativas ao custo de maior utilização
    de memória e um pequeno aumento na utilização do processador.
</ul>
<dd>O padrão é <tt>normal</tt>.
</dl>

<a name="ruleset-optimization"></a>
<p>
<dl>
<dt><tt>set ruleset-optimization <i>opção</i></tt>
<dd>Controla o funcionamento do otimizador de conjunto de regras do PF.
<ul>
<li><tt>none</tt> - desabilita totalmente o otimizador.
<li><tt>basic</tt> - ativa as seguintes otimizações de
    conjunto de regras:
	<ol>
	<li>remove regras duplicadas
	<li>remove regras que são um subconjunto de uma outra regra
	<li>combina múltiplas regras dentro de uma tabela quando isso
            for vantajoso
	<li>reordena as regras para melhorar o desempenho de avaliação
	</ol>
<li><tt>profile</tt> - usa o conjunto de regras carregado atualmente
    como um perfil de retorno para fazer o ordenamento das regras
    contendo a palavra-chave "quick" para o tráfego de rede real.
</ul>
<dd>A partir do OpenBSD 4.2, o padrão é <tt>basic</tt>.
Veja
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.6"
>pf.conf(5)</a> para obter uma descrição mais completa.
</dl>

<a name="skip"></a>
<p>
<dl>
<dt><tt>set skip on <i>interface</i></tt><br>
<dd>Pula <i>todo</i> o processamento do PF na <tt><i>interface</i></tt>.
Isso pode ser útil em interfaces loopback, onde filtragem, normalização,
enfileiramento, etc., não são requeridos.
Essa opção pode ser usada múltiplas vezes.
Por padrão essa opção não é definida.
</dl>

<a name="state-policy"></a>
<p>
<dl>
<dt><tt>set state-policy <i>opção</i></tt><br>
<dd>Define o comportamento do PF ao manter o estado das conexões.
Esse comportamento pode ser alterado ao nível de cada regra.
Veja <a href="filter.html#state">Mantendo o Estado</a>.
<ul>
<li><tt>if-bound</tt> - estados são associados à interface onde foram
    criados.
    Caso o tráfego corresponda a uma entrada na tabela de estados, mas
    não atravessa a interface onde a entrada foi criada, o tráfego
    correspondente é rejeitado. O pacote deve então corresponder a uma
    regra de filtragem ou será descartado/rejeitado totalmente.
<li><tt>floating</tt> - estados podem corresponder à pacotes em qualquer
    interface. Contanto que o pacote corresponda a uma entrada de
    estado e esteja passando na mesma direção que estava na interface
    quando o estado foi criado, não importa qual interface ele está
    cruzando, ele será permitido.
</ul>
<dd>O padrão é <tt>floating</tt>.
</dl>

<a name="timeout"></a>
<p>
<dl>
<dt><tt>set timeout <i>opção</i></tt><br>
<dd>Configura vários tempos de expiração (em segundos).
<ul>
<li><tt>interval</tt> - número de segundos entre a remoção de registros
    de estados expirados e pacotes fragmentados.
    O padrão é <tt>10</tt>.
<li><tt>frag</tt> - número de segundos antes que um pacote fragmentado
    sendo reconstruído expire.
    O padrão é <tt>30</tt>.
<li><tt>src.track</tt> - número segundos para manter uma entrada de
    <a href="filter.html#stateopts">rastreamento de origem</a> na
    memória depois que o último estado expirar.
    O padrão é <tt>0</tt> (zero).
</ul>
</dl>

<p>
Exemplo:
<p>
<table border="0" width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
set timeout interval 10
set timeout frag 30
set limit { frags 5000, states 2500 }
set optimization high-latency
set block-policy return
set loginterface dc0
set fingerprints "/etc/pf.os.test"
set skip on lo0
set state-policy if-bound
</pre>
</td></tr>
</table>


<p>
[<a href="shortcuts.html">Anterior: Atalhos na Criação de
Conjuntos de Regras</a>]
[<a href="index.html">Conteúdo</a>]
[<a href="anchors.html">Próximo: Âncoras</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[voltar]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: options.html,v 1.22 ]<br>
$Translation: options.html,v 1.12 2009/11/06 15:21:51 alan Exp $<br>
-->
$OpenBSD: options.html,v 1.11 2009/11/07 07:32:54 ajacoutot Exp $
</small>

</body>
</html>
