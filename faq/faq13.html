<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>13 - Multimedia</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<!--
Copyright (c) 2005-2007 Steven Mestdagh <steven@openbsd.org>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor= "#ffffff" text= "#000000">

<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq12.html">[To Section 12 - Hardware and Platform-Specific Questions]</a>
<a href= "faq14.html">[To Section 14 - Disk Setup]</a>
</font>

<h1><font color="#e00000">13 - Multimedia</font></h1><hr>

<h3>Table of Contents</h3>
<ul>
<li><a href="#confaudio"  >13.1 - How do I configure my audio device?</a>
<li><a href="#playaudio"  >13.2 - Playing different kinds of audio</a>
<li><a href="#playCD"     >13.3 - How can I play audio CDs in OpenBSD?</a>
<li><a href="#recordaudio">13.4 - Can I use OpenBSD to record audio samples?</a>
<li><a href="#audioserver">13.5 - How do I setup an audio server?</a>
<li><a href="#audioprob"  >13.6 - What can I do if I have audio problems?</a>
<li><a href="#midi"	  >13.7 - How do I use my MIDI instruments?</a>
<li><a href="#lossyaudio" >13.8 - Tell me about Ogg Vorbis and MP3 encoding?</a>
<li><a href="#playDVD"    >13.9 - How can I playback video DVDs in OpenBSD?</a>
<li><a href="#burnCD"     >13.10 - How do I burn CDs and DVDs?</a>
<ul>
  <li><a href="#burnIntro">13.10.1 - Introduction and basic setup</a>
  <li><a href="#writeCD"  >13.10.2 - Writing CDs</a>
  <li><a href="#writeDVD" >13.10.3 - Writing DVDs</a>
</ul>
<li><a href="#convert"    >13.11 - But I want my media files in format FOO.</a>
<li><a href="#streaming"  >13.12 - Is it possible to play streaming media under
  OpenBSD?</a>
<li><a href="#javaplugin" >13.13 - Can I have Java support in my web
  browser? (i386 &amp; amd64 only)</a>
<li><a href="#flashplugin">13.14 - Can I have Flash support in my web
  browser? (i386 only)</a>
<!--
<li><a href="#camera"     >13.xx - Can I use my digital camera under OpenBSD?</a>
<li><a href="#scanner"    >13.yy - How do I set up and use my scanner?</a>
-->
</ul>
<hr>

<a name="confaudio"></a>
<h2>13.1 - How do I configure my audio device?</h2>

The devices in OpenBSD that are related to audio are: <tt>/dev/audio</tt>,
<tt>/dev/sound</tt>, <tt>/dev/audioctl</tt> and <tt>/dev/mixer</tt>.
For a good overview of the audio driver layer, please read the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audio&amp;sektion=4">audio(4)</a>
manual page.

<p>
All supported audio drivers are already included in the GENERIC kernel so
there is no need for extra configuration or installation of drivers.
To find out about options for your specific sound chip, you must find out
which sound chip you have. Supported chips may be found on the hardware
compatibility page for your <a href="../plat.html">platform</a>.
When you already have OpenBSD running, look for a sound driver in the output
of the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
command, and read its manual page to find more specific information like
options and other details about the driver.
An example of an audio chip in a dmesg output is:

<blockquote><pre>
auich0 at pci0 dev 31 function 5 "Intel 82801BA AC97" rev 0x04: irq 10, ICH2 AC97
ac97: codec id 0x41445360 (Analog Devices AD1885)
ac97: codec features headphone, Analog Devices Phat Stereo
audio0 at auich0
</pre></blockquote>

<p>
OpenBSD base provides two tools for monitoring and configuring audio devices.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>
is used for the audio processing parameters, such as encoding,
sample rate and number of channels, while
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>
is used for the mixing parameters, such as channel source,
gain level and mute.

<p>
The following command uses
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>
to display the default processing parameters of an audio device.

<blockquote><pre>
$ <strong>audioctl -f /dev/audio</strong>
...
</pre></blockquote>

Note that <tt>-f /dev/audio</tt> was used explicitly.
Opening <tt>/dev/audio</tt> causes the audio device to reset to the default
parameters, which is what we wanted to see.

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>
is also quite useful for exploring the capabilities of an audio device.
For example, to see if the device supports some common sample rates, you
could simply try setting the playback rate:

<blockquote><pre>
$ <strong>audioctl play.rate=48000</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=44100</strong>
play.rate: -> 44100
$ <strong>audioctl play.rate=22050</strong>
audioctl: set failed: Invalid argument
$ <strong>audioctl play.rate=8000</strong>
audioctl: set failed: Invalid argument
$
</pre></blockquote>

This device supports 48000 and 44100 Hz playback rates, but not
22050 or 8000.
Note that if a sample rate is not supported, there is not always an
error message, but the returned sample rate is not the one that was desired.

<blockquote><pre>
$ <strong>audioctl play.rate=48000</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=44100</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=22050</strong>
play.rate: -> 48000
$ <strong>audioctl play.rate=8000</strong>
play.rate: -> 48000
$
</pre></blockquote>

This device supports 48000 Hz playback only.

<p>
Audio hardware is usually capable of at least some minimal mixing.
Running
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>
with no arguments will list the device's mixer controls and current settings.

<blockquote><pre>
$ <strong>mixerctl</strong>
...
</pre></blockquote>

Some devices have only a handful of controls, some have a hundred or more.
Note that not every option of every audio chip necessarily reaches the outside
world.
So there may be, for example, more outputs listed than are physically
available on a sound card or motherboard.

<p>
There are a few controls that are common to many devices:

<ul>
<li><tt>outputs.master</tt> controls the playback output level
<li><tt>inputs.dac</tt> controls the level from the DAC (digital to
analog converter), used when playing an audio file
<li><tt>record.source</tt> controls what inputs are mixed into the
ADC (analog to digital converter), used when recording
<li><tt>record.volume</tt> or <tt>record.record</tt> controls the input
level of the ADC
</ul>

The controls of an audio device may be labeled differently.
For instance, there might not be an <tt>outputs.master</tt> as above,
but there is an <tt>outputs.outputs</tt> which does the same thing.
Usually the controls have a meaningful label, but sometimes one must simply
try different settings to see what effect each control has.

<p>
Some devices use what is known as EAPD, which stands for external
amplifier power down.
However, this is just another on/off switch.
It is probably refered to as "power down" because it is often used
for power saving, which means this type of control is more often found
in laptops.
Sometimes it is necessary to set controls with <tt>eapd</tt> or
<tt>extamp</tt> in their name to <tt>on</tt> to get an output signal.

<p>
As a basic example of common mixerctl usage, to set the volume of the
left and right channels to 200, you would issue

<blockquote><pre>
$ <strong>mixerctl outputs.master=200,200</strong>
outputs.master: 255,255 -&gt; 207,207
</pre></blockquote>

Notice how the value becomes 207.
The reason for this is that this audio device has an AC'97 codec, which uses
only 5 bits for volume control, leading to only 32 possible values.
Other hardware could have different resolution.

<p>
To unmute the master channel, you would do

<blockquote><pre>
$ <strong>mixerctl outputs.master.mute=off</strong>
outputs.master.mute: on -&gt; off
</pre></blockquote>

<p>
To make the changes take affect on each reboot, edit <i>/etc/mixerctl.conf</i>,
for example:

<blockquote><pre>
$ <strong>cat /etc/mixerctl.conf</strong>
outputs.master=200,200
outputs.master.mute=off
outputs.headphones=160,160
outputs.headphones.mute=off
</pre></blockquote>


<a name="playaudio"></a>
<h2>13.2 - Playing different kinds of audio</h2>

<h3>Digitized audio</h3>

<h4>Lossless audio formats (AU, PCM, WAV, FLAC, TTA)</h4>

Some of the lossless audio formats may be played without the need for third
party software, provided they contain the uncompressed digital samples in
chunks of bytes.
These formats include Sun audio (AU), raw PCM files (without
headers), and RIFF WAV.

<p>
OpenBSD comes with
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>,
a program for recording and playing uncompressed audio.
The following example will play a WAV file.

<blockquote><pre>
$ <strong>aucat -i filename.wav</strong>
</pre></blockquote>

<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
supports both headerless and WAV audio files with the -i option.
aucat also plays Sun audio files where the audio data is encoded
as 8 kHz monaural mulaw, which is the most common encoding for this
type of audio file.

<p>
It is also possible to play uncompressed audio data by passing it
directly to the audio device.
To do this, you need to know its main parameters: encoding
type, number of channels, sample rate, bits per sample.
If you don't know this, you might find out with the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=file&amp;sektion=1">file(1)</a>
utility:

<blockquote><pre>
$ <strong>file music.au</strong>
music.au:  Sun/NeXT audio data: 16-bit linear PCM, stereo, 44100 Hz
</pre></blockquote>

<blockquote><pre>
$ <strong>file music.wav</strong>
music.wav: Microsoft RIFF, WAVE audio data, 16 bit, stereo 44100 Hz
</pre></blockquote>

The only remaining things to know about these example files is that they
use little-endian byte ordering and signed linear quantization.
You could figure this out by reading the header with
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hexdump&amp;sektion=1">hexdump(1)</a>.
If you are using a headerless (raw) file, there is no way to know the
parameters beforehand.
Set the following parameters accordingly using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>.

<blockquote><pre>
play.encoding=slinear_le
play.rate=44100
play.channels=2
play.precision=16
</pre></blockquote>

Next, pass the audio file to the sound device:

<blockquote><pre>
$ <strong>cat music.au > /dev/sound</strong>
</pre></blockquote>

If you applied the correct settings, you should be hearing what you expected.

<p>
Note: Always use <tt>/dev/sound</tt>, not <tt>/dev/audio</tt>, if you want
the settings you applied with audioctl to stay in place. 

<p>
There are other utilities you can use, such as
<tt>audio/waveplay</tt> in packages and ports.
Of course, popular software like XMMS is also able to play these files,
among other audio formats.

<p>
Apart from the above, there are audio formats which use lossless data
compression.
Examples are the Free Lossless Audio Codec (FLAC) and TTA.
The FLAC implementation has been ported to OpenBSD and may be found under
<tt>audio/flac</tt> in packages and ports.

<h4>Audio formats using lossy compression (Ogg Vorbis, MP3, WMA, AAC)</h4>

Lossy compression methods are often used for audio or other media files.
The idea is that an amount of data is thrown away during compression, but
in such a way that the compressed result is still very usable and has a
good enough quality to be played.
The advantage is that these techniques enable much higher compression ratios,
resulting in reduced disk space and bandwidth requirements.

<p>
A good example is the free, open and unpatented
<a href="http://www.vorbis.com/">Ogg Vorbis</a> format.
To play Ogg Vorbis files, you can use the ogg123 utility, which is bundled
in the <tt>audio/vorbis-tools</tt> package. For example:

<blockquote><pre>
$ <strong>ogg123 music.ogg</strong>

Audio Device:   Sun audio driver output

Playing: music.ogg
Ogg Vorbis stream: 2 channel, 44100 Hz
Time: 00:02.95 [02:21.45] of 02:24.40  (133.1 kbps)  Output Buffer  87.5%
</pre></blockquote>

Of course, Ogg Vorbis plugins exist for many other audio software.

<p>
Another example is the very popular MPEG-1 Audio Layer 3 (MP3) encoding,
which has, however, its share of licensing and patent issues.
Many tools can play MP3 files, just have a look through the <tt>audio</tt>
section of the packages and ports system and pick one you like.

<p>
How about the proprietary Windows Media Audio (WMA) format? Files of this
type can be played using <tt>x11/mplayer</tt> which uses the
<a href="http://ffmpeg.sourceforge.net">FFmpeg</a> framework.

<p>
A good starting point to learn more about different audio file formats is
this Wikipedia article:
<a href="http://en.wikipedia.org/wiki/Audio_file_format">Audio file formats</a>.

<h3>Synthesized sound</h3>

<h4>MIDI</h4>

The Musical Instrument Digital Interface (MIDI) protocol, is handled
by <a href="#midi">MIDI devices</a>.
If you don't have a MIDI synthesizer, but you wish to play a standard
MIDI file (SMF), you can use software to render MIDI data, generating
audio files.
By default, the <tt>audio/timidity</tt> port renders MIDI files and play
them on the audio device:

<blockquote><pre>
$ <strong>timidity file.mid</strong>
</pre></blockquote>

<h4>MOD</h4>

A Soundtracker module is a binary format that mixes audio samples
with sequencing orders, making it possible to play rather long pieces
of digital music with reasonably good quality.

<p>
The easiest way to play your favorite MOD files on OpenBSD is probably to
use the XMMS software, available through packages and ports.
You should install the <tt>-mikmod</tt> subpackage for XMMS to let it use
the MikMod sound library, which supports the MOD, S3M, IT and XM module
formats.

<p>
You will also find a number of so-called "trackers" in the <tt>audio</tt>
section of the packages and ports collection, e.g. tracker, soundtracker.
With these trackers you can not only play but also generate your own
modules.
Note, however, that not every tracker format is supported by the tools in
the ports tree.
You are always welcome to <a href="ports/index.html">submit a port</a>
of your favorite tracker software.


<a name="playCD"></a>
<h2>13.3 - How can I play audio CDs in OpenBSD?</h2>

It is possible to play audio CDs by either having the CD drive play
the disc and send analog audio to the sound card, or by reading the
audio data and sending the digital samples to the sound card over
the PCI bus.

<p>
To play an audio CD using the analog output of your CD-ROM drive, you can
<ul>
<li>Use the headphones output, usually at the front side of the drive.
<li>Connect the audio output at the back side to your audio card. Yes, this
is a supplementary cable next to the data (SCSI/IDE) and power cables.
</ul>

<p>
A nice command line utility called
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>,
has been included in the base system. Called without parameters, it will
enter interactive mode. If you want to play the CD right away, just enter

<blockquote><pre>
$ <strong>cdio play</strong>
</pre></blockquote>

<p>
This will play from the first CD-ROM drive, <tt>cd0</tt>, by default.
Note that the user running cdio should have permissions to read the CD-ROM
device (e.g. <tt>/dev/rcd0c</tt>).
As this device is only readable by root or the operator group by default,
for convenience you may want to add the user to the operator group by
adjusting this group's line in <tt>/etc/group</tt>.
Alternatively, you can modify the file permissions of the device as needed.

<p>
Note that you may need to unmute the CD input of the mixer.
Just like the outputs, the actual name of this input may vary between
systems, but you will be using a command like:

<blockquote><pre>
$ <strong>mixerctl inputs.cd.mute=off</strong>
</pre></blockquote>

It is also possible that there is no analog audio connection between
your CD drive and audio device.
In this case you could use <tt>cdio</tt>'s <tt>cdplay</tt> command
to send the CD audio data to the sound card through the PCI bus.

<blockquote><pre>
$ <strong>cdio cdplay</strong>
</pre></blockquote>

<p>
If you prefer a beautiful GUI, there are plenty of X11-based CD players in
the packages and ports collection.
Just have a look in the <tt>audio</tt> section.


<a name="recordaudio"></a>
<h2>13.4 - Can I use OpenBSD to record audio samples?</h2>

Yes.
Most devices support recording.

<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
comes with OpenBSD and can be used for recording.

<blockquote><pre>
$ <strong>aucat -o file.wav</strong>
</pre></blockquote>

The above command will start the recording of a file in WAV format.
Press [CTRL]-C to finish the recording.
The file will contain signed 16-bit stereo samples, sampled at 44.1 kHz.
Other sample formats, sample rates and number of channels can be recorded.
See the manual for more details.

<p>
Use aucat to play the file back:

<blockquote><pre>
$ <strong>aucat -i file.wav</strong>
</pre></blockquote>

<p>
If recording seemed to work, but playback of the recording was silent or
not what was expected, the mixer probably needs some configuration.
Make sure that you select the right device to record from and that the
source is unmuted.
You can set the necessary parameters using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>.
For example:

<blockquote><pre>
inputs.mic.mute=off
inputs.mic.preamp=on
inputs.mic.source=mic0
record.source=mic
record.volume=255,255
record.volume.mute=off
record.mic=255
record.mic.mute=off
</pre></blockquote>

These are settings for recording from a microphone.
Pre-amplifying has been enabled, otherwise the recorded sound can be pretty
silent on some systems.
However, pre-amplifying can also be quite loud on other systems.

<a name="audioserver"></a>
<h2>13.5 - How do I setup an audio server?</h2>

<!-- This section Copyright (c) 2009 Alexandre Ratchov -->

<h3>Do I need an audio server?</h3>

The <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
utility can be used as an audio server,
which acts as a layer between the audio(4) driver
and audio applications.
It aims to:

<ul>

<li>
Overcome incompatibilities between hardware and applications.
For instance the application may not support the encodings or sample rates
of the hardware; if so, the server can do the necessary conversions on the fly.

<li>
Allow multiple applications to use the hardware concurrently.
For instance, to use a background music player while running an application
playing sounds, or to
simultaneously use the front speakers for music and the headphone socket for
telephony is another example.

</ul>

If applications you use are compatible with your hardware and you don't
plan to run multiple applications concurently, then you don't need an audio
server.

<h3>How do I setup aucat(1)?</h3>

There's no configuration file and, in most cases, no tweaking is needed. Typing:

<pre>
$ <strong>aucat -l</strong>
</pre>

will start the server on the default audio device (the one the
<tt>/dev/audio</tt> symlink points to) running at 44.1kHz and
using two channels (stereo).
This means that applications using stereo at 44.1kHz will
run optimally, i.e. without triggering conversion code.
If the device doesn't support those parameters,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
will automatically pick another set of parameters.

<p>
If you start aucat as root, it will increase its priority,
to decrease the probability of buffer underruns or overruns.

It can be started at system boot by appending:

<pre>
<strong>aucat_flags=""</strong>
</pre>

to <tt>/etc/rc.conf.local</tt>.

<h3>What latency do I need?</h3>

The latency is the time between when a program takes the decision to play
a sample and when the user hears the sample.
Since audio data is always buffered, this delay is proportional to
the audio buffer size.
The following values are recommended:

<ul>

<li>
Real-time synthesizers: 5ms.
This is the time it takes between hitting a key on your MIDI keyboard
and actually hearing the note.
Roughly, 5ms corresponds to the time it takes for the sound to
propagate 1.75m.

<li>
Games: 50ms.
This is the time between when you see an event and you hear the
corresponding sound.

<li>
Movie players and alike: 500ms and more.
Such applications ``know'' the sound to play in advance, and send
audio data in such a way that it is played simultaneously with the
corresponding picture.

</ul>

The smaller audio buffers are (to achieve low latency), the larger
the probability to overrun/underrun is.
Buffer overruns/underruns result in ``stuttering'' of the sound.

<p>
In server mode, aucat(1) imposes a minimum latency on all audio applications,
and the default latency is around 250ms.

If you plan to use applications that require a lower latency, use the ``-b'' option
to select the desired latency (expressed in number of frames).

For instance, at 44100 samples/second, 50ms latency corresponds to:

<blockquote>
44100 samples/second x 0.050 seconds = 2205 samples
</blockquote>

then run
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
as follows:

<pre>
$ <strong>aucat -b 2205 -l</strong>
</pre>

<h3>Does low latency improve audio-video synchronization?</h3>

Synchronizing audio to video doesn't require low latency.
Synchronization problems are often caused by the software itself
(poor implementation, bugs,&nbsp;...).
Forcing the application to use smaller buffers (by starting aucat(1)
in low latency mode) may hide the actual problem in some cases and
give the feeling that the software works better, but obviously the
right thing to do is to start searching for the corresponding bug.


<a name="audioprob"></a>
<h2>13.6 - What can I do if I have audio problems?</h2>


<p>
If you do not hear anything when playing audio, it's possible there
is a mixer control turned to low or simply muted.
See section
<a href="#confaudio">13.1 - How do I configure my audio device</a>
for configuring the mixer.
Please unmute <b>all</b> inputs and outputs before reporting a problem.

<p>
If sound is distorted, it could be that your sound card only supports
a single or limited set of sample rates or encodings.
See section
<a href="#confaudio">13.1 - How do I configure my audio device</a>
for examples of determining what parameters your audio device supports.

<p>
If your device only supports unusual encodings or only one or a few
sample rates and applications you use do not perform the necessary
format conversions, consider using aucat(1) as audio server.
See section
<a href="#audioserver">13.5 - How do I setup an audio server?</a>

<p>
If you are still experiencing trouble, here are some things to consider:
<ul>
<li>
Some old ISA cards have particular quirks:
  <ul>
  <li>Some need to be configured with a different
  I/O address and IRQ value to avoid conflicts with other hardware.
  You can easily try different combinations using the
  <a href="faq5.html#BootConfig">User Kernel Configuration (UKC)</a>.
  <li>It is possible that a less than optimal driver attaches to the sound
  device, and that you can get better results using another driver.
  This is not the easiest thing to spot, but take a closer look at your
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
  output, and find the lines where audio drivers attach.
  If you see more than one sound driver attaching (or trying to), test
  them one at a time by disabling some and leaving one enabled using the
  <a href="faq5.html#BootConfig">User Kernel Configuration (UKC)</a>.
  </ul>
<li>
Find information about your sound device.
Use the documentation, or use an internet search engine to find its
specifications.
For
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ac97&amp;sektion=4">ac97(4)</a>
and
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=azalia&amp;sektion=4">azalia(4)</a>
devices, look for documentation for
both the controller and the codec.
They may actually help you find the source of the problem.
</ul>

<p>
If you believe your device should be working, but for whatever reason isn't,
then it's time for a little debugging.
The following steps can determine if data is being processed by the DAC.

<blockquote><pre>
$ <strong>cat > /dev/audio < /dev/zero &</strong>
[1] 9926
$ <strong>audioctl play.{seek,samples,errors}</strong>
play.seek=48000
play.samples=3312000
play.errors=0
$ <strong>audioctl play.{seek,samples,errors}</strong>
play.seek=57600
play.samples=7065600
play.errors=0
$ <strong>audioctl play.{seek,samples,errors}</strong>
play.seek=48000
play.samples=9379200
play.errors=0
$ <strong>kill %1</strong>
$ <strong>fg %1</strong>
cat > /dev/audio < /dev/zero
Terminated
</pre></blockquote>

Here we see that the processed data count <tt>play.samples</tt> increases
each time we check, so data is flowing.
We also see that the device is keeping enough data buffered
<tt>play.seek</tt>
that the device has not underrun any samples <tt>play.errors</tt>.
That's good too.

<p>
Note that even if you had speakers plugged in when running the above
test, you should not have heard anything.
The test sends zeros to the device, which is silence for all currently
supported default encodings.

<p>
Since we know the device can process data, it's a good idea to check
the mixer settings again.
Make sure all outputs and all inputs are unmuted and are at a reasonable
level.

<p>
If at this point you are still having problems, it's probably
time to
<a href="http://www.openbsd.org/report.html">file a bug report</a>.
Besides the normal bug report information such as a full dmesg and
description of the problem, please also include the default output
of <tt>mixerctl -v</tt> and the output of the above test for DAC
processing.


<a name="midi"></a>
<h2>13.7 - How do I use my MIDI instruments?</h2>

The Musical Instrument Digital Interface (MIDI) protocol provides a
standardized and efficient means to represent musical performance
information as electronic data.
A MIDI data contain only instructions needed by a synthesizer to play
the sounds, rather than the sounds.
More information:
<a href="http://www.harmony-central.com/MIDI/Doc/tutorial.html">Tutorial
on MIDI and Music Synthesis</a>.

<!-- <h3>Devices setup</h3> -->

<p>
To play MIDI data, a synthesizer connected to a MIDI port of the
machine is required. Similarly, to record a MIDI data a MIDI
instrument is required (eg. a MIDI keyboard).
Certain sound cards contain embedded MIDI synthesizers that are
attached as MIDI ports.
Advanced MIDI instruments may contain multiple subparts (synthesizers,
keyboards, control surfaces, etc...), they appear as multiple MIDI
ports on OpenBSD.

<p>
When you already have OpenBSD running, look for MIDI ports in the
output of the dmesg(8) command.
An example of MIDI ports in a dmesg
output is:

<blockquote><pre>
umidi0 at uhub2 port 2 configuration 1 interface 0 "Roland Roland XV-2020" rev 1.10/1.00 addr 2
midi0 at umidi0: &lt;USB MIDI I/F&gt;
umidi1 at uhub1 port 2 configuration 1 interface 1 "Evolution Electronics Ltd. USB Keystation 61es" rev 1.00/1.25 addr 3
midi1 at umidi1: &lt;USB MIDI I/F&gt;
</pre></blockquote>

It shows three MIDI ports, corresponding to:

<ul>
<li> <tt>/dev/rmidi0</tt> - synthesizer connected by USB
<li> <tt>/dev/rmidi1</tt> - a MIDI master keyboard
</ul>

These devices are known by
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sndio">sndio(7)</a>
as <tt>rmidi:0</tt> and <tt>rmidi:1</tt>.

To test your MIDI keyboard, you can use the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hexdump&amp;sektion=1">hexdump(1)</a>
utility to display MIDI data you're playing on it:

<blockquote><pre>
$ <strong>midicat -q rmidi:1 -o - | hexdump -e '1/1 "%02x\n"'</strong>
90
3c
71
...
</pre></blockquote>

The output of the keyboard can be connected to the input of the
synthesizer, as follows:

<blockquote><pre>
$ <strong>midicat -q rmidi:0 -q rmidi:1</strong>
</pre></blockquote>

Now you can hear on the synthesizer what you're playing on the MIDI
keyboard.
Refer to the 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midicat&amp;sektion=1">midicat(1)</a>
manual page for further information.

<!-- <h3>Playing, recording MIDI sequences</h3> -->

<p>
The main utility to play standard MIDI files is
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midiplay&amp;sektion=1">midiplay(1)</a>.
Playing a standard MIDI file, in this example through the synthesizer,
is as easy as:

<blockquote><pre>
$ <strong>midiplay -f rmidi:0 file.mid</strong>
</pre></blockquote>

<p>
To record MIDI files, you can use the <tt>smfrec</tt> utility bundled in
the <tt>audio/midish</tt> port, for instance:

<blockquote><pre>
$ <strong>smfrec -d rmidi:0 -i rmidi:1 file.mid</strong>
</pre></blockquote>

will record what is played on the keyboard (<tt>rmidi:1</tt>) while
sending it in real-time on the synthesizer (<tt>rmidi:0</tt>) so you
can hear what you're playing.
More complicated operations like editing, routing, mixing and
transforming MIDI data, can be achieved using the <tt>rmidish</tt>
utility bundled in the <tt>audio/midish</tt> port.

<a name="lossyaudio"></a>
<h2>13.8 - Tell me about Ogg Vorbis and MP3 encoding?</h2>

These formats were already mentioned in
<a href="#playaudio">Playing different kinds of audio</a>.
In this section we will give a brief introduction about encoding such files.
If you are interested in learning how these audio compression codecs work,
further reading may be found through these Wikipedia articles about
<a href="http://en.wikipedia.org/wiki/Vorbis">Vorbis</a> and
<a href="http://en.wikipedia.org/wiki/MP3">MP3</a>.

<h3>Ogg Vorbis</h3>

Encoding raw, WAV or AIFF format audio to
<a href="http://www.vorbis.com/">Ogg Vorbis</a> may be done with the
<b>oggenc</b> utility, contained in the <tt>audio/vorbis-tools</tt> package,
which is available through OpenBSD's packages and ports system.

<p>
Say you have a number of WAV files ready to encode, for example your
favorite album you just extracted from its CD.
To encode all these files using an approximate bit rate of 192 kbps, you
could issue a command like
<blockquote><pre>
$ <strong>oggenc *.wav -b 192</strong>
</pre></blockquote>

When finished, this will give you a set of .ogg files in the current directory.
More extensive examples, as well as encoding options, can be found in the
oggenc manual page.

<h3>MPEG-1 Audio Layer 3 (MP3)</h3>

If for some reason you want to use the MP3 format, you can use
<a href="http://lame.sourceforge.net/">"Lame ain't an MP3 encoder" (LAME)</a>,
an educational tool to be used for learning about MP3 encoding.
Lame is included in the OpenBSD ports tree.
Note that due to MP3 patents, you will not find this package on the
<a href="../orders.html">official CD sets</a>.

<p>
Below is a simple example of encoding a WAV file with a bit rate of 192 kbps:
<blockquote><pre>
$ <strong>lame -b 192 track01.wav track01.mp3</strong>
</pre></blockquote>

For all options and details, please consult the manual page that comes with
lame.


<a name="playDVD"></a>
<h2>13.9 - How can I playback video DVDs in OpenBSD?</h2>

OpenBSD supports DVD media through the ISO 9660 filesystem which
is also used on CD-ROMs, and, since OpenBSD 3.8, also through the newer
<a href="http://www.osta.org/specs/">Universal Disk Format (UDF)</a>
filesystem which is found on some DVDs.
However, almost all DVD-Video and DVD-ROM discs use the UDF bridge format,
which is a combination of the DVD MicroUDF (subset of UDF 1.02) and ISO 9660
filesystems.
It is used for backward compatibility reasons.

<p>
As most computers with DVD-ROM drives use software decoding, it is
recommended to have at least a 350-MHz Pentium II or equivalent CPU to have
good quality playback.

<p>
Some popular media players, supporting DVD playback, have been ported to
OpenBSD.
Examples are <a href="http://www.dtek.chalmers.se/groups/dvd/">ogle</a>,
<a href="http://www.mplayerhq.hu/">mplayer</a>,
<a href="http://www.xine-project.org/">xine</a>, and
<a href="http://kaffeine.sourceforge.net/">kaffeine</a>.
Please read the installation instructions that come with these packages,
because these tools may need further setup.
With these utilities, it is possible to playback the DVD by directly
accessing the raw device.
Of course, it is also possible to mount a DVD first using
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_cd9660&amp;sektion=8">mount_cd9660(8)</a>,
and play the files on this or any other mounted filesystem.

<p>
<b>Notes:</b>
<ul>
<li>Nearly all DVDs you buy are encrypted using the Content Scrambling
System (CSS).
To be able to playback these encrypted DVDs, you can use the
<b>libdvd</b> library, also available through packages and ports.
<li>Be aware that a region code may be present on your DVD disk(s).
This should not be much of a problem when playing DVDs on a computer.
</ul>


<a name="burnCD"></a>
<h2>13.10 - How do I burn CDs and DVDs?</h2>

<a name="burnIntro"></a>
<h3>13.10.1 - Introduction and basic setup</h3>

You should first make sure your CD/DVD writer has been recognized and
configured by the kernel.
Most SCSI devices are supported. IDE/ATAPI and USB devices are supported
through SCSI emulation. You will quickly find your device in a
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
output.
Just look for lines beginning with "cd", for example

<blockquote><pre>
cd0 at scsibus0 targ 0 lun 0: &lt;TOSHIBA, CD-ROM XM-5702B, 2826&gt; SCSI0 5/cdrom removable
cd1 at scsibus1 targ 4 lun 0: &lt;PLEXTOR, CD-R PX-R412C, 1.04&gt; SCSI2 5/cdrom removable
</pre></blockquote>

<h4>But <tt>cdrecord -scanbus</tt> does not work!</h4>

Yes. OpenBSD uses a different device namespace than the OS for which the
cdrecord utility was written.
All configured devices should be in the dmesg output, as mentioned above.
The information you need is right there.

<h4>Error: <tt>mount_cd9660: /dev/cd2c on /mnt/cdrom: No such file or directory</tt></h4>

By default, the OpenBSD installer creates only two cd device nodes,
<tt>cd0</tt> and <tt>cd1</tt>.
To start using your <tt>cd2</tt> device, you must create the necessary
device nodes for it.
The recommended way to do that is using the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8">MAKEDEV(8)</a>
(select your specific platform) script:

<blockquote><pre>
# <strong>cd /dev</strong>
# <strong>./MAKEDEV cd2</strong>
</pre></blockquote>

In what follows, we will mostly be accessing the CD/DVD writer through the
<i>raw</i> character device, <b>not</b> the <i>block</i> device.

<h4>Checking CD/DVD writer operation</h4>

It is recommended to check whether your CD/DVD writer is working correctly.
In this example, I'll be using this USB 2.0 DVD writer:

<blockquote><pre>
cd2 at scsibus2 targ 1 lun 0: &lt;LITE-ON, DVDRW LDW-851S, GS0C&gt; SCSI0 5/cdrom removable
</pre></blockquote>

Try to use it by mounting an existing CD/DVD in it.
If desired, you could also check the transfer rate you are getting when
copying files to your hard disk.
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=time&amp;sektion=1">time(1)</a>
command will be your willing assistant.

<p>
If something goes wrong here and you are getting errors during this phase,
it is wise to fix the problem and not to start writing a CD/DVD yet.

<h4>I want to write a CD here! Can we get on with it?</h4>

Before proceeding, it is a good idea to keep a few words of advice in mind:

<ul>
<li>Do not run any disk-intensive jobs while writing a CD/DVD. Doing this
will reduce the throughput to your CD/DVD writer. If the throughput drops
below what the writer is expecting for too long, its buffer will run empty.
This phenomenon is also known as a "buffer underrun".
<li>Prevent shocks during writing as this may cause the laser beam to drift
from its track, which may lead to errors on the disc.
<li>Not every DVD writer supports every DVD format, see below.
</ul>

<a name="writeCD"></a>
<h3>13.10.2 - Writing CDs</h3>

<h4>Creating data CD-ROMs</h4>

First, you will want to create an ISO 9660 filesystem to put on a CD-ROM.
To do this you can use the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkhybrid&amp;sektion=8">mkhybrid(8)</a>
utility in the base system, or the mkisofs utility which comes with the
cdrtools <a href="faq15.html#PkgMgmt">package</a> and which does a better
job with large file trees.
In the examples below, we will use mkhybrid, although mkisofs usage is
very similar.

<p>
As an example usage, let's say I wanted to store the OpenBSD kernel sources
in an ISO 9660 image:

<blockquote><pre>
$ <strong>mkhybrid -R -o sys.iso /usr/src/sys</strong>

Using ALTQ_RMC.000;1 for  /usr/src/sys/altq/altq_rmclass_debug.h (altq_rmclass.h)
...
Using IEEE8021.00H;1 for  /usr/src/sys/net80211/ieee80211_amrr.c (ieee80211.c)
 10.89% done, estimate finish Sat Nov  3 08:01:23 2007
 21.78% done, estimate finish Sat Nov  3 08:01:28 2007
...
 87.12% done, estimate finish Sat Nov  3 08:01:31 2007
 98.01% done, estimate finish Sat Nov  3 08:01:32 2007
Total translation table size: 0
Total rockridge attributes bytes: 896209
Total directory bytes: 2586624
Path table size(bytes): 11886
Max brk space used 0
45919 extents written (89 Mb)
</pre></blockquote>

<p>
The <tt>-R</tt> option tells <tt>mkhybrid</tt> to create Rock Ridge
extensions in the ISO 9660 image.
The Rock Ridge Interchange Protocol was created to support POSIX filesystem
semantics in ISO 9660 filesystems, such as longer file names, ownerships,
permissions, file links, soft links, device nodes, deep file hierarchies
(more than 8 levels of subdirectories), etc.

<p>
If you want the long file names on your CD-ROM to be readable on Windows
or DOS systems, you should add the <tt>-J</tt> flag to include Joliet
extensions in the ISO 9660 image as well.

<p>
After creating the filesystem, you can verify it by
<a href="faq14.html#MountImage">mounting the ISO 9660 image</a>.
If all is well, you are now ready to burn the CD-R(W).
The easiest way to do this is to use the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>
utility.

<p>
If you are using multi-write media such as CD-RW, you will need to blank the
media before burning it.

<blockquote><pre>
# <strong>cdio -f cd1c blank</strong>
</pre></blockquote>

You are now ready to burn the image created in the above
example to a blank CD-R(W). You could use a command similar to:

<blockquote><pre>
# <strong>cdio -f cd1c tao sys.iso</strong>
</pre></blockquote>

With the options specified above, we're asking cdio to use the second
CD-ROM device as the CD writer.

<p>
To verify whether the CD-ROM has been written correctly, you can mount it
and check whether everything is there.
To mount the filesystem, you should use the <i>block</i> device for the
CD-ROM drive, which in this case is still the CD writer:

<blockquote><pre>
# <strong>mount /dev/cd1c /mnt/cdrom</strong>
</pre></blockquote>


<h4>Creating audio CDs</h4>

To burn audio CDs, you can again use
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a> with the <tt>tao -a</tt> option.

<p>
As an example, I'll be making a backup copy of one of my music CDs.
This involves two steps:

<ol>
<li>Fetch the audio tracks from the original CD.
For example:
<blockquote><pre>
# <strong>cdio -f cd1c cdrip</strong>
</pre></blockquote>
This command will extract a series of WAV files from your second CD-ROM drive
to your disk.
<li>Write the audio tracks to a blank CD.
For example:
<blockquote><pre>
# <strong>cdio -f cd1c tao -a *.wav</strong>
</pre></blockquote>
</ol>


<a name="writeDVD"></a>
<h3>13.10.3 - Writing DVDs</h3>

There are a few important things about DVD you should know about before
proceeding to write your own DVDs.

<p>
<b>Important notes:</b>
<ul>
<li>If you really want to know all about DVD, I suggest you read the very
extensive <a href="http://www.dvddemystified.com/dvdfaq.html">DVD FAQ</a>
document to start with.
<li>This section has seen only very limited testing, and we certainly have
not tried every possible media and writer combination.
Nevertheless, we have had, or have heard of, positive experiences with
all of the DVD formats mentioned below.
You are welcome to <a href="mailto:faq@openbsd.org">let us know</a> about
your successes or failures.
</ul>

<h4>Different DVD formats</h4>

There are a number of different DVD formats. Commonly used are the DVD-R,
DVD-RW, DVD+R, and DVD+RW formats (R means writable once, RW means it can
be rewritten a few thousand times).
They are pretty much competing standards.

<p>
A pretty different format is DVD-RAM, which was mainly developed as a
data drive and has advanced packet writing functions, allowing it to be
used like a kind of optical hard disk. DVD-RAM is not recommended for
video usage as video gets written to the discs in a format not compatible
with normal DVD players.

<p>
The important thing is you use media which suit your DVD writer.
If you expect compatibility with other DVD players, watch your step and
be sure to read
<a href="http://www.dvddemystified.com/dvdfaq.html#4.3.1">this section</a>
of the DVD FAQ.

<h4>DVD writing speed</h4>

It may be useful to point out that DVD speed indications differ from CD-ROM
speed indications. The following table gives an overview:

<p>
<table border="1" style="empty-cells: show;">
<tr align="center">
<td>DVD read/write speed</td>
<td>Transfer rate (MB/s)</td>
<td>Equivalent CD-R(W) read/write speed</td>
</tr>
<tr align="center">
<td>1x</td>
<td>1.32</td>
<td>9x</td>
</tr>
<tr align="center">
<td>2x</td>
<td>2.64</td>
<td>18x</td>
</tr>
<tr align="center">
<td>4x</td>
<td>5.28</td>
<td>36x</td>
</tr>
<tr align="center">
<td>8x</td>
<td>10.57</td>
<td>72x</td>
</tr>
</table>

<p>
As can been seen from the table, the transfer rates are relatively high,
and you should check whether your bus (SCSI, (E)IDE/ATAPI, USB) is performant
enough to handle this throughput.
Especially the older USB 1.0 and 1.1 interfaces work at slower transfer
rates, with maximal rates of 1.5 Mbit/s and 12 Mbit/s, respectively.
That means USB 1.0 has a maximal throughput of 178.8 kByte/s and
USB 1.1 has a maximal throughput of 1.43 MB/s.
USB 2.0 is much faster: 480 Mbit/s or 57.2 MB/s.
In general, the speed of SCSI and (E)IDE/ATAPI buses should be just fine.

<h4>Writing the DVD</h4>

Basically, the process is very similar to writing CD-R(W)s. The software
used, however, is different.
At the moment, the best option is <b>growisofs</b> from the
<tt>sysutils/dvd+rw-tools</tt> package.
This utility writes an ISO 9660 image to the DVD medium.
All recordable DVD formats are supported by the dvd+rw-tools.

<p>
In case you want to find out more info about the media in your DVD writer
(for example if you lost the info label in the jewel case or are just
disorganized like me), you can use the <b>dvd+rw-mediainfo</b> utility.

<!--blockquote><pre>
$ <strong>dvd+rw-mediainfo /dev/rcd2c</strong>
INQUIRY:                [LITE-ON ][DVDRW LDW-851S  ][GS0C]
GET [CURRENT] CONFIGURATION:
 Mounted Media:         1Ah, DVD+RW
 Current Write Speed:   4.0x1385=5540KB/s
 Write Speed #0:        4.0x1385=5540KB/s
 Write Speed #1:        2.4x1385=3324KB/s
GET [CURRENT] PERFORMANCE:
 Write Performance:     4.0x1385=5540KB/s@[0 -> 0]
 Speed Descriptor#0:    00/0 R@2.4x1385=3324KB/s W@4.0x1385=5540KB/s
 Speed Descriptor#1:    00/0 R@2.4x1385=3324KB/s W@2.4x1385=3324KB/s
READ DVD STRUCTURE[#0h]:
 Media Book Type:       92h, DVD+RW book [revision 2]
 Media ID:              SONY/S11
 Legacy lead-out at:    2295104*2KB=4700372992
READ DISC INFORMATION:
 Disc status:           blank
 Number of Sessions:    1
 State of Last Session: empty
 Number of Tracks:      1
READ TRACK INFORMATION[#1]:
 Track State:           blank
 Track Start Address:   0*2KB
 Free Blocks:           2295104*2KB
 Track Size:            2295104*2KB
READ CAPACITY:          1*2048=2048
</pre></blockquote-->

There are two options to write the DVD:
<ul>
<li>Pre-master an ISO 9660 from your data, storing the image on your hard
disk; then write this image to the DVD.
<li>Write an ISO 9660 from your data immediately to the DVD.
</ul>

<p>
I created a pre-mastered ISO 9660 image from the OpenBSD CVS modules
(src, xenocara, ports and www) contained in the /cvs directory on my disk.
I used the following command, which looks very similar to the one I used
to create the CD-ROM image above.

<blockquote><pre>
$ <strong>mkhybrid -r -o cvs.iso /cvs</strong>
</pre></blockquote>

If desired, check the ISO 9660 filesystem by
<a href="faq14.html#MountImage">mounting the image</a>.
To write this image (about 2 GB) to an empty DVD disc, one could use:

<blockquote><pre>
# <strong>growisofs -dvd-compat -Z /dev/rcd2c=cvs.iso</strong>
Executing 'builtin_dd if=cvs.iso of=/dev/rcd2c obs=32k seek=0'
/dev/rcd2c: pre-formatting blank DVD+RW...
/dev/rcd2c: "Current Write Speed" is 4.1x1385KBps.
  23822336/1545832448 ( 1.5%) @3.9x, remaining 5:19
  42172416/1545832448 ( 2.7%) @3.9x, remaining 5:20
  60522496/1545832448 ( 3.9%) @3.9x, remaining 4:54
...
1504706560/1545832448 (97.3%) @3.9x, remaining 0:07
1523318784/1545832448 (98.5%) @3.9x, remaining 0:04
1541898240/1545832448 (99.7%) @3.9x, remaining 0:00
/dev/rcd2c: flushing cache
/dev/rcd2c: writing lead-out
/dev/rcd2c: reloading tray
</pre></blockquote>

The <tt>-Z</tt> option tells growisofs to burn an initial session to the
device, which in this case is my DVD writer, attached to cd2.
The <tt>-dvd-compat</tt> option closes the disk, which means no more sessions
can be appended to it.
This should provide better compatibility with video DVD players and some
older DVD-ROM units.

<p>Notice how growisofs indicates the writing speed, in this case 3.9x
DVD speed, which is what could be expected from the media and writer
combination, as indicated by dvd+rw-mediainfo.

<p>
If you are short on disk space and cannot store an ISO 9660 image for a
DVD, you can write your data directly to the DVD. Let's first do a dry
run, which simulates the creation of the filesystem.

<blockquote><pre>
# <strong>growisofs -dry-run -Z /dev/rcd2c -R /cvs</strong>
</pre></blockquote>

If this succeeds, just leave out the -dry-run option and start burning the
DVD.

<blockquote><pre>
# <strong>growisofs -Z /dev/rcd2c -R /cvs</strong>
</pre></blockquote>

<p>
It is also possible to append data to an existing DVD, by using the -M
option, which merges a new session to an existing one:

<blockquote><pre>
# <strong>growisofs -M /dev/rcd2c -R /mydata</strong>
</pre></blockquote>

For more information about growisofs, refer to the manual page.

<p>
When you have finished writing the DVD, mount it and see whether everything
you expected to be there, is indeed there.

<h4>Why am I not getting the writing speed I expected?</h4>

Instead of the above writing output, you may see something like:

<blockquote><pre>
   4784128/1545832448 ( 0.3%) @0.7x, remaining 26:50
   7929856/1545832448 ( 0.5%) @0.7x, remaining 29:05
  14123008/1545832448 ( 0.9%) @0.7x, remaining 27:06
...
</pre></blockquote>

which is much slower.
It means you are somehow not getting enough throughput on whatever bus
your DVD writer is using.
In the above example, the USB DVD writer was attached to a machine on which
the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ehci&amp;sektion=4">ehci(4)</a>
driver, used by USB 2.0 controllers, failed to initialize properly.
As always, you are welcome to provide patches and test results.
The DVD writer fell back to the slower USB 1.1 interface, which causes
reduced throughput.
Indeed, USB 1.1 is limited to 12 Mbit/s, which amounts to 1.43 MB/s or
1.08x in DVD speed terms.
The DVD writer falls back to a lower pace than the maximum, to reduce the
risk of buffer underruns.


<a name="convert"></a>
<h2>13.11 - But I want my media files in format FOO.</h2>

<h3>Converting between different audio formats</h3>

Let's say we want to process the sound recording from
<a href="#recordaudio">FAQ 13 - Audio Recording</a>.
This recording has been stored in the raw format.
It will be useful to convert it, because the raw format does not include
headers and the recording parameters will need to be specified at every
usage of the file.

<p>
One sound conversion tool is <tt>audio/sox</tt>, available through
packages and ports.
<b>sox</b> supports AIFF, AU, MP3, Ogg Vorbis, RIFF WAV and raw formats,
as well as some of the more exotic audio formats out there.
Below is an example for converting the recording to RIFF WAV format.

<blockquote><pre>
$ <strong>sox -U -c 1 -r 8000 -b myvoice.raw myvoice.wav</strong>
</pre></blockquote>

Note that the specified parameters correspond to the recording parameters
specified before the recording.
This was just an example. More audio-related libraries and software can
be used for audio conversion.

<p>
<b>Note:</b>
It is not recommended to convert between different lossy compression formats.
For instance, the MP3 and Vorbis codecs throw away different parts of an
original audio waveform.
Therefore, when converting a MP3 file to Ogg Vorbis, the end result will
probably sound worse than the original MP3.

<h3>Converting between different video formats</h3>

It's important to make a clear distinction between
<ul>
<li>the container file format - popular examples are
MP4, OGG, MPEG, MOV, AVI, ASF.
<li>the video codec - for example MPEG-1, MPEG-2, MPEG-4 compliant codecs
(like Xvid and DivX), FFmpeg, WMV, ... - read this
<a href="http://en.wikipedia.org/wiki/Video_codec">Wikipedia article
about video codecs</a> to find out more.
</ul>

In OpenBSD, support for MPEG and AVI containers is most mature at this
time.

<p>
Two popular utilities are <tt>multimedia/transcode</tt> and
<b>mencoder</b> (part of <tt>x11/mplayer</tt>).
They use or can use the <b>libavcodec</b> library as part of the
<tt>graphics/ffmpeg</tt> port, which generates good quality output.
You can, of course, also use <b>ffmpeg</b> directly.
It should also be possible to use the XviD encoder in
<tt>multimedia/xvidcore</tt>.

<p>
The documentation that comes with these packages, under the form of manual
pages or HTML documents in <tt>/usr/local/share/doc</tt>, contains many
examples, so it is HIGHLY recommended to read those documents.


<a name="streaming"></a>
<h2>13.12 - Is it possible to play streaming media under OpenBSD?</h2>

Yes, it is.
Many audio and video streams will work just fine, on a limited number of
platforms.
A few of them will not.

<p>
This is not meant to be a complete, overly detailed answer to have every
possible streaming format work on any hardware architecture.
You may want to learn more about streaming media to start with.
A slightly dated but still good starting point is this
<a href="http://www.oreilly.com/catalog/sound/chapter/ch05.html">chapter
about streaming media</a> from the O'Reilly book titled Designing Web Audio.

<p>
The first thing to understand is that there are a number of different
streaming protocols around.
The streaming <b>protocol</b> defines how the streams will be sent over the
network.
They have been developed to allow efficient transmission of audio/video
over the internet in real-time.
Mostly, the streaming protocol is a (Layer 7) application protocol, which
can use either UDP or TCP (Layer 4) transport protocols.
The User Datagram Protocol (UDP) is very suited for this type of
application since it doesn't do any retransmission of packets or other
overhead.
A number of specialized but proprietary protocols have been developed, e.g.
Microsoft Media Services (MMS) and the Real Time Streaming Protocol (RTSP).
As we will see, HTTP (which uses TCP) is sometimes used as well, even
though it does not allow serving streams at a steady bitrate like UDP,
RTSP and MMS.

<p>
Next, there is the streaming <b>format</b>, which is how the audio/video
data has been organized and can be played.
The most widely used streaming formats are MP3, Real Audio (RA, RM) and
Windows Media (ASF), all proprietary technologies.
Occasionally you will also encounter streams in the open Ogg Vorbis format.

<p>
As an example, I'll explain in a few steps how I get to listen to
<a href="http://www.radio1.be">Radio 1</a>,
one of the Belgian national radio stations.
Browser-embedded plugins are not available on OpenBSD, so the story is
usually not an instant "click and play".

<ul>
<li>Determine the streaming protocol and format.<br>
This is usually indicated on the website where you access the stream.
In this case, I followed the link "Listen live" from the main site, and
it's telling me my operating system is not supported.
They are being nice by saying I can also listen to their MP3 streams
without their embedded Flash player.
Apart from that, a list of links to the national radio stations appears,
allowing me to proceed to the next step.
Note that I used a JavaScript-enabled browser to get this far.
<li>Figure out the precise URL.<br>
Many websites link to a container metafile or playlist
(such as M3U, ASX, RAM), which contains the actual location of the stream.
Just save the file, and read the URL from it.
In my example this is

<blockquote><pre>
$ <strong>ftp http://internetradio.vrt.be/dab/hoeluisteren/pc/help/gebruiksvoorwaarden/stream_11.m3U</strong>
$ <strong>cat stream_11.m3U</strong>
http://mp3.streampower.be/radio1-mid.mp3
http://mp3.streampower.be/radio1-low.mp3
http://mp3.streampower.be/radio1-high.mp3
</pre></blockquote>

It looks like I can even choose between low, medium and high quality streams.
Other websites may contain some JavaScript code to generate the URL.
In that case, the best tip is: dig up the HTML source and scripts it
refers to.
There is a good chance you can reconstruct the URL from it.

<li>To play streams, your best bet is probably <tt>x11/mplayer</tt>,
which is available through packages and ports.
It supports most of the streaming protocols and formats, and has been
reported to work on amd64, i386, powerpc and sparc64 platforms.
But there are alternatives:
<b>ogg123</b> from <tt>audio/vorbis-tools</tt> (for Ogg Vorbis streams),
<tt>audio/mpg123</tt> and <tt>audio/mpg321</tt> (for MP3 streams),
XMMS in <tt>audio/xmms</tt> and the Videolan Client in <tt>x11/vlc</tt>.
Continuing the example:

<blockquote><pre>
$ <strong>mplayer http://mp3.streampower.be/radio1-mid.mp3</strong>
</pre></blockquote>

<li>Optionally, you may want to make it a little easier by including an
alias in your <tt>.profile</tt>:

<blockquote><pre>
alias radio1='mplayer http://mp3.streampower.be/radio1-mid.mp3'
</pre></blockquote>

</ul>

<!--  
check out http://www.cbc.ca/listen/index.html
it has DivX streams over MMS as well as Ogg Vorbis streams over HTTP.
maybe a good example but also nearly an ideal case...
-->

Windows Media (ASF) streams will often work, though they may contain data
in formats supported only through the <tt>graphics/win32-codecs</tt> port,
which runs on i386 only ('pkg_info win32-codecs' will tell you which
codecs).
Some Real Audio streams can be made to work on i386 using <b>mplayer</b>
in conjunction with the
<tt>graphics/win32-codecs</tt> and <tt>emulators/fedora/base</tt> ports
(see
<a href="http://marc.info/?t=107060510300001&amp;r=1&amp;w=2">this
thread</a> on the ports mailing list).

<a name="javaflash"></a>
<a name="javaplugin"></a>
<h2>13.13 - Can I have Java support in my web browser? (i386 &amp;
amd64 only)</h2>

The Java plugin is part of the Java Development Toolkit (JDK).
For licensing reasons, OpenBSD cannot ship binary packages for the JDK.
This means you will have to build it from ports.
Further information on building the JDK can be found in
<a href="faq8.html#Programming">FAQ 8 - Programming Languages</a>.
Once you have finished building the JDK, you can install either the full
JDK package or just the Java Runtime Environment (JRE) which is in a
subpackage and contains the browser plugin.

<p>
Upon installation, instructions are displayed for using the Java plugin
with the Firefox or Seamonkey web browser.
Create the symlink as explained, and then you should see the Java plugin
upon entering "about:plugins" in the URL bar.

<p>
For KDE's Konqueror web browser, either the java binary must be in your PATH,
or its absolute path can be configured from the menu
Settings -&gt; Configure Konqueror -&gt; Java &amp; JavaScript.
By default, the java binary is located in
<tt>/usr/local/jre-<i>version</i>/bin/</tt> or
<tt>/usr/local/jdk-<i>version</i>/bin/</tt>, depending on whether
you installed the JRE or the JDK.

<p>
<b>Note:</b> Java support has only been tested with the Firefox,
Seamonkey, and Konqueror web browsers.
If it works well for you using a different browser, please let us know.


<a name="flashplugin"></a>
<h2>13.14 - Can I have Flash support in my web browser? (i386 only)</h2>

The Flash plugin is distributed by Adobe in binary form only.
Adobe does not provide a native OpenBSD plugin, but there is a Linux
plugin which you can use under Linux emulation.
This plugin is available only for the i386 platform.

<p>
Before continuing, it is a good idea to read about Linux emulation in the
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=compat_linux&amp;sektion=8">compat_linux(8)</a>
manual page, and also
<a href="faq9.html#Interact">FAQ 9 - Running Linux binaries on OpenBSD</a>.

<p>
If you have understood this and you didn't install the necessary files yet,
just add the fedora package.
Assuming you have the environment variable <tt>PKG_PATH</tt> set
(see <a href="faq15.html#Easy">FAQ 15</a>),

<blockquote><pre>
# <b>pkg_add -i fedora_base</b>
</pre></blockquote>

This will automatically set <tt>kern.emul.linux=1</tt>, but not permanently.
If you need permanent Linux emulation, you need to specify that in
<tt>/etc/sysctl.conf</tt>, as explained in
<a href="faq9.html#Interact">FAQ 9 - Running Linux binaries on OpenBSD</a>.

<p>
Another thing you should know is that Linux shared libraries and modules
cannot be used with OpenBSD executables, so you will need a Linux browser
as well.

<p>
One candidate is the <a href="http://www.opera.com/">Opera</a> web browser,
available in the ports tree.
OpenBSD does not distribute packages for it, since Opera's license is not
clear about its redistribution.
However, installation should not take long, since it is distributed in
binary form by Opera Software.
After that you can easily install the Flash plugin from the ports tree.

<blockquote><pre>
# <b>cd /usr/ports/www/opera</b>
# <b>make install</b>
# <b>cd /usr/ports/www/opera-flashplugin</b>
# <b>make install</b>
</pre></blockquote>

<p>
<b>Note:</b>
It should be sufficient to perform the last step alone, and the ports
system will install the dependencies automatically.
For clarity, however, we split the process into a few steps here to
explain.

<p>
If you have followed the above guidelines, the Flash plugin should now be
listed when you type "about:plugins" in the URL bar.


<!--
this would be interesting, but lack of hardware at the moment

<a name="camera"></a>
<h2>13.xx - Can I use my digital camera under OpenBSD?</h2>

<a name="scanner"></a>
<h2>13.yy - How do I set up and use my scanner?</h2>
-->

<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq12.html">[To Section 12 - Hardware and Platform-Specific Questions]</a>
<a href= "faq14.html">[To Section 14 - Disk Setup]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: faq13.html,v 1.137 2010/11/06 20:11:30 ratchov Exp $</small>

</body>
</html>

