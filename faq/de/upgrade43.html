<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD-Upgradeanleitung 4.3</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="OpenBSD Upgrade Process for 4.2 -> 4.3">
<meta name="keywords"      content="openbsd,faq,upgrade,4.3">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2008 by OpenBSD">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="../../de/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |<br>
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade44.html">[4.3 -> 4.4]</a> |
<a href="index.html">[FAQ-Index]</a>
</font>

<h1><font color="#e00000">
Upgradeanleitung: 4.2 auf 4.3
</font></h1>
<hr>

<i>Hinweis: Upgrades werden nur von einem Release zum direkt darauf
folgenden Release unterstützt.
Überspringe keine Releases.</i>

<p><i>
Es wird dringend dazu geraten, diesen Prozess zu lesen und voll und
ganz zu verstehen, bevor du ihn durchführst.
Wenn du das hier beschriebene auf einer wichtigen oder physikalisch
entfernten Maschine machst, solltest du diesen Prozess erst auf einer
identischen lokalen Maschinen versuchen, um sicherzustellen, dass alles
funktioniert, bevor du dich an die wichtige oder entfernte Maschine
wagst.
</i>

<p>
Upgrading ist ein bequemer Weg, um dein OpenBSD-System auf die
aktuellste Version zu bringen.
Jedoch sind die Ergebnisse nicht beabsichtigt, genau so zu sein wie
eine Installation, bei der alles gelöscht und wieder aufgespielt wird.
Insbesondere alte Bibliotheksdateien werden beim Upgradeprozess nicht
deinstalliert, da sie von alten Applikationen, die vielleicht später
noch aktualisiert werden, noch benötigt werden könnten. Wenn du WIRKLICH
all diese alten Dateien loswerden möchtest, wärst du mit einer völligen
Neuinstallation vermutlich besser dran.

<p>
Inhaltsverzeichnis:
<ul>
<li><a href="#before">Vor dem Upgrade</a>
  <ul>
  <li><a href="#libexpat">libexpat wurde in base43.tgz verschoben</a>
  <li><a href="#httpd.conf">httpd.conf-Änderung</a>
  <li><a href="#relayd">hoststated(8) in relayd(8) umbenannt</a>
  <li><a href="#carp">carp(4)-Änderungen</a>
  <li><a href="#xenocaramove">Standardposition des xenocara-Trees
  verschoben</a>
  <li><a href="#rc.conf">rc.conf</a>
  <li><a href="#kern">Angepasster Kernel</a>
  </ul>
<li><a href="#upgrade">Der Upgradeprozess</a>
<li><a href="#final">Letzte Schritte</a>
  <ul>
  <li><a href="#UsersGroups">Neue sowie geänderte Benutzer und
  Gruppen</a>
  <li><a href="#etcUpgrade"><tt>/etc</tt> upgraden</a>
  <li><a href="#Kernchk">Kernel überprüfen</a>
  <li><a href="#Pkgup">Packages upgraden</a>
  <li><a href="#rmxbase42">xbase42.tgz entfernen</a>
  </ul>
</ul>

<hr>
<p>
<a name="before"></a>
<h2>Vor dem Upgrade: Was zu beachten und berücksichtigt werden sollte</h2>
Dies ist <i>keine</i> vollständige Liste aller Änderungen, die zwischen
4.2 und 4.3 stattgefunden haben; stattdessen werden nur die
wichtigsten Dinge angesprochen, die eine Großzahl Benutzer während eines
Upgradeprozesses betreffen werden. Für eine vollständige Liste sieh
<a href="../../plus43.html">plus43.html</a> und die CVS-Changelogs.

<a name="libexpat"></a>
<ul>
<li><b>libexpat wurde in base43.tgz verschoben</b><br>
In 4.2 wurde libexpat von ports in xbase42.tgz verschoben, was sich
aber sehr ungünstig auf Personen ausgewirkt hat, die ansonsten keinen
Grund hatten, X zu installieren. In 4.3 wurde libexpat von xbase42.tgz
in base43.tgz verschoben, sodass für viele Anwendungen kein
installiertes xbase43.tgz mehr Voraussetzung ist.

<p>
Dies kann aber ein kleines Problem hervorrufen, wenn du xbase42.tgz
installiert hast, um libexpat auf deinem 4.2-System nutzen zu können.
Da du xbase42.tgz installiert hast, solltest du es entweder entfernen
oder upgraden. Wenn libexpat der einzige Grund war, warum du xbase42.tgz
installiert hast, ist es vermutlich die beste Lösung, die alten Dateien
zu löschen. Details über die Entfernung von xbase42.tgz werden
<a href="#rmxbase42">bereitgestellt</a>.


<p>
Beachte ebenfalls, dass die Übersetzung von Ports noch immer nur mit
einer vollständigen Installation unterstützt wird; darunter fallen auch
<i>alle</i> X-Dateisets.

<p>
<a name="httpd.conf"></a>
<li><b>httpd.conf-Änderung:</b><br>
<a href="faq15.html">Packages</a> für <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8"
>httpd(8)</a>-Module installieren ihre Konfigurationsdateien nun unter
<tt>/var/www/conf/modules.samples</tt> und teilen dem Benutzer mit,
symbolische Links in <tt>/var/www/conf/modules</tt> anzulegen.
Die folgende Zeile sollte in <tt>/var/www/conf/httpd.conf</tt>
nach der <tt>LoadModule</tt>-Direktive hinzufügt werden (ungefähr am
Ende der Sektion 1):

<blockquote><pre>
#
# Include extra module configuration files
#
Include /var/www/conf/modules/*.conf
</pre></blockquote>

Dies ist in der <tt>upgrade43.patch</tt>-Datei enthalten; es kann
aber passieren, dass die Änderung nicht auf stark angepasste
<tt>httpd.conf</tt>-Dateien vorgenommen werden kann. Du solltest
sicherstellen, dass diese Zeilen in dein System übernommen wurden, da
ansonsten zukünftige Packageinstallationen nach der Installation nicht
richtig funktionieren könnten.

<p>
<a name="relayd"></a>
<li><b>hoststated(8) wurde in relayd(8) umbenannt:</b><br>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hoststated&amp;manpath=OpenBSD+4.2&amp;sektion=8"
>hoststated(8)</a> wurde in <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=relayd&amp;sektion=8"
>relayd(8)</a> umbenannt. Hierfür müssen der Benutzer und die Gruppe
<tt>_hoststated</tt> in <tt>_relayd</tt> umbenannt werden; dazu kommen
Änderungen an deiner <tt>/etc/pf.conf</tt>-Datei und kleine Abänderungen
deiner <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=hoststated.conf&amp;manpath=OpenBSD+4.2&amp;sektion=5"
>hoststated.conf(5)</a>-Datei
in eine <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=relayd.conf&amp;sektion=5"
>relayd.conf(5)</a>-Datei. Die Upgradeanleitungen hier werden eine
neue <tt>relayd.conf</tt>-Datei anlegen, die du an deine Bedürfnisse
anpassen musst.

<p>
<a name="carp"></a>
<li><b>carp(4)-Änderungen:</b><br>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4"
>carp(4)</a> wurde geändert, um eine einfachere Konfiguration zu
ermöglichen. Wenn du carp mit ARP- oder IP-<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=carp&amp;sektion=4#LOAD+BALANCING"
>Balancing</a> betreibst, musst du deine Konfiguration entsprechend
anpassen:
  <ul>
  <li>Mehrere carp(4)-Interfaces, die eine IP teilen, wurden mit der
  <tt>carpnodes</tt>-Option ersetzt.

  <li>Die <tt>net.inet.carp.arpbalance</tt>-<a
  href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysctl&amp;sektion=8"
  >sysctl(8)</a> wurde mit dem Balancingmodus <tt>arp</tt> ersetzt.

  <li>Die Flags <tt>link0, link1</tt> und <tt>link2</tt> für
  IP-Balancing wurden mit den Balancingmodi <tt>ip, ip-stealth</tt> und
  <tt>ip-unicast</tt> ersetzt.

  </ul>

<p>
<a name="xenocaramove"></a>
<li><b>Standardposition des xenocara-Trees verschoben:</b><br>
Die Standardposition des xenocara- (<a href="faq11.html">X</a>)
Sourcetrees ist nun <tt>/usr/xenocara</tt>. Dies ist wichtig für alle,
die <a href="faq5.html#Xbld">X vom Quelltext aus übersetzen</a>.
Verschiebe einfach deinen xenocara-Tree:
<blockquote><pre>
# <b>mv /usr/src/xenocara /usr</b>
</pre></blockquote>

<p>
<a name="rc.conf"></a>
<li><b>rc.conf:</b><br>
Im Gegensatz zu früheren Upgradeanleitungen wird seit <a
href="upgrade41.html">4.1</a> davon ausgegangen, dass
<tt>/etc/rc.conf</tt> nicht vom Benutzer geändert wurde. Falls du
Änderungen an deiner <tt>/etc/rc.conf</tt>-Datei vorgenommen hast,
übernehme sie bitte in <tt>/etc/rc.conf.local</tt>. Falls du KEINE
<tt>/etc/rc.conf.local</tt>-Datei besitzt, kopiere einfach die Datei
<tt>/etc/rc.conf</tt> mit dem neuen Namen <tt>/etc/rc.conf.local</tt>
und <i>entferne die letzte Zeile des Skripts!</i>. Die andere
Möglichkeit besteht darin, den Inhalt deiner <tt>rc.conf</tt> zum
Anfang der bereits bestehenden <tt>rc.conf.local</tt> hinzuzufügen
<i>und die letzte Zeile zu entfernen</i>, bevor du mit den nächsten
Schritten weiter machst.

<p>
<a name="kern"></a>
<li><b>Angepasster Kernel:</b><br>
Überprüfe, ob du irgendwelche Modifikationen an deinem Kernel
vorgenommen hast. Zum Beispiel könntest du dein Netzwerkdevice
mittels config(8) geändert haben, um eine nicht standardmäßige
Einstellung verwenden zu können. Schreib die Änderungen auf, sodass du
sie ebenfalls auf den neuen 4.3-Kernel anwenden kannst.

</ul>

<p>
<hr>
<a name="upgrade"></a>
<h2>Der Upgradeprozess</h2>

<h3>Mit Installationskernel upgraden</h3>
Wenn du Zugriff auf die Systemkonsole hast, dann besteht der einfachste
und sicherste Weg zu upgraden darin, mit Installationsmedien oder
<a href="faq4.html#bsd.rd">bsd.rd</a> zu booten und den Upgradeschritten
zu folgen, die dem <a href="faq4.html">Installationsprozess</a> sehr
ähneln. Schließe danach das Upgrade ab, in dem du die <a href="#final"
>letzten Schritte</a> wie weiter unten angegeben durchführst.

<p>
Den Installationskernel kannst du recht einfach booten, indem du die
4.3-Version von <i>bsd.rd</i> im Wurzelverzeichnis deines Bootlaufwerks
ablegst und dem Bootloader mitteilst, dass er mit der neuen
<i>bsd.rd</i>-Datei booten soll. Auf amd64 und i386 machst du das, indem
du »<tt>boot bsd.rd</tt>« am ersten <tt>boot&gt;</tt>-Prompt angibst.

<h3>Ohne Installationskernel upgraden</h3>
<i>Diese Vorgehensweise wird NICHT empfohlen. Verwende die
Installationskernel-Methode, wenn es irgendwie möglich ist!</i>

<p>
Manchmal muss man ein Upgrade einer Maschine durchführen, wenn man
nicht auf einfache Weise den normalen Upgradeprozess durchführen kann.
Der häufigste Grund hierfür ist, dass sich die Maschine an einem anderen
Ort befindet und man daher keinen Zugriff auf die Systemkonsole hat.
Man kann dies normalerweise durchführen, indem man vorsichtig diesen
Prozess befolgt:

<ul>
<li><b>Lege die Installationsdateien in einem »guten« Verzeichnis
ab</b>. Stelle sicher, dass du genügend freien Platz hast!

<p>
<li><b>Deaktiviere das Starten aller »unsicheren« Applikationen beim
Booten:</b>
Es wird Momente während der Installation geben, in denen zwar PF nicht
geladen werden kann, deine Applikationen aber eventuell normal gestartet
und ausgeführt werden. Jede Applikation, deren Sicherheit von PF
abhängig ist, sollte daher zuvor deaktiviert werden; sie sollte auch
erst erneut aktiviert werden, wenn die Funktionsweise von PF nach dem
Upgrade sichergestellt worden ist.
Es mag weitere Applikationen geben, die du während dem Upgradeprozess
nicht ausführen möchtest - beende und deaktiviere sie ebenfalls.

<p>
<li><b>Überprüfe den Kernel:</b>
Obwohl <b>die meisten Leute diesen Schritt überspringen können</b>,
kann es sein, dass du den 4.2-Kernel angepasst hast. Wenn das der Fall
ist, dann wirst du sehr wahrscheinlich das gleiche mit dem 4.3-Kernel
machen müssen. Insbesondere wenn du ein Upgrade mit einem Remotesystem
durchführst, ist jetzt der richtige Zeitpunkt gekommen, um
sicherzustellen, dass der neue Kernel geladen werden kann, wenn du das
System neustartest. Falls irgendwelche Änderungen am Kernel gemacht
werden müssen, ist es am sichersten, das ganze auf einem lokalen
4.3-System zu machen. Dabei kann es sich um so einfache Dinge wie
eine Änderung eines bestimmtes Devices mittels config(8) handeln, doch
könnte es genauso gut bedeuten, dass du den Kernel neuerzeugen musst,
da sich eine von dir benötigte Option nicht im GENERIC-Kernel befindet.
Lies bitte <a href="faq5.html">FAQ 5 - Das System aus dem Quelltext
erzeugen</a>, bevor du in Erwägung ziehst, deinen Kernel neu zu
erzeugen.

<p>
<li><b>Installiere neue(n) Kernel</b>
<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>   <i># wo du die Dateien ablegst</i>
<b>cd ${RELEASEPATH}</b>
<b>rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd</b>
<b>cp bsd.rd bsd.mp /</b>
</pre></blockquote>

Achte auf die zusätzlichen Schritte, um den primären Kernel zu
kopieren: Diese werden durchgeführt, um zu gewährleisten, dass immer
eine funktionsfähige Kopie des Kernels auf der Platte ist, sodass das
System booten kann, falls ein Stromausfall oder ein Systemabsturz zu
sehr ungünstiger Zeit eintreten.

<p>
<li><b>Installiere neue <tt>/etc/firmware</tt>-Dateien:</b>
Einige hochgeladene »firmware«-Blobs wurden eventuell aktualisiert.
Falls du davon betroffen bist, musst du Dateien in deinem
<tt>/etc/firmware</tt>-Verzeichnis aktualisieren. Dies betrifft jedoch
nur Benutzer von ein paar Geräten - andere Benutzer können diesen
Schritt ohne weiterer Beeinträchtigung ausführen können.
Um die Firmwaredateien aus <tt>base43.tgz</tt> zu entpacken, verwende
das Folgende als root vor dem nächsten Schritt:

<blockquote><pre>
<b>cd /</b>
<b>tar -C / -xzphf ${RELEASEPATH}/base43.tgz ./etc/firmware</b>
</pre></blockquote>

<p>
<li><b>Installiere das neue <tt>/sbin/ifconfig</tt>-Werkzeug:</b>
Ab und zu benötigen die Netzwerktreiber (insbesondere für die
komplexeren Devices wie <tt>pppoe(4)</tt>) im neuen Kernel ein
aktualisiertes <tt>ifconfig</tt>-Werkzeug, um nach dem Neustart
im nächsten Schritt richtig konfiguriert werden zu können. Es gilt
erneut, dass dieser Schritt von allen Nutzern gefahrlos durchgeführt
werden kann, aber wenn du ein Remoteupgrade über eine
<tt>pppoe(4)</tt>-Verbindung durchführst, kann dieser Schritt äußerst
wichtig sein. Um das <tt>ifconfig</tt>-Werkzeug aus <tt>base43.tgz</tt>
zu extrahieren, führe Folgendes als root aus:

<blockquote><pre>
<b>tar -C / -xzphf ${RELEASEPATH}/base43.tgz ./sbin/ifconfig</b>
</pre></blockquote>

<p>
<li><b>Starte mit dem neuen Kernel neu:</b>
Es mag verführerisch sein, diesen Schritt zu überspringen, aber er
sollte nun durchgeführt werden, da - wie üblich - der neue Kernel die
alten Userlandapplikationen ausführen wird (wie zum Beispiel den
bald wichtigen <tt>reboot</tt>!), ein neues Userland aber häufig
NICHT mit einem alten Kernel zusammen funktioniert.

<p>
<li><b>Installiere neue Userlandapplikationen</b>
<i>Installiere noch NICHT <tt>etc43.tgz</tt> und
<tt>xetc43.tgz</tt>, da sie deine aktuellen Konfigurationsdateien
überschreiben würden!</i>

<blockquote><pre>
<b>export RELEASEPATH=</b><i>/usr/rel</i>
<b>cd ${RELEASEPATH}</b>
<b>tar -C / -xzphf base43.tgz</b>
<b>tar -C / -xzphf comp43.tgz</b>
<b>tar -C / -xzphf game43.tgz</b>
<b>tar -C / -xzphf man43.tgz</b>
<b>tar -C / -xzphf misc43.tgz</b>
<b>tar -C / -xzphf xbase43.tgz</b>
<b>tar -C / -xzphf xfont43.tgz</b>
<b>tar -C / -xzphf xserv43.tgz</b>
<b>tar -C / -xzphf xshare43.tgz</b>
</pre></blockquote>

Hinweis: Nicht alle Dateisets müssen für alle Einsatzgebiete
installiert werden, wenn du jedoch ein Dateiset ursprünglich installiert
hast, solltest du es jetzt doch mit einem neuen Dateiset upgraden.

<p>
Hinweis: Die Dateien in <tt>/etc</tt> werden weiter unten getrennt
behandelt, sodass <tt>etc43.tgz</tt> und <tt>xetc43.tgz</tt>
an dieser Stelle NICHT entpackt werden.

<p>
<li><b>Upgrade <tt>/dev</tt>.</b>
Die neue
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>-Datei
wird durch die Installation von <tt>base43.tgz</tt> nach /dev kopiert,
sodass du einfach nur Folgendes machen musst:
<blockquote><pre>
<b>cd /dev</b>
<b>./MAKEDEV all</b>
</pre></blockquote>

<p>
<li><b>Upgrade <tt>/etc</tt> wie unten beschrieben</b>.

<p>
<li><b>Starte neu</b>
</ul>

Während des Prozesses könnte
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">sendmail(8)</a>
viele Fehlermeldungen wie diese erzeugen:
<pre>
    Nov 1 12:47:05 puffy sm-mta[16733]: filesys_update failed: No such file or dire
    ctory, fs=., avail=-1, blocksize=380204
</pre>
Diese Nachrichten können an dieser Stelle unbesorgt ignoriert werden,
du könntest aber auch sendmail(8) während dem Upgradeprozess beenden.
Zu diesem Zeitpunkt arbeitet sendmail noch nicht richtig und muss
(als Teil des Reboots) neugestartet werden, bevor man erwarten kann,
dass er E-Mails richtig verarbeitet.

<p>

<hr>
<a name="final"></a>
<h2>Letzte Schritte</h2>

Falls du nun unter Verwendung eines Installationskernels (und dadurch
einen formalen Upgradeprozesses) oder aber ein Binärupdate im laufenden
System, gibt es einige Schritte, die manuell durchgeführt
werden müssen.

<a name="UsersGroups"></a>
<h3>1. Neue sowie geänderte Benutzer und Gruppen</h3>
Neue Benutzer werden für
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ospfd&amp;sektion=8"
>ospf6d</a> und <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=snmpd&amp;sektion=8"
>snmpd</a> benötigt. Lege diese Benutzer und Gruppen mit <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8"
>useradd(8)</a> an:
<blockquote><pre>
<b>useradd -u90 -g=uid -c"OSPF6 Daemon" -d/var/empty -s/sbin/nologin _ospf6d
useradd -u91 -g=uid -c"SNMP Daemon" -d/var/empty -s/sbin/nologin _snmpd</b>
</pre></blockquote>

Du musst ebenfalls <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8"
>vipw(8)</a> verwenden, um die Passwortdateien sowie mit deinem
bevorzugtem Editor die Datei <tt>/etc/group</tt> zu ändern: Ändere in
beiden <tt>_hoststated</tt> in <tt>_relayd</tt> und die Beschreibung
in vipw(8) von »HostState Daemon« in »Relay Daemon«. Belasse den Rest
der Zeile so wie er ist.

<a name="etcUpgrade"></a>
<h3>2. <tt>/etc</tt> upgraden</h3>
<p>
Du solltest die <tt>etc43.tgz</tt>-Dateien in ein temporäres
Verzeichnis entpacken:
<blockquote><pre>
<b>tar -C /tmp -xzphf ${RELEASEPATH}/etc43.tgz</b>
</pre></blockquote>


Dateien, die ordnungsgemäß von <tt>etc43.tgz</tt> »so wie sie sind«
kopiert werden können:

<blockquote><pre>
etc/mail/README
etc/moduli
etc/mtree/4.4BSD.dist
etc/mtree/BSD.local.dist
etc/mtree/special
etc/netstart
etc/ospf6d.conf
etc/rc
etc/rc.conf
etc/relayd.conf
etc/security
etc/snmpd.conf
var/named/etc/root.hint
</pre></blockquote>

Bedenke, dass es möglich IST, all diese Dateien lokal zu modifizieren.
Solltest du sie also modifiziert haben, musst du sie manuell anpassen.
Achte besonders auf <tt>mail/*</tt>, wenn du eine angepasste
Sendmail(8)-Konfiguration verwendest. Hier sind Copy&amp;Paste-Zeilen,
um diese Dateien zu kopieren, angenommen, dass du <tt>etc43.tgz</tt>
in dem zuvor empfohlenen Verzeichnis abgelegt hast:

<blockquote><pre>
<b>cd /tmp/etc
cp moduli netstart ospf6d.conf rc rc.conf relayd.conf security snmpd.conf /etc
cp mtree/* /etc/mtree/
cp mail/README /etc/mail
cp ../var/named/etc/root.hint /var/named/etc</b>
</pre></blockquote>

<p>
<a name="patchfile"></a>
Diese Dateien werden sehr wahrscheinlich lokale Änderungen haben,
sollten aber dennoch für 4.3 aktualisiert werden. Wenn du diese Dateien
nicht geändert hast, kopiere einfach die neue Version, ansonsten musst
du die Änderungen in deine Dateien übernehmen:

<blockquote><pre>
etc/changelist
etc/chio.conf
etc/ftpusers
etc/mail/aliases
etc/ssh/sshd_config
etc/sudoers
etc/sysctl.conf
var/named/etc/named-dual.conf
var/named/etc/named-simple.conf
var/named/etc/named.conf
var/www/conf/httpd.conf
var/www/conf/mime.types
var/www/htdocs/manual/mod/core.html
var/www/htdocs/manual/server-wide.html
</pre></blockquote>

Die Änderungen dieser Dateien befinden sich in
<a href="../upgrade43.patch">dieser Patchdatei</a>. Du kannst
versuchen, sie zu verwenden, indem du das Folgende als root ausführst:
<blockquote><pre>
<b>cd /</b>
<b>patch -C -p0 &lt; upgrade43.patch</b>
</pre></blockquote>

Hiermit wird geprüft, wie gut der Patch sich in DEIN System einbinden
lässt. Um ihn tatsächlich einzubinden, lass die Option <tt>-C</tt> weg.
Beachte, dass es sehr wahrscheinlich ist, dass wenn du diese Dateien
modifiziert, nicht immer auf dem aktuellsten Stand gehalten hast oder
von einem Snapshot von 4.2 aus upgradest, dieser Patch nicht richtig
angewandt werden kann.
In diesen Fällen musst du die Änderungen manuell vornehmen.
Teste diesen Prozess bitte, bevor du dich darauf verlässt, dass alles
funktioniert, wenn du ihn an einem schwer zu erreichenden System
anwendest.

<p>
<b><tt>/etc/ttys</tt></b> sind nun zwar einheitlicher zwischen den
Plattformen, macht aber eine Aktualisierung dieser Datei etwas
kniffliger. Es wird empfohlen, dass du diese neue Datei einfach
übernimmst und manuell alle Änderungen in die neue integrierst:
<blockquote><pre>
<b>mv /etc/ttys /etc/ttys.orig
cp /tmp/etc/ttys /etc</b>
</pre></blockquote>

<p>
Die folgenden Dateien haben Änderungen erfahren, die du dir genauer
ansehen solltest, da sie sehr wahrscheinlich nicht direkt kopiert oder
eingepflegt werden können (d.&nbsp;h. wenn du pf.conf verwendest, dann
solltest du dir die empfohlene Änderung der Sicherheitsrichtlinie
angucken und für dich selbst entscheiden, ob sie für deine Anwendungen
eingesetzt werden kann):

<blockquote><pre>
/etc/pf.conf
</pre></blockquote>

<p>
Es gibt noch ein paar weitere Dateien, die du löschen kannst, da sie
nicht länger in 4.3 verwendet werden:

<blockquote><pre>
<b>rm /etc/hoststated.conf /var/named/standard/root.hint</b>
</pre></blockquote>


Verwende schlussendlich
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newaliases&amp;sektion=8"
>newaliases(8)</a>, um die Alias-Datenbank zu aktualisieren,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>,
um alle neuen Verzeichnisse zu erstellen und
ändere den Besitzer und Zugriffsrechte für <tt>/etc/chio.conf</tt>:

<blockquote><pre>
<b>newaliases</b>
<b>mtree -qdef /etc/mtree/4.4BSD.dist -p / -u</b>
<b>chown root:operator /etc/chio.conf</b>
<b>chmod 644 /etc/chio.conf</b>
</pre></blockquote>

<a name="Kernchk"></a>
<h3>3. Überprüfe den Kernel</h3>
Hinweis: <b>Die meisten Leute können diesen Schritt überspringen!</b>
<p>
Wenn du den Anweisungen gefolgt bist, wie man einen Upgradeprozess
ohne Installationskernel durchführt, hast du diesen Schritt bereits
absolviert. Wenn du jedoch den Installationskernel und unter 4.2 einen
angepassten Kernel verwendet hast, wirst du das gleiche vermutlich
auch unter 4.3 machen wollen. Dabei kann es sich um so einfache Dinge
wie eine Änderung eines bestimmtes Devices mittels config(8) handeln,
doch könnte es genauso gut bedeuten, dass du den Kernel neuerzeugen
musst, da sich eine von dir benötigte Option nicht im GENERIC-Kernel
befindet. Lies bitte <a href="faq5.html">FAQ 5 - Das System aus dem
Quelltext erzeugen</a>, bevor du in Erwägung ziehst, deinen Kernel neu
zu erzeugen.

<a name="Pkgup"></a>
<h3>4. Packages upgraden</h3>
Wenn du irgendwelche Packages auf deinem System installiert hattest,
solltest du sie aktualisieren, nachdem du das Basissystem erfolgreich
upgegradet hast. Du solltest jedoch darauf achten, dass viele Packages
weitere Konfigurationsschritte vor (und/oder nach) dem Packageupgrade
benötigen. Lies die Upgradeanleitung für die Anwendung durch, wenn du
weitere Informationen benötigst.

<p>
Mit den Packagewerkzeugen kann man direkt mittels <tt>pkg_add -u</tt>
aktualisieren. Um zum Beispiel alle deine Packages zu aktualisieren,
stelle sicher, dass <tt>PKG_PATH</tt> auf das Verzeichnis deiner CD oder
eines FTP-Mirrors zeigt, in dem sich die 4.3-Packages befinden. Verwende
dann Folgendes:

<blockquote><pre>
#<b> pkg_add -ui -F update -F updatedepends</b>
</pre></blockquote>

Dabei gibt <tt>-u</tt> den Updatemodus an und <tt>-i</tt> den
interaktiven Modus, sodass pkg_add dich um Rat bittet, sollten
Probleme auftreten.
Lies die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1&amp;manpath=OpenBSD+4.3">pkg_add(1)</a>-Manualseite
und das Kapitel <a href="faq15.html#PkgMgmt">Verwaltung der Packages</a>
der FAQ für weitere Informationen.

<a name="rmxbase42"></a>
<h3>5. xbase42.tgz entfernen</h3>
Wenn du <tt>xbase42.tgz</tt> für libexpat installiert hast, da Packages
diese Bibliothek benötigten, brauchst du das Dateiset für 4.3 nicht
mehr. Du kannst es entweder entfernen oder <tt>xbase43.tgz</tt>
installieren.

<p>
Wenn du es entfernen möchtest, kannst du folgende Befehle verwenden:
<blockquote><pre>
# <b>mv /usr/X11R6/lib/libexpat.so.* /usr/lib</b>
# <b>rm -r /usr/X11R6 /etc/X11 /etc/fonts</b>
</pre></blockquote>

<p>
Wenn du <tt>xbase43.tgz</tt> installieren möchtest, musst du die
alten libexpat-Dateien entfernen:

<blockquote><pre>
# <b>mv /usr/X11R6/lib/libexpat.so.* /usr/lib</b>
# <b>rm /usr/X11R6/lib/libexpat*</b>
# <b>rm /usr/X11R6/include/expat*</b>
</pre></blockquote>

<p>
<font color="#0000e0">
<a href="upgrade35.html">[3.4 -> 3.5]</a> |
<a href="upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="upgrade38.html">[3.7 -> 3.8]</a> |
<a href="upgrade39.html">[3.8 -> 3.9]</a> |<br>
<a href="upgrade40.html">[3.9 -> 4.0]</a> |
<a href="upgrade41.html">[4.0 -> 4.1]</a> |
<a href="upgrade42.html">[4.1 -> 4.2]</a> |
<a href="upgrade44.html">[4.3 -> 4.4]</a> |
<a href="index.html">[FAQ-Index]</a>
</font>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[zurück]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: upgrade43.html,v 1.17 ]<br>
$Translation: upgrade43.html,v 1.9 2009/08/02 07:14:03 tobias Exp $<br>
-->
$OpenBSD: upgrade43.html,v 1.6 2009/08/06 12:33:02 ajacoutot Exp $
</small>

</body>
</html>
