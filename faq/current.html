<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Following -current</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 2005-2009 by OpenBSD">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<a href="../index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
</font>

<p>

<h1><font color="#e00000">Following <i>-current</i></font></h1>
<hr>

<h3>Table of Contents</h3>
<p>
<ul>
<li><a href="#Intro">Introduction</a>
<!-- Oldest on top... -->
<li><a href="#20090721">2009/07/01 - [ports] New postgresql release</a>
<li><a href="#20090724">2009/07/24 - thread model posix enabled for gcc 3</a>
<li><a href="#20090725">2009/07/25 - audio and MIDI device naming change</a>
<li><a href="#20090726">2009/07/26 - thread model posix reverted for gcc 3</a>
<li><a href="#20090801">2009/08/01 - "split-horizon" default behaviour and syntax change in ripd(8)</a>
<li><a href="#20090818">2009/08/18 - sysmerge(8) default running mode change</a>
<li><a href="#20090826">2009/08/26 - ftp(1) auto-fetch redirection handling change</a>
<li><a href="#20090901">2009/09/01 - pf(4) address translation changes</a>
<li><a href="#20090902">2009/09/02 - pf(4) route-to/reply-to syntax change</a>
<li><a href="#20090904">2009/09/04 - bgpd(8), dvmrpd(8) additonal syntax checking</a>
<li><a href="#20091001">2009/10/01 - [ports] Bacula major update</a>
<li><a href="#20091006">2009/10/06 - bgpd(8) capability announcement changes</a>
<li><a href="#20091019">2009/10/19 - need new config(8) to build the kernel</a>
<li><a href="#20091021">2009/10/21 - two packages come with perl 5.10.1</a>
<li><a href="#20091025">2009/10/25 - iwn(4) requires a firmware package update</a>
<li><a href="#20091103">2009/11/03 - pflogd(3) requires new method of logfile rotation</a>
<li><a href="#20091122">2009/11/22 - brconfig(8)/bridgename.if(5) replaced by ifconfig(8)/hostname.if(5)</a>
<li><a href="#20091213">2009/12/13 - [ports] New asterisk release and app_conference</a>
<li><a href="#20091220">2009/12/20 - Makefile.yp(8) support for mknetid(8) -P</a>
<li><a href="#20100110">2010/01/10 - IPsec/HMAC-SHA2 incompatible change</a>
<li><a href="#20100116">2010/01/16 - new user and group for nsd
<li><a href="#20100203">2010/02/03 - make(1) update required</a>
<li><a href="#20100222">2010/02/22 - new user and group for ldpd
<li><a href="#20100326">2010/03/26 - softraid(4) metadata changes</a>
<li><a href="#20100323">2010/03/23 - [ports] Major Dovecot upgrade</a>
<li><a href="#20100403">2010/04/03 - mandoc(1) required now</a>
<li><a href="#20100417">2010/04/17 - ahci(4) no longer attaches to RAID-mode disks</a>
<!-- New additions go on the bottom, please -->
</ul>
    
<hr>

<a name="Intro"></a>
<!-- XXXversion -->
<h2>Introduction</h2>
This document is for people who wish to follow <i>-current</i>.
It contains information about changes from 4.6-release to <i>-current</i>,
and should NOT be used by anyone upgrading from 4.5 or earlier, or people
wishing to follow <a href="../stable.html"><i>-stable</i></a>.

<p>
If you wish to update to 4.6-release or 4.6-stable from previous
versions, see the <a href="upgrade46.html">upgrade guide</a>.

<p>
Make sure you have read and understood
<a href="faq5.html">FAQ 5 - Building the System from Source</a>
before using -current and the instructions below.

<p>
You should ALWAYS use a snapshot as the starting point for running
<i>-current</i>.
Upgrading by compiling your own source code is not supported.

<p>
If you wish to see upgrade information for earlier versions of OpenBSD,
see <a href= "upgrade-old.html">upgrade-old.html</a>.
This is provided as a historical record -- it should NOT be used as
an upgrade procedure guide.

<p>
<a name="20090721"></a>
<h3>2009/07/21 - [ports] New postgresql version</h3>
The new version of postgresql requires that your databases be dumped
before upgrade and reloaded after.

<p>
<a name="20090724"></a>
<h3>2009/07/24 - thread model posix enabled for gcc 3</h3>
This change was reverted. No special steps are needed now.

<p>
<a name="20090725"></a>
<h3>2009/07/25 - audio and MIDI device naming change</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sndio&amp;sektion=7">sndio(7)</a>
now uses a different scheme for audio and MIDI device naming.
Though the old naming will continue working for some time, it's recommended
to start updating any scripts or configuration files of applications using 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sndio&amp;sektion=7">sndio(7)</a>,
as follows:

<ul>
<li>Convert old device names to new names, examples:
<pre>
     /dev/audio0   --&gt;   sun:0
     /dev/audio1   --&gt;   sun:1
     /dev/rmidi2   --&gt;   rmidi:2
     default       --&gt;   aucat:0
     mystuff       --&gt;   aucat:0.mystuff
</pre>
<li>If multiple instances of
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>
are running, then the -U option must be used to assign unit numbers to aucat(1)
processes. For instance, the following commands:
<pre>
     $ aucat -U 0 -l -f sun:3
     $ aucat -U 1 -l -s default -s mystuff -f sun:2
</pre>
will expose <tt>aucat:0</tt>, <tt>aucat:1</tt> and <tt>aucat:1.mystuff</tt> respectively.
</ul>

<p>
<a name="20090726"></a>
<h3>2009/07/26 - thread model posix reverted for gcc 3</h3>
For users who upgraded userland to enable thread model posix for gcc3,
follow these steps to upgrade. Otherwise no special steps are needed.
<ul>
<li>Build and install gcc:
<pre>
     # cd /usr/src/gnu/usr.bin/gcc
     # make -f Makefile.bsd-wrapper obj
     # make -f Makefile.bsd-wrapper depend
     # make -f Makefile.bsd-wrapper
     # make -f Makefile.bsd-wrapper install
     # make -f Makefile.bsd-wrapper clean
</pre>
<li><a href="faq5.html#BldUserland">Build and install userland</a>
</ul>

<p>
<a name="20090801"></a>
<h3>2009/08/01 - "split-horizon" default behaviour and syntax change in ripd(8)</h3>
<ul>
<li>The accepted values for "split-horizon" in <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ripd.conf&sektion=5">ripd.conf(5)</a> are now:
none, simple, poisoned.
<br>
The "default" parameter, used to force simple split horizon with no poisoned
reverse, has now been replaced with "simple".
<li>The default behaviour of split horizon is now set to poisoned reverse instead of none.
</ul>

<p>
<a name="20090818"></a>
<h3>2009/08/18 - sysmerge(8) default running mode change</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sysmerge&sektion=8">sysmerge(8)</a>
now runs in auto-mode by default.<br>
The "-a" switch has been replaced by "-b" which can be used to get the
former behaviour (full diff mode).

<p>
<a name="20090826"></a>
<h3>2009/08/26 - ftp(1) auto-fetch redirection handling change</h3>
In <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp&sektion=1">ftp(1)</a>,
when auto-fetching (command line operation) is used without specifying a
filename with <tt>-o</tt>, the file is now always saved under a filename
derived from the command line. Previous behaviour was to derive the
filename from the redirection URL.

<p>
<a name="20090901"></a>
<h3>2009/09/01 - pf(4) address translation changes</h3>
As described in more detail in
<a href="http://marc.info/?l=openbsd-misc&m=125181847818600&w=2">this
mailing list post</a>, PF's separate nat/rdr/binat (translation) rules
have been replaced with actions on regular match/filter rules.
Simple rulesets may be converted like this:<p>

<pre>   nat on $ext_if from 10/8 -&gt; ($ext_if)
   rdr on $ext_if to ($ext_if) -&gt; 1.2.3.4</pre>
becomes<br>
<pre>   match out on $ext_if from 10/8 nat-to ($ext_if)
   match in on $ext_if to ($ext_if) rdr-to 1.2.3.4</pre><p>

and...

<pre>   binat on $ext_if from $web_serv_int to any -&gt; $web_serv_ext</pre>
becomes<br>
<pre>   match on $ext_if from $web_serv_int to any binat-to $web_serv_ext</pre>

nat-anchor and/or rdr-anchor lines, e.g. for 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=relayd">relayd(8)</a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy">ftp-proxy(8)</a>
and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftp-proxy">tftp-proxy(8)</a>,
are no longer used and should be removed from
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf">pf.conf(5)</a>,
leaving only the anchor lines. Translation rules relating to these and 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd">spamd(8)</a>
will need to be adjusted as appropriate.<p>

N.B.: Previously, translation rules had "stop at first match" behaviour,
with binat being evaluated first, followed by nat/rdr depending on direction
of the packet. Now the filter rules are subject to the usual "last match"
behaviour, so care must be taken with rule ordering when converting.

<p>
<a name="20090902"></a>
<h3>2009/09/02 - pf(4) route-to/reply-to syntax change</h3>
The route-to, reply-to, dup-to and fastroute options in pf.conf
move to filteropts;
<pre>   pass in on $ext_if route-to (em1 192.168.1.1) from 10.1.1.1
   pass in on $ext_if reply-to (em1 192.168.1.1) to 10.1.1.1</pre>
becomes<br>
<pre>   pass in on $ext_if from 10.1.1.1 route-to (em1 192.168.1.1)
   pass in on $ext_if to 10.1.1.1 reply-to (em1 192.168.1.1)</pre>

<p>
<a name="20090904"></a>
<h3>2009/09/04 - bgpd(8), dvmrpd(8) additonal syntax checking</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd">bgpd(8)</a>
and <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dvmrpd">dvmrpd(8)</a>
now strictly check whether something other than yes or no is used
in a yes/no token. If your existing syntax is incorrect (e.g. using
"announce capabilities none" instead of "no") this will produce an
error at startup rather than starting up and silently giving incorrect
behaviour.

<p>
<a name="20091001"></a>
<h3>2009/10/01 - [ports] Bacula major version update</h3>
Bacula has been upgraded from 2.4.4 to 3.0.2; this has a new catalog
format which requires a database schema change on the director. The
<a href="http://permalink.gmane.org/gmane.os.openbsd.ports.cvs/39031">commit
log entry</a> and
<a href="http://sourceforge.net/project/shownotes.php?release_id=674473">release
notes</a> have more details.

The server components (storage daemons and director) are not compatible
between major versions so these must be upgraded together.

<ul>
<li>3.x server components (sd/dir) <b>are</b> backwards compatible with 2.4.x clients.
<li>3.x clients are <b>not</b> compatible with 2.4.x server components.
</ul>

<p>
<a name="20091006"></a>
<h3>2009/10/06 - bgpd(8) capability announcement changes</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd">bgpd(8)</a>
now announces 4-byte ASN and graceful restart capabilities by default.
Previously graceful restart was not announced by default, and 4-byte
ASN support was only advertised when one or other peer used an ASN
above 65535. There is now per-session control over which capabilities
are announced:
<pre>   announce refresh yes # was already on by default
   announce restart no
   announce as-4byte no # was only set on sessions to peers with 4byte AS nums </pre>

<p>
<a name="20091019"></a>
<h3>2009/10/19 - need new config(8) to build the kernel</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config">config(8)</a>
has been changed. You must install a new version before building a kernel
from newly updated sources.
<pre>
   # cd /usr/src/usr.sbin/config
   # make
   # make install</pre>

<p>
<a name="20091021"></a>
<h3>2009/10/21 - two packages come with perl 5.10.1</h3>
p5-parent and p5-Parse-CPAN-Meta now come with base Perl.
If you have installed the packages, delete them.
<pre>
   # pkg_delete p5-parent p5-Parse-CPAN-Meta </pre>

<p>
<a name="20091025"></a>
<h3>2009/10/25 - iwn(4) requires a firmware package update</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=iwn">iwn(4)</a>
now needs iwn-firmware package version 5.2.
You can install the iwn-firmware-5.2 package with:
<pre>
   # pkg_add http://damien.bergamini.free.fr/packages/openbsd/iwn-firmware-5.2.tgz </pre>

<p>
<a name="20091103"></a>
<h3>2009/11/03 - pflogd(8) requires new method of logfile rotation</h3>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd">pflogd(8)</a>
has lost its <tt>-p</tt> option. Change <tt>/etc/newsyslog.conf</tt> to
include:
<pre>
   /var/log/pflog	600  3     250  *     ZB "pkill -HUP -u root -U root -t - -x pflogd"
</pre>

<p>
<a name="20091122"></a>
<h3>2009/11/22 - brconfig(8)/bridgename.if(5) replaced by ifconfig(8)/hostname.if(5)</h3>
The functionality of
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=brconfig">brconfig(8)</a>
has been integrated into
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig">ifconfig(8)</a>.
Since the <tt>priority</tt> argument to set the spanning tree priority
on a bridge conflicts with the existing ifconfig(8) interface priority,
it has been renamed to <tt>spanpriority</tt>.
<p>
Existing /etc/bridgename.bridge* files should be replaced with
/etc/hostname.bridge* files; if you use <tt>priority</tt>, replace
it with <tt>spanpriority</tt>.

<p>
<a name="20091213"></a>
<h3>2009/12/13 - [ports] New asterisk release and app_conference</h3>
The Asterisk package was updated to 1.6.0.x, you might need to make some
configuration changes; please see /usr/local/share/doc/asterisk/UPGRADE-16.txt.
The old app_conference plugin is incompatible with the new version, you must use
appkonference instead.

<p>
<a name="20091220"></a>
<h3>2009/12/20 - Makefile.yp(8) support for mknetid(8) -P</h3>
On YP server hosts, merge
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/usr.sbin/ypserv/ypinit/Makefile.yp#rev1.15">Makefile.yp rev. 1.15</a>
into all your copies of the YP Makefile, <tt>/var/yp/*/Makefile</tt>.
Strictly speaking, this is only required if you have set the DIR variable
to a non-standard YP source directory AND you do not provide a passwd(5)
file in your YP source directory.  For maximum security to never leak group
information from <tt>/etc/master.passwd</tt> into your netid(5) YP map,
it is recommended that all YP server hosts be updated.

<a name="20100110"></a>
<h3>2010/01/10 - IPsec/HMAC-SHA2 incompatible change</h3>
Two bugs in
<a href="http://marc.info/?l=openbsd-cvs&m=126312766621593&w=2">IPsec/HMAC-SHA2</a>
were fixed, resulting in an incompatibility with the HMAC-SHA-256/384/512
hash algorithms with previous versions of OpenBSD and other IPsec
implementations sharing the bugs.
In particular the default authentication algorithm HMAC-SHA-256
is affected.
Upgrade both sides together, or switch to another authentication
algorithm during the transition.
The per-packet overhead has increased; if you are clamping the
MSS to exact values (i.e. without slack), this will need to be
recalculated.

<a name="20100116"></a>
<h3>2010/01/16 - new user and group for nsd</h3>
The following needs to be run:
<blockquote><pre>
useradd -u 97 -g =uid -c "NSD Daemon" -d /var/empty -s /sbin/nologin _nsd
</pre></blockquote>

<a name="20100203"></a>
<h3>2010/02/03 - make(1) update required</h3>
Changes in the build infrastructure to build the
<a href="../loongson.html">OpenBSD/loongson</a> port require the use of a new
make(1) binary, providing the <tt>MACHINE_CPU</tt> variable to Makefiles.
You must install a new version before building userland
from newly updated sources.
<pre>
   # cd /usr/src/usr.bin/make
   # make depend
   # make
   # make install</pre>

<a name="20100222"></a>
<h3>2010/02/22 - new user and group for ldpd(8)</h3>
The following needs to be run:
<blockquote><pre>
useradd -u 98 -g =uid -c "LDP Daemon" -d /var/empty -s /sbin/nologin _ldpd
</pre></blockquote>

<p>
<a name="20100326"></a>
<h3>2010/03/26 - softraid(4) metadata changes</h3>
The
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=softraid&sektion=4">softraid(4)</a>
metadata format has changed and is not compatible with previous versions.
As a result, any softraid volumes created with older kernels will not assemble.
Data on existing volumes should be backed up before upgrading.
The volume should then be recreated and the data restored.

<a name="20100323"></a>
<h3>2010/03/23 - [Ports] Major Dovecot upgrade</h3>
Dovecot has been updated from 1.1.20 to 1.2.11. The configuration file changed 
and the old cmusieve plugin has been removed in favor of the new Dovecot sieve 
implementation. The 
<a href="http://permalink.gmane.org/gmane.os.openbsd.ports.cvs/42080">commit 
log entry</a> has more details.

<a name="20100403"></a>
<h3>2010/04/03 - mandoc(1) required now</h3>
mandoc(1) has been added to the build tree, and is now required for
building the system.  If you do not have it:
<pre>
    # cd /usr/src/usr.bin/mandoc
    # make obj
    # NOMAN= make && NOMAN= make install
</pre>

<a name="20100417"></a>
<h3>2010/04/17 - ahci(4) no longer attaches to RAID-mode disks</h3>
To avoid risk of corrupting metadata on certain Intel RAID devices,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&sektion=4">ahci(4)</a>
no longer attaches to the PCI device IDs used by these controllers
when set to RAID mode.
If you lose access to your disks, you'll need to change the
controller type from RAID to AHCI in the BIOS to get them back.

<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../images/back.gif" border= "0" alt="[back]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>$OpenBSD: current.html,v 1.201 2010/04/18 17:43:22 nick Exp $</small>

</body>
</html>
