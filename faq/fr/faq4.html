<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>4 - Guide d'Installation d'OpenBSD 4.6</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright" content= "This document copyright 1998-2009 by OpenBSD.">
</head>

<!-- Passes validator.w3.org.  Please keep it this way -->

<body bgcolor= "#ffffff" text= "#000000">

<a href="../../fr/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">
</a>
<p>

<font color= "#0000e0">
<a href= "index.html">[Retour à l'Index principal]</a>
<a href= "faq3.html">[Section 3 - Démarrer avec OpenBSD]</a>
<a href= "faq5.html">[Section 5 - Construire le Système à partir des Sources]</a>
</font>

<h1><font color="#e00000">4 - Guide d'Installation d'OpenBSD 4.6</font></h1>
<!-- UNCOMMENT ONLY WHEN THE FILE IS OUT OF SYNC

<hr>
<p>
<b><font color="#e00000">Remarque Importante :</font></b> Le contenu de
   ce fichier est obsolète. Consultez la version anglaise 
   <a href="../faq4.html">ici</a> pour des informations à jour.

<p>
Si vous souhaitez contribuez à l'effort de traduction,
prière de consulter
<a href="../../fr/translation.html">la page de traduction</a>.

-->
<hr>

<p>
<h3>Table des Matières</h3>
<ul>
<li><a href= "#Overview"    >4.1 - Présentation de la procédure d'installation
                                     d'OpenBSD</a>
<li><a href= "#Checklist"   >4.3 - Vérifications avant l'installation</a>

<li><a href="#MkInsMedia"   >4.3 - Créer un média d'installation OpenBSD amorçable</a>
    <ul>
    <li><a href="#MkCD-ROM" >4.3.1 - Créer un CD-ROM amorçable</a>
    <li><a href="#UnixFlop" >4.3.2 - Créer des disquettes de démarrage sur Unix</a>
    <li><a href="#DosFlop"  >4.3.3 - Créer des disquettes de démarrage sur Windows</a>
    </ul>
<li><a href="#Boot"         >4.4 - Démarrer le média d'installation OpenBSD</a>
<li><a href="#Install"      >4.5 - Installer OpenBSD simplement</a>
  <ul>
  <li><a href="#InstStart"    >4.5.1 - Commencer l'installation</a>
  <li><a href="#InstQuestions">4.5.2 - Questions lors de l'installation</a>
  <li><a href="#InstDisks"    >4.5.3 - Configurer les disques</a>
  <li><a href="#InstMedia"    >4.5.4 - Choisir le média d'installation et
      les sets de fichiers</a>
  <li><a href="#Inst1stBoot"  >4.5.5 - Premier démarrage !</a>
  <li><a href="#InstFinish"   >4.5.6 - Une derniére chose...</a>
  </ul>

<li><a href="#More"          >4.6 - Détails pour une installation plus complexe</a>
  <ul>
  <li><a href="#MoreNetwork"  >4.6.1 - Configurer le réseau</a>
  <li><a href="#MoreTimeZone" >4.6.2 - Configurer le fuseau horaire</a>
  <li><a href="#Morefdisk"    >4.6.3 - Personnaliser la configuration via fdisk(8)</a>
  <li><a href="#Moredisklabel">4.6.4 - Personnaliser la configuration via disklabel</a>
  </ul>
<li><a href= "#FilesNeeded"  >4.7 - Quels sont les fichiers nécessaires à l'installation ?</a>
<li><a href= "#Partitioning" >4.8 - Comment est-ce que je dois partitionner mon disque ?</a>
<li><a href= "#Multibooting">4.9 - Multiboot OpenBSD/i386</a>
<li><a href= "#SendDmesg"   >4.10 - Envoyer votre dmesg à dmesg@openbsd.org après l'installation</a>
<li><a href= "#AddFileSet"  >4.11 - Ajouter un paquetage après l'installation</a>
<li><a href= "#bsd.rd"      >4.12 - Qu'est ce que 'bsd.rd' ?</a>
<li><a href= "#InstProb"    >4.13 - Problèmes d'installation courants</a>
  <ul>
  <li><a href="#cpq16m"     >4.13.1 - Mon Compaq ne reconnaît que 16M de RAM</a>
  <li><a href="#noboot"     >4.13.2 - Mon i386 ne démarre pas après l'installation</a>
  <li><a href="#sshhang"    >4.13.3 - Ma machine a démarré, mais bloque pendant la procédure
                                      ssh-keygen</a>
  <li><a href="#noftplist"  >4.13.4 - J'ai le message "Failed to change directory" pendant
                                      l'installation</a>
  <li><a href="#blankfdisk" >4.13.5 - Ma table de partition fdisk est corrompue ou vide !</a>
  <li><a href="#noflopcd"   >4.13.6 - Je ne posséde pas de lecteur de
  disquette ou de CD-ROM sur ma machine</a>
  </ul>
<li><a href= "#site"        >4.14 - Personnaliser la procédure d'installation</a>
<li><a href= "#Multiple"    >4.15 - Comment puis-je installer plusieurs systèmes identiques ?</a>
<li><a href="#getdmesg"     >4.16 - Comment puis-je obtenir un dmesg(8) pour rapporter un
                                    problème d'installation ?</a>
</ul>
<hr>

<p>
<a name= "Overview"></a>
<h2>4.1 - Présentation de la procédure d'installation OpenBSD</h2>

<p>
OpenBSD a longtemps été respectée pour son processus d'installation simple, 
et qui est cohérent à travers toutes les plateformes.
Pour OpenBSD 4.6, ce processus a été amélioré pour être encore plus simple
et rapide pour la plupart des utilisateurs, tout en restant flexible et avec
l'installateur OpenBSD "une disquette" pour lequel il est connu.

<p>
La plupart des architectures suivent une procédure d'installation
similaire ; cependant quelques détails diffèrent sur quelques plateformes.
Dans tous les cas, il vous est vivement conseillé de lire le document
INSTALL spécifique à votre architecture se trouvant dans le dossier
<i>"platform"</i> sur le CD-ROM ou les sites FTP (par exemple,
<tt>i386/INSTALL.i386</tt>, <tt>mac68k/INSTALL.mac68k</tt> ou
<tt>sparc/INSTALL.sparc</tt>).

<p>
L'installation d'OpenBSD utilise un noyau <a href="#bsd.rd">spécial</a>
avec un certain nombre d'utilitaires et de scripts d'installation inclus dans 
un disque RAM préchargé. Après le démarrage de ce noyau, le système d'exploitation 
est extrait depuis plusieurs fichiers
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
(<tt>.tgz</tt>) compressés à partir d'une source autre que ce disque RAM
préchargé.
Il existe de nombreux moyens de démarrer ce noyau d'installation :

<ul>
<li><b>Disquette :</b>
OpenBSD peut être installé sur beaucoup de plateformes en démarrant
l'installation à partir d'une seule disquette.
Cependant, à cause de contrainte d'espace, des plateformes plus gourmandes
(sparc64, amd64 et alpha) ne possédent pas certaines utilitaires qui peuvent
être important pour vous, comme le client DHCP pour configurer le réseau.
Pour ces plateformes, il est préférable d'utiliser l'installation avec le CD.
Cependant, pour les plateformes comme sparc et i386, vous trouverez la
disquette de démarrage trés compléte.

<p>
Des images de disquettes utilisables pour
créer une disquette d'installation depuis un autre système
<a href="#UnixFlop">Compatible Unix</a> ou sur un système
<a href="#DosFlop">Windows</a> sont fournies.
Les noms de fichiers typiques sont <tt>floppy46.fs</tt>, bien que
plusieurs architectures possèdent de multiples images de disquettes.

<li><b>CD-ROM :</b> Sur plusieurs architectures une image CD-ROM
    (<tt>cd46.iso</tt> pour effectuer uniquement un démarrage, ou
    <tt>install46.iso</tt> pour l'installation complète) est fournie
    permettant la création d'un CDROM amorçable.

<li><b>Partition existante :</b> Le noyau du <a href="#bsd.rd">disque
    RAM</a> peut être démarré à partir d'une partition OpenBSD existante
    (i.e., une mise à jour ou une réinstallation).

<li><b>Réseau:</b> Quelques architectures supportent le démarrage à
    travers un réseau (en utilisant par exemple
    <a href="faq6.html#PXE">PXE</a> ou d'autres méthodes de 
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">démarrage réseau</a>).

<li><b>Ecrire un système de fichiers sur disque (miniroot) :</b>une
    image de système de fichiers qui peut être écrite sur une partition
    existante et qui peut être amorcée par la suite.

<li><b>Cassettes amorçables :</b> Certaines architectures supportent
    l'amorçage depuis des cassettes.
    Ces cassettes peuvent être créées en suivant les instructions du
    fichier INSTALL.<i>platform</i>.
</ul>

Toutes les <a href="../../fr/plat.html">architectures</a> ne supportent
pas chacune des options de démarrage :

<ul>
<li><a href="../../fr/alpha.html"><b>alpha :</b></a> Disquette, CD-ROM,
    Réseau, Ecriture d'une image de disquette sur le disque dur.

<li><a href="../../fr/amd64.html"><b>amd64 :</b></a> Disquette, CD-ROM,
    <a href="faq6.html#PXE">Réseau</a>.

<li><a href="../../fr/armish.html"><b>armish:</b></a> Dépend du système
    hôte.
 
<li><a href="../../fr/hp300.html"><b>hp300 :</b></a> CD-ROM, Réseau.

<li><a href="../../fr/hppa.html"><b>hppa :</b></a> Réseau.

<li><a href="../../fr/i386.html"><b>i386 :</b></a> Disquette, CD-ROM, <a
    href="faq6.html#PXE">Réseau</a>.

<li><a href="../../fr/landisk.html"><b>landisk:</b></a> miniroot,
    installation en utilisant un autre système.

<li><a href="../../fr/macppc.html"><b>macppc :</b></a> CD-ROM, Réseau.

<li><a href="../../fr/mvme68k.html"><b>mvme68k :</b></a> Réseau,
    Cassette amorçable.

<li><a href="../../fr/mvme88k.html"><b>mvme88k :</b></a> Réseau,
    Cassette amorçable.

<li><a href="../../fr/sparc.html"><b>sparc :</b></a> Disquette, CD-ROM,
    Réseau, Ecriture d'une image sur une partition swap existante,
    Cassette amorçable.

<li><a href="../../fr/sparc64.html"><b>sparc64 :</b></a> Disquette
    (U1/U2 uniquement), CD-ROM, Réseau, Ecriture d'une image sur une
    partition existante.

<li><a href="../../fr/vax.html"><b>vax :</b></a> Disquette, Réseau.

<li><a href="../../fr/zaurus.html"><b>zaurus:</b></a> Démarrer bsd.rd à
    partir d'une partition Linux. Veuillez consulter
    <a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.6/zaurus/INSTALL.zaurus">INSTALL.zaurus</a>
    pour plus de détails.
</ul>

Toutes les installations autres que mac68k peuvent aussi utiliser un
noyau <a href="#bsd.rd">bsd.rd</a> lors d'une mise à jour ou d'une
réinstallation.

<p>
Une fois le noyau démarré, vous avez plusieurs options pour obtenir les
<a href="#FilesNeeded">paquetages d'installation</a>.
Une fois de plus, toutes les architectures ne supportent pas toutes ces
options.

<ul>
<li><b>CD-ROM :</b> Bien sûr, nous préférons que vous utilisiez les
    <a href="../../orders.html">CD-ROMS Officiels</a>, mais vous pouvez
    utiliser <tt>install46.iso</tt> ou créer les vôtres.

<li><b>FTP :</b>
    L'un des différents <a href="../../fr/ftp.html">sites miroirs
    FTP</a> OpenBSD ou votre serveur FTP local contenant les paquetages.

<li><b>HTTP :</b>
L'un des différents
<a href="../../fr/ftp.html#http">sites miroirs HTTP</a>
OpenBSD ou votre serveur web local contenant les paquetages.

<li><b>Partition de disque local :</b>
Dans la plupart des cas, vous pouvez installer les paquetages depuis une
autre partition de votre disque dur local.
Par exemple, sur <a href="../../fr/i386.html">i386</a>,
vous pouvez installer à partir d'une partition FAT ou d'un CD-ROM
formaté au format ISO9660, Rock Ridge ou Joliet.
Dans certains cas, vous devrez manuellement monter le système de
fichiers avant de l'utiliser.

<li><b>NFS :</b>
Quelques architectures supportent les montages NFS de paquetages.

<li><b>Cassette :</b>
Les paquetages peuvent aussi être lus depuis une cassette formatée.

Ces cassettes peuvent être créées en suivant les instructions du fichier
<tt>INSTALL.</tt><i>platform</i>.

</ul>

<a name="Checklist"></a>
<h2>4.3 - Vérifications avant l'installation</h2>

<p>
Avant de commencer votre installation, vous devriez avoir une
idée de ce que vous allez devoir faire.

Vous devriez connaître ces différents éléments au minimum :
<ul>
<li>Nom de la machine.
<li>Matériel installé et disponible.
  <ul>
  <li>La compatibilité de votre architecture grâce à la page de compatibilité.
  <li>Dans les cas d'utilisation de matériel ISA, vous devrez aussi
      connaître les paramètres matériels et confirmer qu'ils sont tels
      qu'OpenBSD les requiert.
  </ul>
<li>La méthode d'installation qui sera utilisée (CD-ROM, FTP, etc.)
<li>Comment le système sera-t-il mis à jour et corrigé ?
  <ul>
  <li>Si cela est fait localement, vous devrez bénéficier de suffisamment
      <a href="#Partitioning">d'espace libre</a> pour stocker l'arbre des
      sources et le construire.
  <li>Autrement, vous aurez besoin d'accéder à une autre machine pour y
      construire une <a href="faq5.html#Release">release</a> patchée.
  </ul>
<li>Partitionnement de disque désiré.
  <ul>
  <li>Y-a-t-il des données à sauvegarder quelque part ?
  <li>OpenBSD coexistera-t-il sur ce système avec d'autres OS ?
      Si oui, comment seront-ils démarrés ?
      Aurez vous besoin d'installer un gestionnaire de démarrage ?
  <li>La totalité du disque sera-t-elle utilisée par OpenBSD ou
      voulez-vous conserver une partition ou un OS (ou de la place pour
      un autre) ?
  <li>Comment souhaitez vous partitionner la partie réservée à OpenBSD
      de votre disque ?
  </ul>
<li>Paramètres Réseau, si vous n'utilisez pas DHCP :
  <ul>
  <li>Nom de domaine.
  <li>Adresse des Serveurs de Nom de Domaine (DNS).
  <li>Adresse IP et masque de sous-réseau pour chaque NIC.
  <li>Adresse de la passerelle.
  </ul>
<li>Lancerez vous le système de fenêtres X ?
</ul>


<a name="MkInsMedia"></a>
<h2>4.3 - Créer un média d'installation OpenBSD amorçable</h2>

<p>
Comme exemples, nous allons regarder les images d'installation
disponibles pour les architectures
<a href="../../fr/i386.html">i386</a> et
<a href="../../fr/sparc.html">sparc</a>.

<p>
L'architecture <a href="../../fr/i386.html">i386</a> dispose de six
images de disques séparées parmi lesquelles choisir :

<ul>
<li><b><tt>cdemu46.iso</tt></b> est une image ISO9660 se servant de
    l'émulation d'une disquette de 2.88M pour démarrer. Il faut espérer
    que peu de personnes auront à utiliser cette image -- la plupart
    utiliseront <tt>cd46.iso</tt>, n'utilisez <tt>cdemu46.iso</tt> que
    si <tt>cd46.iso</tt> ne fonctionne pas pour vous.
<li><b><tt>install46.iso</tt></b> est une image ISO9660 contenant tous
    les fichiers d'installation standard.
    Ce fichier peut être utilisé pour créer un CD permettant de faire
    une installation OpenBSD de façon autonome.
<li><b><tt>floppy46.fs</tt></b> (PC de bureau) supporte la plupart
    des cartes PCI et ISA, des adaptateurs IDE et des adaptateurs
    SCSI simples ainsi que quelques matériels PCMCIA. La plupart
    des utilisateurs utiliseront cette image.
<li><b><tt>floppyB46.fs</tt></b> (Serveurs) supporte plusieurs
    contrôleurs RAID et quelques adaptateurs SCSI courants. Toutefois le
    support pour certains adaptateurs SCSI et plusieurs NICs EISA et ISA
    a été retiré.
<li><b><tt>floppyC46.fs</tt></b> (Portables) supporte les matériels
    CardBus et PCMCIA trouvés sur la plupart des portables.
</ul>

<p>
L'architecture
<a href="../../fr/sparc.html">sparc</a> dispose de quatre images disques
d'installation parmi lesquelles choisir :

<ul>
<li><b><tt>floppy46.fs:</tt></b> Supporte les systèmes équipés d'un
    lecteur de disquettes.
<li><b><tt>cd46.iso</tt></b> Une image ISO utilisable pour créer votre
    propre CD afin d'amorcer les systèmes SPARC à l'aide un CD-ROM.
<li><b><tt>miniroot46.fs</tt></b> peut être écrite sur une partition
    swap et démarrée.
<li><b><tt>install46.iso</tt></b> est une image ISO9660 contenant tous
    les fichiers d'installation standard.
    Ce fichier peut être utilisé pour créer un CD permettant de faire
    une installation OpenBSD de façon autonome.
</ul>

Sur les plateformes récentes, vous serez plus avisé d'utiliser les images de
démarrage CDROM, comme dans certaines plateformes "gourmandes" (comme sparc64
et amd64), les images disquette ont beaucoup de pilotes et d'utilitaires
supprimés, ce qui peut compliquer l'installation.
Les plateformes plus anciennes, comme le i386 et sparc, sont toujours
installable facilement d'une disquette.

<a name="MkCD-ROM"></a>
<h3>4.3.1 - Créer un CD-ROM amorçable</h3>

<p>
Vous pouvez créer un CDROM en utilisant les fichiers <tt>cd46.iso</tt> ou
<tt>install46.iso</tt>.
Les détails exactes sont laissés ici au lecteur afin de déterminer quels
outils sont à leur disposition.

<p>
Avec OpenBSD, vous pouvez créer un CD d'une image ISO en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a> :

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cdio tao cd46.iso</b>
</pre></td></tr></table>

<p>
La plupart des graveurs de CD vendus avec les systèmes Windows et Macintosh
sont livrés avec des logiciels pour graver une image ISO sur un media vierge.
Si le votre ne le permet pas, il y a plusieurs applications gratuites qui
peuvent le faire pour vous.

<p>
D'autres systèmes Unix-like utilisent des applications comme
<a href="http://www.cdrkit.org/">cdrkit</a>.


<a name="MkFlop"></a>
<a name="UnixFlop"></a>
<h3>4.3.2 - Créer des disquettes de démarrage sur Unix</h3>

<p>
Les détails précis et les noms de périphériques peuvent varier d'une
variante Unix à une autre; utilisez ce qui est approprié sur votre système.

<p>
Pour créer une disquette formatée, utilisez la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdformat&amp;sektion=1&amp;arch=i386">fdformat(1)</a>
pour chacun des formats et recherchez les secteurs défectueux..

<p>
<table border=0 width="90%"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  # <b>fdformat /dev/rfd0c</b>
  Format 1440K floppy `/dev/rfd0c'? (y/n): y
  Processing VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV done.
</pre></td></tr> </table>

<p>
Si votre sortie est identique à celle ci-dessus, votre disque est correct.
Cependant, si vous ne voyez pas tous les "V" alors votre disque est
probablement endommagé et vous devriez en essayer un autre.

<p>
Pour écrire un ficher image sur une disquette, utilisez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=0">dd(1)</a>.
Un exemple d'utilisation de <tt>dd(1)</tt> est fourni ci-dessous :

<p>
<table border=0 width="90%"> <tr> <td nowrap bgcolor="#EEEEEE"><pre>
  # <b>dd if=floppy46.fs of=/dev/rfd0c bs=32k</b>
</pre></td></tr></table>

<p>
Une fois l'image écrite, vérifiez qu'elle a été correctement copiée et
qu'elle est identique à l'image d'origine avec la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cmp&amp;sektion=1">cmp(1)</a>.
Si la disquette est identique à l'image, vous ne verrez apparaître
qu'une nouvelle invite de commande.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # <b>cmp /dev/rfd0c floppy46.fs</b>
</pre></td> </tr> </table>

<a name="DosFlop"></a>
<h3>4.3.3 - Créer des disquettes de démarrage sur Windows</h3>

<p>
Pour préparer la disquette sous Windows, utilisez tout d'abord les 
utilitaires natifs pour formater le disque, vérifiez qu'il ne posséde
pas de secteurs défectueux.

<p>
Pour écrire l'image d'installation sur la disquette préparée vous
pouvez utiliser <tt>ntrw.exe</tt>, qui peut être téléchargé du répertoire
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.6/tools/">tools</a>
de la plupart des miroirs FTP.


<p>
Exemple d'utilisation de <i>ntrw</i> :
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  C:\> <strong>ntrw floppy46.fs a:</strong>
  3.5", 1.44MB, 512 bytes/sector
  bufsize is 9216
  1474560 bytes written
</pre></td></tr></table>


<a name="Boot"></a>
<h2>4.4 - Démarrer le média d'installation OpenBSD</h2>

<h3>Démarrer sur i386/amd64</h3>

Démarrer une image d'installation sur les architectures PC i386 et amd64 n'est
pas nouveau pour la plupart des gens.
Votre système devra être informé pour démarrer de n'importe quel média que
vous avez choisi d'utiliser, habituellement à travers des options de
configuration du BIOS.
Si vous souhaitez démarrer depuis un CD-ROM, vous devrez aller dans
votre BIOS système et autoriser le démarrage depuis celui-ci.
Quelques anciens BIOS ne supportent pas cette option, et vous devrez
utiliser une disquette pour démarrer votre image d'installation. Ne vous
inquiétez pas ; bien que vous démarriez depuis la disquette, vous
pourrez installer depuis le CD si cela est supporté par OpenBSD (par exemple, 
presque tous les disques IDE).

<p>
Vous pouvez aussi démarrer <a href="#bsd.rd">bsd.rd</a> depuis une
partition OpenBSD existante, ou depuis le réseau en utilisant la
<a href="faq6.html#PXE">procédure de démarrage PXE</a>.

<h3>Démarrer sur sparc/sparc64</h3>

<b>NOTE :</b>
Sur l'architecture <a href="../../fr/sparc64.html">sparc64</a>, seules
les machines SBus (Ultra 1, Ultra 2) sont amorçables depuis une
disquette.

<p>
Vous aurez besoin que le système soit sur le prompt du moniteur de ROM, qui
ressemble habituellement à "<tt>ok </tt>".
Si vous utilisez un clavier SUN, tapez et pressez en même temps "STOP" et
"A".
Si vous utilisez une console série, un BREAK devrez vous retourner le prompt
du moniteur.

<p>
Utilisez ensuite la commande suivante pour démarrer :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot floppy</b>
</pre></td></tr></table>

<p>
Normalement, vous pouvez démarrer du lecteur de CDROM d'un système Sun à
partir de l'invite de démarrage en tapant '<tt>boot cdrom</tt>' :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  ok <b>boot cdrom</b>
</pre></td></tr></table>

<a name="Install"></a>
<h2>4.5 - Installer OpenBSD simplement</h2>

Le nouvel installateur d'OpenBSD a été concu pour installer et configurer
OpenBSD dans une configuration utilisable par défaut avec trés peu
d'intervention de la part de l'utilisateur.
En fait, vous pouvez juste taper <i>ENTER</i> un certain nombre de fois pour
obtenir une bonne installation d'OpenBSD, pour déplacer vos mains sur le
reste du clavier pour uniquement entrer le mot de passe root.

<p>
L'installateur créera un plan de partitionnement basé sur la taille de votre
disque dur.
Même si cela n'est PAS un modéle parfait pour tout le monde, cela fourni un
bon point de départ et une bonne stratégie d'ensemble pour définir vos
besoins. 

<p>
Nous allons démarrer avec une installation trés simple, avec quelques
commentaires sur les options disponibles, et en utilisant la magie des liens
hypertextes, cela vous permettra d'en lire plus sur certains sujets qui vous
intéressent et en explorer les options.

<p>
Les notes d'installation pour chaque plateforme sont sur les CDs
d'installation et les serveurs FTP dans le fichier 
<tt>INSTALL.<i>&lt;plat&gt;</i></tt>, ou <i>&lt;plat&gt;</i> est votre 
<a href="../../fr/plat.html">plateforme</a>, par exemple <tt>i386</tt>.

<a name="InstStart"></a>
<h3>4.5.1 - Commencer l'installation</h3>
<!-- XXXrelease -->
Quelle que soit votre méthode de démarrage, il est temps de l'utiliser.
Pendant la procédure de démarrage, le noyau et tous les programmes
utilisés pour installer OpenBSD sont chargés en mémoire. 
Aprés que le noyau d'installation est démarré, le média de démarrage n'est
plus nécessaire, tout fonctionne du disque en MEMOIRE.
Vous pouvez à ce moment retirer le CD ou la disquette dont vous avez
démarré, car vous n'avez plus besoin du CD pour des fichiers d'installation.

<p>
A presque tout moment de la procédure d'installation OpenBSD, vous
pouvez arrêter la procédure en frappant CTRL-C et pourrez la relancer
sans avoir à redémarrer en lançant <tt>install</tt> à l'invite shell.
Vous pouvez aussi taper un "!" dans la plupart des cas lors de
l'installation pour obtenir l'invite shell, et quitter le shell pour
retourner à l'installation.

<p>
Si votre démarrage réussi, vous verrez beaucoup de messages défiler.
Ces textes, dans beaucoup d'architectures en blanc sur bleu, représentent le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg</a>,
du noyau qui cite les matériels trouvés et comment ils sont connectés aux
autres périphériques. 
Une copie de ce message est conservée dans <tt>/var/run/dmesg.boot</tt>.

<p>
Ensuite, vous verrez ce qui suit :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  root on rd0a swap on rd0b dump on rd0b
  erase ^?, werase ^W, kill ^U, intr ^C, status ^T
  Welcome to the OpenBSD/i386 4.6 installation program.
  (I)nstall, (U)pgrade or (S)hell? <b>i</b>
</pre></td></tr></table>

<p>
Avec cela, nous atteignons notre première question. Vous avez ces trois 
options affichées :
<ul>
<li><b>Install :</b> Charge OpenBSD dans le système, remplaçant un
    éventuel autre système se trouvant là. Notez qu'il est possible
    de laisser certaines partitions intactes dans cette procédure, comme
    <tt>/home</tt>, mais dans les autres cas, considérez que tout le
    reste sera écrasé.
<li><b>Upgrade :</b> Installer un nouveau paquetage de <a
    href="#FilesNeeded">fichiers d'installation</a>
    sur cette machine, mais ne remplacer aucune information
    de configuration, donnée utilisateur ou programme additionnel. Aucun
    formatage de disque n'est réalisé, ni le dossier <tt>/etc</tt> ni
    <tt>/var</tt> ne sont remplacés.
    Quelques remarques importantes :
    <ul>
    <li> Vous n'aurez pas la possibilité d'installer le paquetage
    <tt>etc45.tgz</tt>.
    Après l'installation, vous devrez
    <a href="../upgrade46.html#etcUpdates">manuellement greffer</a>
    <tt>etc46.tgz</tt> sur votre système avant qu'il puisse être complètement 
    fonctionnel.
    C'est une étape importante qui doit être réalisée, car dans le cas
    contraire certains services clés (tel que
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">pf(4)</a>)
    ne démarreront pas.

<li>
La procédure de mise à jour n'est pas faite pour sauter des "releases" !
Bien que ce saut fonctionnera souvent, il n'est pas supporté.
Pour OpenBSD 4.6, mettre à jour de la version 4.5 à la version 4.6 est la
seule mise à jour supportée.
Si vous mettez à jour depuis une version plus vieille, il est fortement
recommandé de mettre à jour en versions intermédiaires d'abord.
Cependant, si votre version est très ancienne, une réinstallation
complète est recommandée.

</ul>
<!-- XXXversion -->
Plus d'informations concernant la mise à jour d'une version à une autre
se trouvent dans le <a href="../upgrade46.html">Guide de mise à niveau
d'OpenBSD 4.6</a>.

<li><b>Shell :</b> Parfois, vous devez réaliser des réparations ou de
la maintenance sur un système qui ne pourra pas (ou ne devra pas) démarrer
un noyau normal.
Cette option vous permettra cette maintenance sur le système.
Un certain nombre d'utilitaires importants sont présents sur le media de
démarrage.
</ul>

Nous considérons que vous avez choisi "(I)nstall" ici.

<a name="InstQuestions"></a>
<h3>4.5.2 - Questions lors de l'installation</h3>

Maintenant nous allons voir les questions qui vont définir comment votre
système va être configurer.
Vous pouvez remarquer que dans la plupart des cas, toutes les questions sont
d'abord posées, puis l'installation se déroule.
Si vous possédez un ordinateur lent ou une connexion Internet lente, vous
pouvez répondre à ces questions, sortir, revenir plus tard et seulement
redémarrer votre ordinateur pour finaliser l'installation.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  At any prompt except password prompts you can escape to a shell by
  typing '!'. Default answers are shown in []'s and are selected by
  pressing RETURN.  You can exit this program at any time by pressing
  Control-C, but this can leave your system in an inconsistent state.

  Terminal type: [vt220] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Dans la plupart des cas, le type de terminal par défaut est approprié ;
cependant si vous utilisez une <a href="faq7.html#SerCon">console
série</a> pour l'installation, ne prenez pas l'option par défaut,
répondez de manière appropriée.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  System hostname? (short form, e.g. 'foo') <i><b>puffy</b></i>
</pre></td></tr></table>

<p>
Cette valeur, de même que le nom de domaine DNS (spécifié 
<a href="#MoreNetwork">plus loin</a>), sera sauvegardé dans le fichier
<tt>/etc/myname</tt>, qui sera utilisé durant le démarrage normal pour
configurer le nom d'hôte du système.
Si vous ne configurez pas le nom de domaine du système, la valeur par défaut
'my.domain' sera utilisée.

<p> 
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available network interfaces are: fxp0 vlan0.
  Which one do you wish to configure? (or 'done') [fxp0] <i><b>Enter</b></i>
</pre></td></tr></table>

<p>
<tt>vlan0</tt> est l'interface virtuelle VLAN.
Pour nos besoins ici, nous allons ignorer cette option et rester avec les
interfaces physiques.
Si vous avez plusieurs interfaces physiques, elles seront affichées ici.
Il faut remarquer qu'elles sont identifiées par le nom de leur
pilote, pas par un périphérique générique Ethernet. 
Dans notre cas, "<tt>fxp0</tt>" fait référence au premier périphérique
utilisant le pilote
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fxp&amp;sektion=4">fxp(4)</a>,
<tt>fxp1</tt> sera le second périphérique, etc...
Plus sur le nommage des périphériques dans la <a href="faq6.html#Setup.if">FAQ 6</a>.

<p>
Aprés avoir sélectionner le périphérique que vous voulez configurer, vous
allez maintenant le configurer.
Dans la plupart des cas, vous voudrez le configurer en utilisant DHCP :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IPv4 address for fxp0? (or 'dhcp' or 'none') [dhcp] <b><i>Enter</i></b>
  Issuing hostname-associated DHCP request for fxp0.
  DHCPDISCOVER on fxp0 to 255.255.255.255 port 67 interval 1
  DHCPOFFER from 192.168.1.250 (08:00:20:94:0b:c8)
  DHCPREQUEST on fxp0 to 255.255.255.255 port 67
  DHCPACK from 192.168.1.250 (08:00:20:94:0b:c8)
  bound to 192.168.1.199 -- renewal in 43200 seconds.
</pre></td></tr></table>

<p>
DHCP va configurer l'adresse IP, le masque du sous-réseau, la passerelle par
défaut, le nom de domaine DNS et les serveurs DNS.
Si vous n'utilisez pas DHCP, vous devrez spécifier toutes ces choses
manuellement; voir le sujet plus détaillé
<a href="#MoreNetwork">plus loin</a>.
<a name="backMoreNetwork"></a>

<p>
Si vous avez une configuration IPv6 à faire ou si il y a une autre interface
à configurer (ou si vous n'aimez pas comment vous venez de configurer
précédemment), vous pouvez le faire maintenant, mais dans notre cas, nous
avons terminé :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  IPv6 address for fxp0? (or 'rtsol' or 'none') [none] <b><i>Enter</i></b>
  Available network interfaces are: fxp0 vlan0.
  Which one do you wish to configure? (or 'done') [done] <b><i>Enter</i></b>
  Using DNS domainname in.nickh.org
  Using DNS nameservers at 192.168.1.252
  Do you want to do any manual network configuration? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Si vous avez répondu "yes" à la question "manual network configuration",
vous vous retrouverez devant une invite shell, ou vous pourrez configurer
tout ce que nécessite votre configuration, pouis tapez "exit" pour retourner
au programme d'installation.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Password for root account? (will not echo) <i>PaSsWoRd</i>
  Password for root account? (again) <i>PaSsWoRd</i>
</pre></td></tr></table>


<p>
Utilisez un mot de passe fort pour le compte root, rappelez-vous : sur
Internet, ils SONT là pour pénétrer dans votre ordinateur, ils essayeront 
des mots de passe que la plupart des gens trouvent intelligents.

<p>
Nous vous laisserons plus tard une chance de créer un compte administrateur
et de désactiver l'accés distant (SSH) sur le compte root, mais vous avez
quand même besoin d'un bon mot de passe pour le compte root.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Start sshd(8) by default? [yes] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Habituellement, vous voudrez que sshd(8) fonctionne, mais occasionnelement
pas. Si votre application n'a pas besoin de sshd(8), il y a un petit
avantage de sécurité de ne pas le faire fonctionner.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Start ntpd(8) by default? [no] <b>y</b>
  NTP server? (hostname or 'default') [default] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Vous avez ici la possibilite de faire fonctionner 
<a href="faq6.html#OpenNTPD">OpenNTPD</a>, l'implémentation OpenBSD de NTP.
OpenNTPD a trés peu d'impact et permet d'avoir votre horloge d'ordinateur
synchronisée avec précision.
La configuration par défaut, utilisant
<a href="http://www.pool.ntp.org">pool.ntp.org</a>, utilise un grand nombre
de serveurs de temps ouverts dans le monde.

<p>
Une raison ou vous NE voudrez pas faire fonctionner ntpd(8) et si vous
utilisez un système dual-boot avec un autre OS qui n'utilise pas une horloge
matérielle configurée en GMT, et vous ne voulez pas qu'OpenBSD modifie le
temps pour votre autre OS.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you expect to run the X Window System? [yes] <b><i>Enter</i></b>
  Do you want the X Window System to be started by xdm(1)? [no] <b>y</b>
</pre></td></tr></table>
  
<p>
Toutes les plateformes ne vous poseront pas la question si vous voulez
utiliser X, celles qui ne demandent pas que sysctl configure l'utilisation
de X.
Répondez "y" ici modifiera <tt>/etc/sysctl.conf</tt> pour ajouter la ligne
<tt>machdep.allowaperture=1</tt> ou
<tt>machdep.allowaperture=2</tt>, cel depend de votre plateforme.

<p>
Si vous n'avez pas l'intention d'utiliser X sur votre système ou vous n'êtes
pas sur, répondez 'N' ici, vous pourrez facilement le modifier en éditant 
<tt>/etc/sysctl.conf</tt> et redémarrant, en fonction de vos besoins futurs.
Il y a un avantage de sécurité possible en laissant le pilote d'ouverture
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=xf86&amp;sektion=4">xf86(4)</a>
désactivé, car le moteur graphique sur les cartes vidéos modernes peut être
utilisé potentiellement pour modifier la mémoire au dela du contrôle du
processeur.
Il faut remarquer que les applications non-graphiques qui nécessitent les
librairies et utilitaires X pour fonctionner n'ont PAS besoin de ce sysctl
configuré.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Change the default console to com0? [no] <b><i>Enter</i></b>
</pre></td></tr></table>

Si vous désirez configurer une console série plutôt que votre système par
défaut (habituellement un clavier et écran), c'est votre chance.
Si vous modifiez le défaut par "y", on vous demandera de configurer la
vitesse.
Il faut remarquer que pour les consoles séries, plus vite n'est pas toujours
le meilleur choix, utiliser le paramétre par défaut de votre plateforme et
souvent hautement recommandé.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Setup a user? (enter a lower-case loginname, or 'no') [no] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Vous avez ici l'opportunité de créer un utilisateur AUTRE que root pour la
maintenance du système.
Cette utilisateur sera membre du groupe "wheel" donc vous pourrez utiliser 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=su&amp;sektion=1">su(1)</a>
et on vous demandera un mot de passe.

<p>
Il faut remarquer que si vous voulez créer l'utilisateur, entrez le nom de
l'utilisateur, pas "y" ou "yes".

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  What timezone are you in? ('?' for list) [Canada/Mountain] <b>US/Michigan</b>
</pre></td></tr></table>

<p>
OpenBSD considére que l'horloge temps réel de votre ordinateur est
configurée en GMT, mais vous devez aussi spécifier dans quel fuseau horaire
vous êtes.
Il puut y avoir plusieurs réponses valides pour votre localisation physique.
En tapant "?" à l'invite vous serez guidé pour trouver un nom de fuseau
horaire valide.

<p>
Il faut remarquer que l'installateur devinera souvent correctement votre
fuseau horaire, et vous n'aurez juste qu'a taper "Enter".

<p>
Plus d'informations sur la configuration du fuseau horaire <a href="#MoreTimeZone">ici</a>.  
<a name="backMoreTimeZone"></a>

<a name="InstDisks"></a>
<h3>4.5.3 - Configurer les disques</h3>

<i><b>Remarque importante :</b>
Les utilisateurs avec de gros disques durs (plus gros que ce qui était
disponible normalement quand votre ordinateur a été fabriqué) voudront voir
<a href="faq14.html#LargeDrive">cette section</a> avant d'aller plus
loin.</i>

<p>
Configurer votre disque de maniére appropriée et probablement la partie la
plus compliquée de l'installation de OpenBSD.

<p>
Configurer les disques sous OpenBSD varie un peu en fonction des
plateformes.
Pour <a href="../../fr/i386.html">i386</a>, <a href="../../fr/amd64.html">amd64</a>,
<a href="../../fr/macppc.html">macppc</a>, <a href="../../fr/zaurus.html">zaurus</a>
et <a href="../../fr/armish.html">armish</a>,
la configuration du disque est réalisée en deux étapes.
En premier, la partition OpenBSD sur le disque dur est définie en utilisant
fdisk(8), puis cette partition est subdivisée en partitions OpenBSD en
utilisant disklabel(8).

<p>
Certains utilisateurs seront un peu confus avec la terminologie utilisée
ici. Il apparait que nous utilisons le mot "partition" de deux façons
différentes. Cette observation est correcte.
Il y a deux niveaux de partitionnement dans les plateformes OpenBSD
suivantes, le premier, celui qui peut-être considéré comme le
partitionnement du système d'exploitation, qui est la façon dont plusieurs
OSs sur un seul ordinateur marquent leur propre espace sur le disque, et le
second qui est celui dont la partition OpenBSD sous-partitionne dans
plusieurs systèmes de fichiers individuels.
La premier niveau est visible comme une partition disque au DOS, Windows et
tous les autres OS qui utilisent ce schéma de disque système, le second
niveau de partitionnement est visible uniquement par OpenBSD et d'autres OSs
qui peuvent directement lire un système de fichiers OpenBSD.

<p>
Le nouvel installateur d'OpenBSD essaye de vous rendre la tâche plus simple
pour configurer votre disque en ayant une configuration par défaut saine
pour une utilisation "standard". 
Il faut remarquer que beaucoup de personnes voudront continuer à
personnaliser la configuration par défaut, ou utiliser leur propre
configuration disque, mais les nouveaux utilisateurs commenceront surement
avec cette configuration tant qu'ils ne verront pas qu'ils ont des besoins
différents.
Il faut remarquer que la configuration par défaut variera en fonction de la
taille du disque système.

<p>
Pour maintenant, nous allons prendre la configuration par défaut de notre
disque 40G.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available disks are: wd0.
  Which one is the root disk? (or 'done') [wd0]
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 06      0   1   1 -    521 254  63 [          63:     8385867 ] DOS > 32MB
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  Use (W)hole disk or (E)dit the MBR? [whole] <i><b>Enter</b></i>
  Setting OpenBSD MBR partition to whole wd0...done.
</pre></td></tr></table>
Il faut remarquer que ce disque posséde une partition pré-existante -- <i>en
utilisant "whole" cela la supprimera du disque !</i>.

<p>
Configurer le disque "whole" pour OpenBSD fait plusieurs choses importantes :
<ul>
<li>Supprimer toutes les partitions existantes sur le disque
<li>Créer un MBR et une signature disque pour rendre le disque démarrable
<li>Créer une partition OpenBSD en utilisant tout le disque
<li>Configurer la partition comme "active".
</ul>

Il y a plusieurs raisons pour lesquelles vous ne voudrez pas faire cela,
incluant :
<ul>
<li>Vous désirez garder d'autres partitions d'OS
<li>Vous désirez conserver "setup", "suspend to disk", ou d'autres
partitions systèmes
<li>Vous désirez avoir un système <a href="#Multibooting">multi-boot</a>
</ul>

Il faut remarquer qu'il est critique qu'un nouveau (ou jamais utilisé pour
démarrer) disque posséde un MBR valide, une signature valide, une partition
OpenBSD et une partition marquée comme "active".
Si vous ne faite pas ces choses en utilisant l'option "Use whole disk", vous
devrez être sur que c'est réalisé manuellement.

<p>
Plus d'informations sur le partitionnement avec fdisk de votre disque
<a href="#Morefdisk">plus loin</a>.
<a name="BackMorefdisk"></a>

<p>
Maintenant nous allons casser notre partition fdisk OpenBSD en partitions
disque OpenBSD en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a> :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Setting OpenBSD MBR partition to whole wd0...done.
  The auto-allocated layout for wd0 is:
  #                size           offset  fstype [fsize bsize  cpg]
    a:          1024.0M               63  4.2BSD   2048 16384    1 # /
    b:           127.2M          2097215    swap
    c:         39205.7M                0  unused
    d:          2729.1M          2357679  4.2BSD   2048 16384    1 # /tmp
    e:          4223.2M          7946823  4.2BSD   2048 16384    1 # /var
    f:          1252.3M         16595895  4.2BSD   2048 16384    1 # /usr
    g:          1024.0M         19160541  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          3678.7M         21257693  4.2BSD   2048 16384    1 # /usr/local
    i:          2002.4M         28791612  4.2BSD   2048 16384    1 # /usr/src
    j:          2002.4M         32892533  4.2BSD   2048 16384    1 # /usr/obj
    k:         21142.3M         36993454  4.2BSD   2048 16384    1 # /home
  Use (A)uto layout, (E)dit auto layout, or create (C)ustom layout? [a] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
L'installateur nous présente ce qu'il propose comme "Auto layout" pour les
partitions OpenBSD sur notre disque, ce que nous allons accepter.

<p>
Si la configuration proposée n'est pas appropriée à vos besoins, vous
pouvez, bien sur, l'éditer ou la personnaliser complétement, plus de détails
sur le partitionnement disklabel <a href="#Moredisklabel">plus loin</a>.
<a name="BackMoredisklabel"></a>

<p>
<p>REMARQUE pour les re-installations :</b>
Le nouvel installateur ne supprimera pas votre ancien disklabel si vous
choississez "(C)ustom Layout", mais vous devrez re-spécifier chaque point de
montage en utilisant l'option 'm' de disklabel(8). 

<p>
Le nouvel installateur crée maintenant ces partitions et crée les systèmes
de fichiers dessus en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newfs&amp;sektion=8">newfs(8)</a>,
et les montent pour installation :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  /dev/rwd0a: 1024.0MB in 2097152 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0k: 21142.3MB in 43299416 sectors of 512 bytes
  105 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0d: 2729.1MB in 5589144 sectors of 512 bytes
  14 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0f: 1252.3MB in 2564644 sectors of 512 bytes
  7 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0g: 1024.0MB in 2097152 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0h: 3678.7MB in 7533916 sectors of 512 bytes
  19 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0j: 2002.4MB in 4100920 sectors of 512 bytes
  10 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0i: 2002.4MB in 4100920 sectors of 512 bytes
  10 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0e: 4223.2MB in 8649072 sectors of 512 bytes
  21 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/wd0a on /mnt type ffs (rw, asynchronous, local)
  /dev/wd0k on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0d on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0f on /mnt/usr type ffs (rw, asynchronous, local, nodev)
  /dev/wd0g on /mnt/usr/X11R6 type ffs (rw, asynchronous, local, nodev)
  /dev/wd0h on /mnt/usr/local type ffs (rw, asynchronous, local, nodev)
  /dev/wd0j on /mnt/usr/obj type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0i on /mnt/usr/src type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0e on /mnt/var type ffs (rw, asynchronous, local, nodev, nosuid)
</pre></td></tr></table>

<p>
Vous remarquerez qu'il y a une partition <i>c</c> qui semble avoir été
ignoré. Cette partition est l'ensemble de votre disque dur; ne tentez pas de
la modifier.

<a name="InstMedia"></a>
<h3>4.5.4 - Choisir le média d'installation et les sets de fichiers</h3>

Ensuite, vous allez avoir une chance de choisir votre média d'installation.
Dans notre cas, nous allons installer d'un serveur FTP.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Location of sets? (cd disk ftp http or 'done') [ftp] <b><i>Enter</i></b>
  HTTP/FTP proxy URL? (e.g. 'http://proxy:8080', or 'none') [none]
<b><i>Enter</i></b>
  Server? (hostname, list#, 'done' or '?') [mirror.example.org] <b>obsd.cec.mtu.edu</b>
</pre></td></tr></table>
<p>
Si vous ne vous souvenez pas de la localisation de votre miroir préféré (ou
plus !), l'installateur sera souvent capable de vous fournir un miroir par
défaut qui sera adapté à votre situation.
Sinon, tapez "?" pour l'affichage d'une liste des miroirs, et sélectionner
le numéro du miroir qui vous convient.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Server directory? [pub/OpenBSD/4.6/i386] <b><i>Enter</i></b>
  Login? [anonymous] <b><i>Enter</i></b>
</pre></td></tr></table>

Les miroirs FTP publiques supportent tous le téléchargement anonyme, bien
évidemment, mais vous pouvez avoir un serveur local qui nécessite un login
et un mot de passe.
 
<p>
Vous pouvez maintenant ajuster la liste des <a href="#Filesets">sets de
fichiers</a>.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Select sets by entering a set name, a file name pattern or 'all'. De-select
  sets by prepending a '-' to the set name, file name pattern or 'all'. Selected
  sets are labelled '[X]'.
      [X] bsd           [X] etc46.tgz     [X] game46.tgz    [X] xfont46.tgz
      [X] bsd.rd        [X] misc46.tgz    [X] xbase46.tgz   [X] xserv46.tgz
      [ ] bsd.mp        [X] comp46.tgz    [X] xetc46.tgz
      [X] base46.tgz    [X] man46.tgz     [X] xshare46.tgz
  Set name(s)? (or 'abort' or 'done') [done] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Au minimum, vous avez besoin d'un noyau (<tt>bsd</tt>), le set de fichiers
base46.tgz et etc46.tgz. 
A moins que vous ne sachiez ce que vous faites, gardez les sets par défaut.
Vous pouvez ajouter ou supprimer les sets de fichiers en utilisant les
caractéres "+" et "-" devant le nom du set, et aussi utiliser les wildcards :
<ul>
<li><tt><b>-comp46.tgz</b></tt> supprime <tt>comp46.tgz</tt>
<li><tt><b>+bsd.mp</b></tt> ajoute bsd.mp
<li><tt><b>-x*</b></tt> supprime tous les composants X
</ul>

Mais encore un fois, on va prendre par défaut.
Cette machine est un système mono-processeur, donc bsd.mp n'est pas
installé, mais tout le reste l'est.
Si il devait être mise à jour plus tard pour un système multi-processeurs,
vous préférerez installez bsd.mp bien évidemment. 

<p>
Et maintenant nous démarrons notre installation !
C'est à ce moment la ou  vous pouvez revenir plus tard si vous avez un
ordinateur ou une connextion Internet lente, pensez qu'avoir un ordinateur
rapide et les fichiers en local, ce processus ne prend que quelques minutes
ou moins !

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  bsd          100% |*************************************|  7063 KB 00:04
  bsd.rd       100% |*************************************|  5913 KB 00:03
  base46.tgz   100% |*************************************| 47315 KB 01:46
  etc46.tgz    100% |*************************************|   503 KB 00:01
  misc46.tgz   100% |*************************************|  2867 KB 00:06
  comp46.tgz   100% |*************************************| 88555 KB 03:08
  man46.tgz    100% |*************************************|  8047 KB 00:21
  game46.tgz   100% |*************************************|  2558 KB 00:04
  xbase46.tgz  100% |*************************************| 10160 KB 00:21
  xetc46.tgz   100% |*************************************| 69166    00:00
  xshare46.tgz 100% |*************************************|  2861 KB 00:12
  xfont46.tgz  100% |*************************************| 34745 KB 00:57
  xserv46.tgz  100% |*************************************| 19789 KB 00:39
  Location of sets? (cd disk ftp http or 'done') [done] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Une fois de plus, nous avons choisi par défaut, nous en avons fini avec
l'installation des fichiers.

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Saving configuration files...done.
  Generating initial host.random file...done.
  Making all device nodes...done.

  CONGRATULATIONS! Your OpenBSD install has been successfully completed!
  To boot the new system, enter 'reboot' at the command prompt.
  When you login to your new system the first time, please read your mail
  using the 'mail' command.

  #
</pre></td></tr></table>

<a name="Inst1stBoot"></a>
<h3>4.5.5 - Premier démarrage !</h3>
OpenBSD est maintenant installé sur votre système et prêt pour son premier
démarrage, mais avant il faut...

<p>
<h4>Avant de redémarrer</h4>
A cet instant, votre système est installé et prêt à être redémarré et
configuré pour le service. Avant cela, cependant, il serait prudent de
regarder la <a href="../../fr/errata.html">page Errata</a> pour voir si il y
a des bogues qui vous impacterez dans l'immédiat.

<p>
Une astuce que vous pouvez utiliser pour certaines configurations "avant le
premier démarrage" est d'executer :
<pre>
    # <b>/mnt/usr/sbin/chroot /mnt</b>
</pre>
à l'invite du shell.
Cela configurera vos points de montage à ce qu'ils seraient sur un
redémarrage normal de votre nouveau système installé.
Vous pouvez maintenant faire quelques configurations basiques du système,
comme ajouter des utilisateurs, changer les points de montage, etc...

<h4>Aprés le redémarrage</h4>  

Au premier démarrage, les clés <a href="http://www.openssh.com">SSH</a>
seront générées.
Sur un ordinateur moderne, cela ne prendra que quelques secondes, vous ne le
remarquerez même pas.
Sur des systèmes plus anciens, cela peut prendre quelques minutes, même
potentiellement une heure ou plus sur des systèmes trés lents.

<p>
Une des premières chose à lire aprés avoir installé votre système est
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8">afterboot(8)</a>.

<p>
Vous trouvez aussi utile les liens suivants :
<ul>
<li><a href="faq10.html#AddDelUser">Ajoutez des utilisateurs dans OpenBSD</a>
<li><a href="faq6.html#Setup">Configuration réseau initiale</a>
<li><a href="faq2.html#ManPages">Pages Man des commandes utiles/populaires</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi">Pages man OpenBSD sur
  le Web</a>
<li><a href="faq15.html">Le système de paquetages et ports OpenBSD pour
  installer un logiciel</a>
</ul>

<a name="InstFinish"></a>
<h3>4.5.6 - Une derniére chose...</h3> 

Les développeurs OpenBSD vous demande <a href="#SendDmesg">d'envoyer une
copie de votre dmesg</a>.
C'est trés apprécier par les développeurs, et finalement, tous les utilisateurs.


<a name="More"></a>
<h2>4.6 - Détails pour une installation plus complexe</h2>
Parfois vous ne pouvez pas juste utiliser la configuration par défaut.
Vous trouverez ici plus de détails sur certaines parties du processus
d'installation.

<a name="MoreNetwork"></a>
<h3>4.6.1 - Configurer le réseau</h3>

Si vous n'avez pas de serveur DHCP disponible, vous devrez configurer votre
adaptateur(s) réseau manuellement.
Voici un exemple :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Which one do you wish to configure? (or 'done') [xl0] <b><i>Enter</i></b>
  IPv4 address for xl0? (or 'dhcp' or 'none') [dhcp] <b>192.168.1.37</b>
  Netmask? [255.255.255.0] 255.255.254.0
  IPv6 address for xl0? (or 'rtsol' or 'none') [none] <b><i>Enter</i></b>
</pre></td></tr></table>

<p>
Aprés cet ensemble de questions, vous aurez la possibilité de configurer
d'autres adaptateurs réseaux si cette machine en posséde.
Si vous spécifiez un autre adaptateur réseau ici, les questions précédentes
se répéteront.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available network interfaces are: xl0 vlan0.
  Which one do you wish to configure? (or 'done') [done]
</pre></td></tr></table>

<p>
Maintenant vous allez configurer la passerelle par défaut et les serveurs
DNS, choses qui impactent tous les adaptateurs réseaux :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Default IPv4 route? (IPv4 address, 'dhcp' or 'none') <b>192.168.1.1</b>
  add net default: gateway 192.168.1.1
  DNS domain name? (e.g. 'bar.com') [my.domain] <b>example.org</b>
  DNS nameservers? (IP address list or 'none') [none] <b>192.168.1.250 192.168.1.251</b>
</pre></td></tr></table>

<p>
Il faut remarquer que plusieurs serveurs DNS peuvent être indiqués, séparés
par des espaces.

<p>
Quelquefois, vous devez faire des choses en plus, par exemple configurer
une clé d'accés sans-fil ou configurer en dur une vitesse ou un duplex (ne
faite cela que si c'est ABSOLUMENT nécessaire, corriger la configuration de
votre commutateur est une bien meilleure idée !).

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you want to do any manual network configuration? [no] <b>y</b>
  Type 'exit' to return to install.
  # <b>ifconfig xl0 media</b>
  xl0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
          lladdr 00:08:74:2c:df:9c
          groups: egress
          media: Ethernet autoselect (100baseTX full-duplex)
          status: active
          supported media:
                  media 10baseT
                  media 10baseT mediaopt full-duplex
                  media 100baseTX
                  media 100baseTX mediaopt full-duplex
                  media autoselect
          inet 192.168.1.37 netmask 0xfffffe00 broadcast 192.168.1.255
  # <b>ifconfig xl0 media 100baseTX mediaopt full-duplex</b>
  # <b>ifconfig xl0</b>
  xl0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
          lladdr 00:08:74:2c:df:9c
          groups: egress
          media: Ethernet 100baseTX full-duplex
          status: active
          inet6 fe80::208:74ff:fe2c:df9c%xl0 prefixlen 64 scopeid 0x1
          inet 192.168.1.37 netmask 0xfffffe00 broadcast 192.168.1.255
  # <b>exit</b>
<i>...setup resumes...</i>
</pre></td></tr></table>

<p>
<a href="#backMoreNetwork">(revenir là où on aurait pu)</a>

<a name="MoreTimeZone"></a>
<h3>4.6.2 - Configurer le fuseau horaire</h3>
Le temps dans Unix n'est pas une chose simple (ou d'une autre façon, le
temps dans Unix est une chose <i>trés</i> simple, le temps humain est un
désordre politiquement manipulé).
Les fichiers de fuseau horaire aident le système à convertir le temps Unix
(le nombre de secondes aprés minuit GMT, 1 Janvier 1970) en temps humain,
prenant en compte des choses comme les fuseaux horaires, l'heure avancée
(DST), les changements de régles DST, etc...
Ils incluent aussi l'historique des changements.

<p>
Plusieurs fichiers de définitions de fuseaux horaires peuvent parfois
fournir le même temps <i>courant</i>, mais peuvent avoir des histoires historiques
différentes.
Par exemple, EST5EDT et US/Michigan possédent le même temps MAINTENANT, mais
en retournant en 1975, les régles étaient différentes, donc si vous faites
des calculs avec des dates et le temps en 1975, vous devrez faire attention
aux différences.
Vous devez utiliser le fichier de fuseau horaire le plus spécifique et se
rapprochant le plus de votre région, plutôt que celui qui vous donnera un
temps correct à l'instant donné. 

<p>
L'installateur d'OpenBSD vous aidera à trouver de maniére appropriée le
fichier de fuseau horaire pour vous si vous n'êtes pas sur.
Tapez simplement "<tt>?</tt>" à chaque invite, et l'installateur vous
affichera les options.
Si le premier niveau de réponses ne vous convient pas, sélectionnez un
continent ou un pays, et regardez vos options :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  What timezone are you in? ('?' for list) [right/EST5EDT] <b>?</b>
  Africa/      Chile/       GB-Eire      Israel       NZ-CHAT      UCT
  America/     Cuba         GMT          Jamaica      Navajo       US/
  Antarctica/  EET          GMT+0        Japan        PRC          UTC
  Arctic/      EST          GMT-0        Kwajalein    PST8PDT      Universal
  Asia/        EST5EDT      GMT0         Libya        Pacific/     W-SU
  Atlantic/    Egypt        Greenwich    MET          Poland       WET
  Australia/   Eire         HST          MST          Portugal     Zulu
  Brazil/      Etc/         Hongkong     MST7MDT      ROC          posix/
  CET          Europe/      Iceland      Mexico/      ROK          posixrules
  CST6CDT      Factory      Indian/      Mideast/     Singapore    right/
  Canada/      GB           Iran         NZ           Turkey
  What timezone are you in? ('?' for list) [right/EST5EDT] <b>US</b>
  What sub-timezone of 'US' are you in? ('?' for list) ?
  Alaska          Central         Hawaii          Mountain        Samoa
  Aleutian        East-Indiana    Indiana-Starke  Pacific
  Arizona         Eastern         Michigan        Pacific-New
  What sub-timezone of 'US' are you in? ('?' for list) <b>Michigan</b>
</pre></td></tr></table>

<p>
Nous avons maintenant configuré le temps sur "US/Michigan". Cela créera un
lien symbolique dans <tt>/etc</tt> pointant sur le fichier de zoneinfo dans
<tt>/usr/share/zoneinfo</tt>, quelque chose comme cela :
<blockquote><pre>
  /etc/localtime -> /usr/share/zoneinfo/US/Michigan
</pre></blockquote>

Remarquez le répertoire "<tt>right/</tt>", ce répertoire inclut des
ajustements de bond en seconde, mais duplique aussi le choix de zoneinfo
standard.
Plus <a href="faq8.html#NTPerror">ici</a>.

<p>
<a href="#backMoreTimeZone">(revenir là où on aurait pu)</a>

<a name="Morefdisk"></a>
<h3>4.6.3 - Personnaliser la configuration via fdisk(8)</h3>

Remarque : seulement certaines plateformes utilisent uniquement fdisk, et
d'habitude, seulement les utilisateurs de
<a href="../../fr/i386.html">i386</a> et <a href="../../fr/amd64.html">amd64</a>
devront craindre faire des fantaisies avec fdisk.
Les utilisateurs de la plupart des plateformes utilisant fdisk(8) ne seront
généralement pas ennuyés avec le multiboot ou la configuration/diagnostic de
partitions.
Pour cette raison, cette partie est dédié au i386 et amd64.

<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8">fdisk(8)</a> 
est utilisé pour délimiter la partie OpenBSD sur votre disque dur.
Il aide à délimiter la partie du disque utilisée par OpenBSD des parties
utilisées par d'autres OSs ou fonctions systèmes.

<p>
Si vous avez une partition sur votre disque que vous voulez garder ou garder
de l'espace libre pour une autre partition, vous ne devez pas choisir
"(W)hole disk", mais vous devrez éditer la table de partition avec
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8">fdisk(8)</a>.
Plus d'informations sur l'utilisation manuelle de fdisk(8) peuvent être
trouvées dans <a href="faq14.html#fdisk">ici</a>.

<b>Avant de travailler sur un système qui posséde des données que vous ne
voulez pas perdre, soyez sur d'avoir une bonne sauvegarde.</b>
Il est trés facile dans ce processus de perdre des données importantes, donc
soyez sur que vous êtes prêt pour revenir en arriére si c'est nécessaire. 

<p>
Si vous ajoutez OpenBSD à un système déjà existant, vous devrez surement
libérer de l'espace avant d'installer OpenBSD.
Cela conduit souvent à supprimer ou réduire la taille de partitions
existantes.
Le programme <a href="http://gparted.sourceforge.net/">gparted</a> nous
semble utile pour réduire la taille de partitions de la plupart des OSs
populaires, permettant d'installer OpenBSD sur l'espace libéré.

<p>
Dans cet exemple, nous considérerons que l'on commence avec un disque de 40G
vierge et que l'on désire installer un système multi-boot, réservant au
début du disque 5G pour Windows et le reste pour OpenBSD.
Il faut remarquer qu'un disque vierge doit avoir un MBR valide dans le code
de démarrage et une signature avant qu'il ne soit démarré.

<p>
Le processus est trés similaire avec une partition déjà existante, vous
devez juste sauter les parties ou l'on crée la partition pour Windows et
l'inquiétude sur l'installation du code de démarrage MBR.

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Available disks are: wd0.
  Which one is the root disk? (or 'done') [wd0] <b><i>Enter</i></b>
  MBR has invalid signature; not showing it.
</pre></td></tr></table>
SI le disque posséde déjà un MBR valide, il vous montrera la table de
partition existante, ce qui est une bonne façon de savoir si le disque
posséde déjà des données 
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Use (W)hole disk or (E)dit the MBR? [whole] <b>e</b>

  You will now create a single MBR partition to contain your OpenBSD data. This
  partition must have an id of 'A6'; must *NOT* overlap other partitions; and
  must be marked as the only active partition.  Inside the fdisk command, the
  'manual' command describes all the fdisk commands in detail.

  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0x0
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]

  -------------------------------------------------------------------------------
   0: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
Enter 'help' for information
fdisk: 1>
</pre></td></tr></table>

En premier lieu notez l'invite fdisk.
Le chiffre "1" indique le premier niveau des tables de partition -- si vous
éditez une partition étendue, cela sera "2" (ou plus).
Les partitions étendues sont des partitions qui possédent leur propre table
de sous-partition, permettant de contourner la limite de quatre partitions
sur IBM AT.
Les partitions étendues ne seront pas traitées ici. 

<p>
En premier, nous allons faire de la partition"0" une partition de 5G Windows
(utilisant NTFS), et la partition "1" sera notre partition OpenBSD utilisant
le reste du disque.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk: 1> <b>e 0</b>
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]

   -------------------------------------------------------------------------------
   0: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help)
</pre></td></tr></table>

<p>
Comme nous ne savons pas de mémoire l'ID pour une partition NTFS, nous
tapons "?" ici pour obtenir la liste.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>?</b>
  Choose from the following Partition id values:
  00 unused         20 Willowsoft     66 NetWare 386    A9 NetBSD
  01 DOS FAT-12     24 NEC DOS        67 Novell         AB MacOS X boot
  02 XENIX /        27 Win Recovery   68 Novell         AF MacOS X HFS+
  03 XENIX /usr     38 Theos          69 Novell         B7 BSDI filesy*
  04 DOS FAT-16     39 Plan 9         70 DiskSecure     B8 BSDI swap
  05 Extended DOS   40 VENIX 286      75 PCIX           BF Solaris
  06 DOS > 32MB     41 Lin/Minux DR   80 Minix (old)    C0 CTOS
  07 NTFS           42 LinuxSwap DR   81 Minix (new)    C1 DRDOSs FAT12
  08 AIX fs         43 Linux DR       82 Linux swap     C4 DRDOSs < 32M
  09 AIX/Coherent   4D QNX 4.2 Pri    83 Linux files*   C6 DRDOSs >=32M
  0A OS/2 Bootmgr   4E QNX 4.2 Sec    84 OS/2 hidden    C7 HPFS Disbled
  0B Win95 FAT-32   4F QNX 4.2 Ter    85 Linux ext.     DB CPM/C.DOS/C*
  0C Win95 FAT32L   50 DM             86 NT FAT VS      DE Dell Maint
  0E DOS FAT-16     51 DM             87 NTFS VS        E1 SpeedStor
  0F Extended LBA   52 CP/M or SysV   8E Linux LVM      E3 SpeedStor
  10 OPUS           53 DM             93 Amoeba FS      E4 SpeedStor
  11 OS/2 hidden    54 Ontrack        94 Amoeba BBT     EB BeOS/i386
  12 Compaq Diag.   55 EZ-Drive       99 Mylex          EE EFI GPT
  14 OS/2 hidden    56 Golden Bow     9F BSDI           EF EFI Sys
  16 OS/2 hidden    5C Priam          A0 NotebookSave   F1 SpeedStor
  17 OS/2 hidden    61 SpeedStor      A5 FreeBSD        F2 DOS 3.3+ Sec
  18 AST swap       63 ISC, HURD, *   A6 OpenBSD        F4 SpeedStor
  19 Willowtech     64 NetWare 2.xx   A7 NEXTSTEP       FF Xenix BBT
  1C ThinkPad Rec   65 NetWare 3.xx   A8 MacOS X
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>07</b>
</pre></td></tr></table>

<p>
Maintenant on définit ces points de début et fin :
<p>

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Do you wish to edit in CHS mode? [n]
</pre></td></tr></table>

<p>
Le mode CHS vous permet de spécifier la taille du disque en cylindres, têtes
et secteurs. Gardez en mémoire que sur les disques modernes, les numéros CHS
sont complétements faux, juste trois nombres qui traduisent en secteurs sur
le disque, qui est traduit sur la géométrie physique de votre disque (qui
varie surement à travers le disque de toute façon).

<p>
Si vous répondez "y" ici, on vous demandera le début et la fin du cylindre,
tête secteur.
Si vous répondez "no" ici (comme nous allons le faire), on vous demandera le
secteur de démarrage et la taille.
Editer par CHS est quelquefois plus simple pour travailler sur une partition
existante, le secteur de démarrage et la taille sont souvent plus simple
quand vous voulez créer rapidement une partition d'une certaine taille.

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  offset: [0] <b>63</b>
</pre></td></tr></table>

<a name="trackoffset"></a>
<p>
Les plateformes fdisk ont besoin que la premiére partition commence aprés la
première piste du disque. Une piste est un nombre de secteurs "secteur par piste"
, le dernier des nombres de "geometry:".
Il est facile de prendre l'habitude de taper "63" ici, comme c'est courant
sur les disques IDE et SATA modernes, mais tous les disques n'utilisent pas
cette taille de piste, les exceptions courantes modernes sont les disques
SCSI et Flash.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  size: [0] <b>5g</b>
  Rounding to nearest cylinder: 10490382
</pre></td></tr></table>

La valeur de "Size" peut être le nombre de secteurs (512 octets chacuns), ou
la capacité désirée suivie par un "k", "m" ou "g".
Quand on édite en utilisant la taille et l'offset, fdisk arrondira votre
partition pour que cela se termine sur la limite d'un cylindre (OpenBSD 
ne se soucie pas de cela, et il est possible qu'aucun système d'exploitation
moderne ne se soucis à ce sujet, mais certains peuvent en avoir à un moment).  

<p>
Maintenant, regardons notre nouvelle partition :
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> p
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0x0
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 07      0   1   1 -    652 254  63 [          63:    10490382 ] NTFS
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

Remarquez que l'invite inclut maintenant un "*", cela signifie qu'il y a des
modifications non sauvegardées.

<p>
Nous avons maintenant créer notre partition Windows.
Remarquez que cette partition réserve juste de l'espace sur le disque, elle
n'est pas formatée; aucun système de fichiers n'existe ici.
Vous vous inquiéterez de cela quand vous installerez Windows; nous avons
accompli notre but en reservant de l'espace pour qu'une partition Windows
soit crée plus tard.

<p>
Maintenant nous créons notre partition OpenBSD.
Dans notre cas, l'ID de la partition sera "A6".

<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> e 1
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  Partition id ('0' to disable)  [0 - FF]: [0] (? for help) <b>a6</b>
  Do you wish to edit in CHS mode? [n] <b><i>Enter</i></b>
  offset: [0]
</pre></td></tr></table>

uh-oh !
Quel est notre offset ? Simple -- l'offset de la partition précédente plus
la taille de la partition, dans notre cas, 63+10490382 = 10490445.

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  offset: [0] <b>10490445</b>
  size: [0] <b>*</b>
  fdisk:*1>
</pre></td></tr></table>

<p>
Remarquez qu'ici nous avons tapé "*" comme taille, siginifiant "ce qui reste
du disque".
Encore un fois, nous aurions pu entrer la taille en secteurs, "m" ou "g" si
on voulait laisser de l'espace quelque part.

<p>
Maintenant nous allons voir notre table de partition :

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0x0
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
   -------------------------------------------------------------------------------
   0: 07      0   1   1 -    652 254  63 [          63:    10490382 ] NTFS
   1: A6    653   0   1 -   4998   5  63 [    10490445:    69802803 ] OpenBSD
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
<b>CE N'EST PAS ENCORE TERMINE !</b><br>
Ce disque n'est toujours pas démarrable !
Comme c'est un nouveau disque, la 
<a href="faq14.html#Boot386">MBR</a> du disque est complétement vide.
Le message "Signature: 0x0" affiché ici montre qu'il n'y a pas de signature
valide (0xAA55), ce qui indique définitivement un code de démarrage non
valide.
Bien sur, vous pouvez avoir une signature valide sans code de démarrage
valide, à cause d'un manque de chance aléatoire ou de dommage sur le code de
démarrage existant, mais un signature invalide indique bien le plus souvent
un manque de code de démarrage, nous allons donc l'installer maintenant en
utilisant la commande "update" :

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>update</b>
  Machine code updated.
  fdisk:*1>
</pre></td></tr></table>
 
<p>
Nous devons aussi "marquer" la partition comme "active" pour que la ROM de
démarrage sache de quelle partition démarrer :

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>f 1</b>
  Partition 1 marked active.
</pre></td></tr></table>

<p>
Maintenant, regardons à quoi cela ressemble :

<p>
<table border=0 width="650"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  fdisk:*1> <b>p</b>
  Disk: wd0       geometry: 4998/255/63 [80293248 Sectors]
  Offset: 0       Signature: 0xAA55
              Starting         Ending         LBA Info:
   #: id      C   H   S -      C   H   S [       start:        size ]
  -------------------------------------------------------------------------------
   0: 07      0   1   1 -    652 254  63 [          63:    10490382 ] NTFS
  *1: A6    653   0   1 -   4998   5  63 [    10490445:    69802803 ] OpenBSD
   2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
   3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
  fdisk:*1>
</pre></td></tr></table>

<p>
Une checklist des choses que vous voudrez surement faire avant de sortir de
fdisk(8) :

<li>Signature valide ?
<li>Partitions qui ne se recouvrent pas ?
<li>Partition OpenBSD avec un id "A6" ?
<li>Bonne partition (probablement OpenBSD) marquée active?
</ul>

<p>
<a href="#BackMorefdisk">(Revenir là où on aurait pu)</a>


<a name="Moredisklabel"></a>
<h3>4.6.4 - Personnaliser la configuration via disklabel</h3>

Dans une partition OpenBSD fdisk(8), nous utilisons
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8">disklabel(8)</a>
pour créer les partitions de système de fichiers OpenBSD.
OpenBSD marque ces partition de système de fichiers en utilisant seize
lettres, "a" à "p".
La partition "a" sur le disque de démarrage est définie comme partition
racine, "b" est la partition de pagination par défaut.
"c" sur tous les disques est la partition "whole disk", elle est utilisée
par les programmes qui ont un accés direct au disque physique, comme
fdisk(8) et disklabel(8).
La partition "c" est crée automatiquement pour vous, et ne doit pas être
supprimée ou modifiée.
Les lettres restantes sont disponibles pour vous pour définir les points de
montage.
Vous pouvez sauter des lettres, vous pouvez les définir dans n'importe quel
ordre, et peuvent être dans n'importe quel ordre sur le disque (bien que
pour certaines plateformes la partition "a" doit être a un endroit précis).
Vous pouvez aussi laisser des espaces sur le disque qui ne sont pas alloués,
et les allouer plus tard, ou potentiellement agrandir une partition
existante plus tard dans cette espace non alloué en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=growfs&amp;sektion=8">growfs(8)</a>.

<p>
Toutes les partitions qui possédent des partitions FFS natives doivent les
avoir dans la partition OpenBSD fdisk(8), cependant des partitions
<a href="faq14.html#foreignfs">non-OpenBSD</a> peuvent (et normalement
doivent) être en dehors de la partition OpenBSD fdisk(8).

<p>
Plus d'informations sur l'utilisation de disklabel peuvent être trouvées
<a href="faq14.html#disklabel">ici</a>.

<p>
Plus d'informations sur pourquoi le partionnement est une bonne chose et la
stratégie pour un bon plan de partitionnement sont <a href="#Partitioning">plus loin</a>.

<p>
La nouvelle procédure d'installation d'OpenBSD (pour 4.6) essaiera
d'auto-partitionner votre disque de façon utile, en configuration "d'utilisation
générale", basé sur la taille de votre disque.
Si votre disque est assez gros, l'espace inutilisé sera alloué à la
partition <tt>/home</tt>.
Bien que cela soit souvent utile, cela ne satisfait pas tous les besoins des
utilisateurs.

<p>
Pour notre exemple, nous allons considérer que nous allons construire un
serveur web statique utilisé par certains de nos amis.
Nous avons une machine connectée à un connexion Internet modeste, un disque
de 40G, qui est utilisé en grande partie par OpenBSD (avec ma même partition
de 5G utilisée par Windows de l'exemple précédent.
Pourquoi ? Peut-être que ce système posséde un contrôleur RAID qui est
supporté par OpenBSD, mais uniquement configurable sous Windows.
Plus vraisemblablement, parce que l'éditeur de la FAQ n'a pas envie de
maintenir un trop grand nombre d'exemples de systèmes différents).

<p>
Les pages web distribuées par un serveur web sous OpenBSD seront dans
<tt>/var/www</tt>, et trés peu seront stockées dans <tt>/home</tt>, donc
cela indique qu'un changement définitif de la configuration par défaut doit
être effectué.
Pour les besoins du débat, nous considérerons que nous n'avons pas à
reconstruire le système des sources sur cette machine (nous le ferons
ailleurs).
Le système n'utilisera pas X, cependant comme certaines applications web
<a href="#FilesNeededX">ont besoin de X d'être installé</a>, nous aurons X
d'installé.
La machine ne sera pas trop puissante, il n'y aura pas plus de 1G de RAM
dessus, et il est peu probable que notre application en demande plus.

<p>
Donc, aprés un peu de reflexion, notre plan est de partitionner le système
comme cela :
<ul>
<li><tt>/ - root</tt>: 100m.  Cela sera 'a'.
<li><tt>swap</tt>: 1G (donc nous avons toujours assez d'espace pour un core
   dump), cela sera la partition 'b'
<li><tt>/usr</tt>: 2g, partition d
<li><tt>/tmp</tt>: 100m (nous ne l'utiliserons pas beaucoup), partition e
<li><tt>/usr/local</tt>: 2g, partition f
<li><tt>/usr/X11R6</tt>: 1g, partition g
<li><tt>/home</tt>: 1g, partition h
<li><tt>/var</tt>: 1g (beaucoup de fichiers de llog système), partition j
<li><tt>/var/www</tt>: ce qui reste du disque, partition k
</ul>

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  The auto-allocated layout for wd0 is:
  #                size           offset  fstype [fsize bsize  cpg]
    a:          1024.0M         10490445  4.2BSD   2048 16384    1 # /
    b:           252.1M         12587597    swap
    c:         39205.7M                0  unused
    d:          2319.3M         13103933  4.2BSD   2048 16384    1 # /tmp
    e:          3653.9M         17853877  4.2BSD   2048 16384    1 # /var
    f:          1149.8M         25337016  4.2BSD   2048 16384    1 # /usr
    g:          1024.0M         27691862  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          3422.6M         29789014  4.2BSD   2048 16384    1 # /usr/local
    i:          5122.3M               63    NTFS
    j:          1848.7M         36798433  4.2BSD   2048 16384    1 # /usr/src
    k:          1848.7M         40584654  4.2BSD   2048 16384    1 # /usr/obj
    l:         17540.2M         44370875  4.2BSD   2048 16384    1 # /home
  Use (A)uto layout, (E)dit auto layout, or create (C)ustom layout? [a] <b>c</b>
</pre></td></tr></table>

<p>
Si nous avons uniquement des révisions mineures, nous opterons probablement
pour "Edit" la configuration personnalisée plutôt que de démarrer d'un état
vierge, mais nous allons utiliser la méthode difficile dans notre cas.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  You will now create an OpenBSD disklabel inside the OpenBSD MBR
  partition. The disklabel defines how OpenBSD splits up the MBR partition
  into OpenBSD partitions in which filesystems and swap space are created.
  You must provide each filesystem's mountpoint in this program.

  The offsets used in the disklabel are ABSOLUTE, i.e. relative to the
  start of the disk, NOT the start of the OpenBSD MBR partition.

  Label editor (enter '?' for help at any prompt)
  > <b>p</b>
  OpenBSD area: 10490445-80293248; size: 69802803; free: 69802803
  #                size           offset  fstype [fsize bsize  cpg]
    c:         80293248                0  unused
    i:         10490382               63    NTFS
  >
</pre></td></tr></table>

<p>
Remarquez qu'il y a déjà deux partitions ici -- la partition "c" qui est
toujours présente et crée pour vous, mais disklabel(8) a aussi remarqué la
partition NTFS existante et l'a assignée à une partition disklabel qui peut
être potentiellement accédée par OpenBSD (remarque, actuellement, le support
de NTFS est experimental et nécessite un noyau personnalisé mais le support
FAT/FAT32 est aussi bon). 

<p>
Nous allons maintenant créer nos partitions.
Nous allons démarrer avec la partition "a", notre partition racine :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>a a</b>
  offset: [10490445] <b><i>Enter</i></b>
  size: [69802803] <b>100m</b>
  Rounding to cylinder: 208845
  FS type: [4.2BSD]  <b><i>Enter</i></b>
  mount point: [none] <b>/</b>
  >
</pre></td></tr></table>

Remarquez que disklabel est par défaut sur le premier secteur disponible
pour OpenBSD sur le disque, ce qui est ce que l'on veut.
Il est aussi par défaut avec la taille maximale du disque, ce qui n'est PAS
ce que l'on veut.
Ici nous allons le modifier avec nos tailles préférées, ce qui peut-être
spécifié en secteurs, "M" ou "G".

<p>
Vous voudrez surement utiliser le FS par défaut de type "4.2BSD" pour une
partition FFS (Fast File System) ou FFS2, bien qu'il y ai d'autres types
utiles incluant "swap" et "RAID".

<p>
Finalement le point de montage.
Notre partition "a" est la partition racine, par définition.

<p>
Maintenant , nous créeons le swap, qui est notre partition "b" (encore,
c'est une nécessité -- 'b' sur le disque de démarrage est le swap) :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>a b</b>
  offset: [10699290] <b><i>Enter</i></b>
  size: [69593958] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [swap] <b><i>Enter</i></b>
  >
</pre></td></tr></table>

<p>
Encore un fois, disklabel a correctement calculé notre secteur de démarrage,
et nous l'a présenté en suggerant une taille de "entire remaining space", ce
qui encore une fois sera surchargé avec notre choix de taille.
Comme c'est la partition "b", disklabel considére qu'il va être utilisé
comme espace de pagination, et quand nous le confirmerons, il ne nous
demandera pas de point de montage.

<p>
Nous sommes maintenant prés pour créer le reste des partitions.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>a d</b>
  offset: [12803805] <b><i>Enter</i></b>
  size: [67489443] <b>2g</b>
  Rounding to cylinder: 4209030
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr</b>
  > <b>a e</b>
  offset: [17012835] <b><i>Enter</i></b>
  size: [63280413] <b>100m</b>
  Rounding to cylinder: 208845
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/tmp</b>
  > <b>a f</b>
  offset: [17221680] <b><i>Enter</i></b>
  size: [63071568] <b>2g</b>
  Rounding to cylinder: 4209030
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr/local</b>
  > <b>a g</b>
  offset: [21430710] <b><i>Enter</i></b>
  size: [58862538] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/usr/X11R6</b>
  > <b>a h</b>
  offset: [23535225] <b><i>Enter</i></b>
  size: [56758023] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/home</b>
  > <b>a j</b>
  offset: [25639740] <b><i>Enter</i></b>
  size: [54653508] <b>1g</b>
  Rounding to cylinder: 2104515
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/var</b>
  > <b>a k</b>
  offset: [27744255] <b><i>Enter</i></b>
  size: [52548993] <b><i>Enter</i></b>
  FS type: [4.2BSD] <b><i>Enter</i></b>
  mount point: [none] <b>/var/www</b>
  >
</pre></td></tr></table>

<p>
Remarquez que sur la partition <tt>/var/www</tt> ("k"), nous avons juste
utilisé le défaut pour utiliser tout l'espace disque restant.
Avec les disques modernes monstrueusement gros, c'est normalement une
mauvaise idée. Si vous savez que vous ne l'utiliserez jamais, ne l'allouez
pas, et gardez le pour des utilisations futures.

<p>
Maintenant, regardons le résultat, utilisant les commandes "p" et "p m" :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>p</b>
  OpenBSD area: 10490445-80293248; size: 69802803; free: 0
  #                size           offset  fstype [fsize bsize  cpg]
    a:           208845         10490445  4.2BSD   2048 16384    1 # /
    b:          2104515         10699290    swap
    c:         80293248                0  unused
    d:          4209030         12803805  4.2BSD   2048 16384    1 # /usr
    e:           208845         17012835  4.2BSD   2048 16384    1 # /tmp
    f:          4209030         17221680  4.2BSD   2048 16384    1 # /usr/local
    g:          2104515         21430710  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          2104515         23535225  4.2BSD   2048 16384    1 # /home
    i:         10490382               63    NTFS
    j:          2104515         25639740  4.2BSD   2048 16384    1 # /var
    k:         52548993         27744255  4.2BSD   2048 16384    1 # /var/www
  > <b>p m</b>
  OpenBSD area: 10490445-80293248; size: 34083.4M; free: 0.0M
    #                size           offset  fstype [fsize bsize  cpg]
    a:           102.0M         10490445  4.2BSD   2048 16384    1 # /
    b:          1027.6M         10699290    swap
    c:         39205.7M                0  unused
    d:          2055.2M         12803805  4.2BSD   2048 16384    1 # /usr
    e:           102.0M         17012835  4.2BSD   2048 16384    1 # /tmp
    f:          2055.2M         17221680  4.2BSD   2048 16384    1 # /usr/local
    g:          1027.6M         21430710  4.2BSD   2048 16384    1 # /usr/X11R6
    h:          1027.6M         23535225  4.2BSD   2048 16384    1 # /home
    i:          5122.3M               63    NTFS
    j:          1027.6M         25639740  4.2BSD   2048 16384    1 # /var
    k:         25658.7M         27744255  4.2BSD   2048 16384    1 # /var/www
  >
</pre></td></tr></table>

<p>
Comme sur fdisk, vous ne voulez pas que votre partition disklabel OpenBSD ne
se chevauche (autre que la partition 'c', qui chevauche tout, bien
évidemment).

<p>
Ecrivez vos changements et quittez disklabel :

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  > <b>w</b>
  > <b>q</b>
  No label changes.
  newfs: reduced number of fragments per cylinder group from 13048 to 12992 to
  enlarge last cylinder group
  /dev/rwd0a: 102.0MB in 208844 sectors of 512 bytes
  5 cylinder groups of 25.38MB, 1624 blocks, 3328 inodes each
  /dev/rwd0h: 1027.6MB in 2104512 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  newfs: reduced number of fragments per cylinder group from 13048 to 12992 to
  enlarge last cylinder group
  /dev/rwd0e: 102.0MB in 208844 sectors of 512 bytes
  5 cylinder groups of 25.38MB, 1624 blocks, 3328 inodes each
  /dev/rwd0d: 2055.2MB in 4209028 sectors of 512 bytes
  11 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0g: 1027.6MB in 2104512 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0f: 2055.2MB in 4209028 sectors of 512 bytes
  11 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0j: 1027.6MB in 2104512 sectors of 512 bytes
  6 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/rwd0k: 25658.7MB in 52548992 sectors of 512 bytes
  127 cylinder groups of 202.47MB, 12958 blocks, 25984 inodes each
  /dev/wd0a on /mnt type ffs (rw, asynchronous, local)
  /dev/wd0h on /mnt/home type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0e on /mnt/tmp type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0d on /mnt/usr type ffs (rw, asynchronous, local, nodev)
  /dev/wd0g on /mnt/usr/X11R6 type ffs (rw, asynchronous, local, nodev)
  /dev/wd0f on /mnt/usr/local type ffs (rw, asynchronous, local, nodev)
  /dev/wd0j on /mnt/var type ffs (rw, asynchronous, local, nodev, nosuid)
  /dev/wd0k on /mnt/var/www type ffs (rw, asynchronous, local, nodev, nosuid)

  Let's install the sets!
...
</pre></td></tr></table>

<p>
<a href="#BackMoredisklabel">(Revenir là où on aurait pu)</a>

<p>
<a name= "FilesNeeded"></a>
<h2>4.7 - Quels sont les fichiers nécessaires à l'installation ?</h2>
<!-- XXXrelease -->

<p>
L'installation complète d'OpenBSD est divisée en plusieurs <i>paquetages
de fichiers</i> séparés. 
Chaque application ne demande pas tous les paquetages de fichiers, cependant
on recommende aux nouveaux utilisateurs de TOUS les installer.

Voici une vue d'ensemble de chacun :
<p>
<ul>
  <li><b><i>bsd</i></b>          - Ceci est le noyau. <b>Requis</b>
  <li><b><i>bsd.mp</i></b>          - Noyau pour les systèmes multiprocesseurs
  (SMP) (seulement sur certaines plates-formes)
  <li><b><i>bsd.rd</i></b> - <a href="#bsd.rd">Kernel de disque RAM</a>
  <li><b><i>base46.tgz</i></b>   - Contient le système de base OpenBSD
    <b>Requis</b>
  <li><b><i>etc46.tgz</i></b>    - Contient tous les fichiers de /etc
    <b>Requis</b>
  <li><b><i>comp46.tgz</i></b> - Contient le compilateur et ses outils,
      en-têtes et bibliothèques <b>Recommandé</b>
  <li><b><i>man46.tgz</i></b> - Contient les pages de manuels
       <b>Recommandé</b>
  <li><b><i>misc46.tgz</i></b> - Contient différentes informations et
      documentations de configuration
  <li><b><i>game46.tgz</i></b>   - Contient les jeux pour OpenBSD
  <li><b><i>xbase46.tgz</i></b>  - Contient les librairies de base et 
  utilitaires pour X11
  <li><b><i>xetc46.tgz</i></b> - Contient les fichiers de configuration
      /etc/X11 et /etc/fonts
  <li><b><i>xfont46.tgz</i></b> - Contient le serveur de fontes X11 et
      les polices
  <li><b><i>xserv46.tgz</i></b>  - Contient les serveurs X de X11
  <li><b><i>xshare46.tgz</i></b> - Contient les pages de manuels, les
      options de localisations, les inclusions, etc. pour X
</ul>

Les paquetages <b>etc46.tgz</b> et <b>xetc46.tgz</b> ne sont pas installés lors
d'une mise à niveau mais uniquement lors d'une installation complète, de ce fait,
toute configuration que vous ferez sera conservée.
Vous devrez mettre à jour vos dossiers <tt>/etc</tt>, <tt>/dev</tt> et
<tt>/var</tt> manuellement.

<a name="FilesNeededX"></a>
<h3>Pourquoi dois-je installer X pour mes applications non-graphiques ?</h3>
Même si vous n'avez pas l'intention de faire tourner X, certains
<a href="faq15.html">paquetages</a> nécessitent que les bibliothèques
ou d'autres utilitaires présents dans X soient installées sur 
votre système. Cette dépendance peut facilement être résolue en installant
xbase46.tgz, le reste de X n'étant pas nécessaire.
Beaucoup de personnes résistent dans l'installation de X sur leur
système sans raison valable :


<ul>
<li>De lui-même, l'installation de X n'engendre pas l'exécution de
programmes sur le système.
<li>De lui-même, l'installation de X sur un système ne change pas
le risque de problèmes de sécurité externe.
<li>Si quelqu'un est déjà SUR votre système, il peut déjà installer ce qu'il 
veut, donc la présence ou l'absence de X ne change pas 
sensiblement la situation.
<li>Les seules parties de X qui s'exécutent sont celles
nécessaires à votre application.
<li>L'espace requis pour X est relativement modeste sur du matériel moderne.
</ul>
 
Les gens perdent quelquefois beaucoup de temps et d'efforts en essayant de
chercher et récuperer dans xbase46.tgz juste les fichiers dont ils ont besoin 
pour installer leir application.
Ce n'est pas seulement inutile, mais un effort qui devra être
répétée pour chaque cycle de mise à niveau, ce qui signifie probablement que
vous ne mettrez pas à jour votre système correctement, créeant de VERITABLES 
problèmes de sécurité.

<p>
SI vous avez besoin de X, installez le.
Cela ne vous fera pas plus mal que l'application qui en a besoin.

<a name="FilesNeededComp"></a>
<h3>Je ne désire pas installer les compilateurs</h3>
Ok, ne le faite pas, mais s'il vous plait ne vous dites pas que c'est pour
des "raisons de sécurité".
Avec le temps quelqu'un qui est sur votre système n'a que faire de la
présence ou l'absence de compilateur, il peut facilement l'installer
lui-même.
Cependant, le paquetage de fichiers compXX.tgz est relativement gros et
contient de nombreux fichiers, donc cela peut prendre du temps à l'installer
et le mettre à jour, et sur des petits ou lents systèmes, cela peut compter.

<p>
Si vous décidez de ne pas installer le compilateur, vous aurez certainement
besoin d'un autre système pour maintenir et contruire les mises à jour des
logiciels.
Il y a eu beaucoup plus de système qui ont été compromis à cause d'une
mauvaise maintenance plutôt qu'a cause d'un compilateur installé.

<p>
<a name="Partitioning"></a>
<h2>4.8 - Comment est-ce que je dois partitionner mon disque  ?</h2>
<!-- XXXrelease -->

<p>
Evidemment, la réponse à cette question dépend de l'utilisation que vous
voulez faire du système.
OpenBSD peut-être installé sur un espace aussi petit de 512M, mais
l'installer sur un périphérique aussi petit nécessite d'être un utilisateur
avancé.
Tant que vous n'avez pas d'expérience, un HD de 4G ou 8G est recommandé pour
démarrer. 

<p>
A l'inverse de beaucoup d'autres OSs, OpenBSD encourage ces utilisateurs à
partitionner leur disque en un nombre de partitions, plutôt que d'avoir une
ou deux grosses partitions
Il y a un nombre important de raisons pour partitionner son disque :

<ul>
<li><b>Sécurité :</b> Vous pouvez marquer certains systèmes de fichiers
  d'un 'nosuid', 'nodev', 'noexec', 'readonly', etc. 
  Cela est fait par la procédure d'installation, si vous utilisez les 
  partitions recommandées.
<li><b>Stabilité :</b> Un utilisateur, ou un programme se conduisant mal,
  peut remplir votre système de fichiers s'il a les droits d'écriture
  pour le faire. Vos programmes critiques, qui bien sûr sont lancés sur
  un système de fichier à part, ne seront pas interrompus.
<li><b>Vitesse :</b> Un système de fichiers sur lequel on écrit souvent
  peut devenir quelque peu fragmenté.
  (Par chance, le système de fichiers ffs utilisé par OpenBSD n'est pas
  enclin à être très fragmenté.)
<li><b>Intégrité</b> : Si un système de fichiers est corrompu pour
  quelque raison que ce soit, les autres restent en bon état.
<li><b>Taille :</b> Beaucoup de machines ont une limite sur la
  taille de la zone d'un disque d'où la ROM de démarrage peut charger le
  noyau. Dans certains cas, cette limite peut être vraiment basse (504Mo
  pour un ancien 486), dans d'autre cas, elle peut être plus grande (par
  exemple 2Go, 8Go ou 128Go sur les systèmes i386). Comme le système
  peut être installé n'importe où sur la partition racine, la totalité
  de la partition racine devrait être comprise dans cette zone. Pour
  plus de détails, regardez <a href="faq14.html#LargeDrive">cette
  section</a>. Une bonne ligne de conduite peut être de conserver votre
  partition / inférieure à 2Go, dans le cas où vous ne savez pas si
  votre architecture (et votre machine) peuvent en supporter plus (ou
  moins).
<li><b>Lecture seule :</b> Vous pouvez monter des partitions que vous
  utilisez rarement ou jamais en écriture en "Lecture seule" la plupart du
  temps, ce qui éliminera le besoin de fsck(8) aprés un crash ou un arrêt
  électrique, et previendra l'altération inattendue de données. 
<li><b>fsck(8) :</b> Les trés grandes partitions requiérent plus de RAM pour
  fsck(8), et sur un système avec peu de mémoire, vous pouvez finir par
  utiliser l'espace de pagination, donnant des temps trés long pour fsck.
</ul>

Donner un espace disque suffisant, la procédure d'installation d'OpenBSD
créera par défaut les partitions suivantes :

<ul>
<li><b>/ - root :</b>
En plus d'être l'endroit ou les autres systèmes de fichiers seront montés,
le système de fichiers racine contient tous les fichiers nécessaires pour
démarrer OpenBSD.
Cela inclu le noyau, les utilitaires de base dans <tt>/sbin</tt> et 
<tt>/bin</tt>, les fichiers de configuration dans <tt>/etc</tt>, le
répertoire périphérique, <tt>/dev</tt> qui sont tous utilisés pour mettre en
place le système.
Le système de fichiers racine peut-être aussi petit que 60M, de 100M à 200M
cela sera plus simple pour une machine de faire des cycles de mise à jour.
La partition 'a' de votre disque de démarrage devient automatiquement votre
partition racine.
CERTAINES plateformes donnent des restrictions sur l'emplacement physique du
disque (par exemple le premier disque) pour pouvoir démarrer.

<li><b>Swap :</b>
En plus d'être l'espace de pagination, cette partition est aussi utilisée
pour stocker les "core dumps" après un crash du système, il est donc suggéré
que l'espace de pagination (si il est mis en place) soit plus grand que la
plus grande quantité de RAM jamais disponible sur votre machine.
Vous pouvez en savoir plus dans la <a href="faq14.html#Swap">FAQ 14, Swap</a>.  

<li><b>/tmp :</b>
C'est le répertoire accessible en écriture par tous utilisé comme (comme son
nom l'indique) espace de stockage temporaire.
La plupart des systèmes pourront utiliser une quantité de stockage modeste
ici, 50M est courant et supérieur à ce que vous n'aurez jamais besoin, mais
il y a quelques applications qui peuvent en utiliser beaucoup, beaucoup plus.
Bien que ce répertoire soit accessible en écriture par tous, quand il est
dans une partition séparée, OpenBSD le monte par défaut avec nodev et
nosuid, ce qui minimise son action pour abuser le système.
Remarquez que ce répertoire est vider au redémarrage, et les fichiers non
touchés depuis plus de 24 heures sont supprimés.

<li><b>/var :</b>
Ce répertoire et point de montage est utilisé pour BEAUCOUP de choses, et en
fonction de votre utilisation, peut-être un candidat de choix pour être
subdivivé en plus de partitions.
Certaines des choses qui se retrouvent ici (et potentiellement des points de
montage supplémentaires) :
<ul>
  <li><tt>/var/log</tt> : Journaux système.
  <li><tt>/var/mail</tt> : Boites de messagerie en entrée.
  <li><tt>/var/spool</tt> : Envoi des messages (et d'autres choses)
  <li><tt>/var/www</tt> : Le
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8">serveur web</a> 
  d'OpenBSD vit ici.
  <li><tt>/var/tmp</tt> : C'est un répertoire de fichiers temporaires
  persistent, les fichiers placés ici NE sont PAS supprimés au redémarrage.
  Par exemple, vi(1) utilise ce répertoire pour le stockage temporaire, donc
  si votre ordinateur plante ou redémarre pendant que vous éditez un
  fichier, les fichiers trouvés ici peuvent être utilisés pour récuperer
  votre session d'édition.
  Les fichiers laissés ici plus de 24 heures seront supprimés par un script
  de nettoyage chaque nuit,
  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>.
  <li><tt>/var/crash</tt> : Si le système panique, il essaiera de
  sauvegarder un core dump dans la partition d'espace de pagination avant de
  redémarrer.
  Ce core dump sera ensuite sauvegardé dans <tt>/var/crash</tt> au
  redémarrage, donc <tt>/var</tt> a besoin d'au moins autant d'espace disque
  que le système de RAM pour que cela fonctionne automatiquement.
</ul>

<li><b>/usr :</b>
C'est ici que réside la plus grande partie d'OpenBSD.
Les programmes binaires, librairies, documentation, pages de manuel, etc...
sont tous localisés dans le répertoire <tt>/usr</tt>.
Les fichiers dans ce point de montage sont rarement modifiés -- dans la
plupart des cas, vous pouvez facilement monter la partition <tt>/usr</tt> en
lecture seule sans aucun changement système jusqu'a la prochaine mise à jour
ou changement de version.

<li><b>/usr/X11R6 :</b>
C'est ici que le système X Window réside.
Les binaires X, fichiers de fontes, librairies, etc... sont tous ici.
La seule chose qui n'est pas ici ce sont les fichiers de configuration.

<li><b>/usr/local :</b>
Sur une installation d'OpenBSD par défaut, ce point de montage/répertoire
est complétement vide.
Il est utilisé pour installer localement des binaires et librairies
d'applications locales.

<li><b>/usr/src :</b>
Ce répertoire comprend les fichiers des sources basiques du système,
excluant X et les ports.
Ce répertoire est vide par défaut, vous devez le remplir comme c'est
expliqué dans la <a href="faq5.html#BldGetSrc">FAQ 5</a>.

<li><b>/usr/obj :</b>
Ce répertoire est utilisé lors du prcessus de construction avec des fichiers
objets et binaires.
Avoir ce répertoire comme point de montage permet de le formatter plutôt que
d'effacer fichier par fichier, ce qui est beaucoup plus rapide.

<li><b>/home :</b>
C'est ici que vont les fichiers des utilisateurs.
L'avoir comme une partition distincte permet de reinstaller plus facilement
votre système; il faut simplement ne pas formatter cette partition au
chargement.
</ul>

<p>
Quelques remarques sur le partitionnement :
<ul>
 <li>Pour votre première tentative sur un système d'expérimentation, une
   grosse partition <tt>/</tt> et une zone "swap" devraient être plus
   simples jusqu'à ce que vous sachiez combien de place vous est
   nécessaire.
   En faisant cela vous sacrifierez certaines fonctions de sécurité
   d'OpenBSD qui requièrent des systèmes de fichiers séparés pour
   <tt>/, /tmp, /var, /usr</tt> et <tt>/home</tt>.
   Cependant, vous ne devriez probablement pas mettre votre première
   installation OpenBSD en production.
 <li>Un système exposé à l'Internet ou à d'autres forces hostiles devrait
   avoir une partition <tt>/var</tt> séparée (et peut être même une
   partition <tt>/var/log</tt> séparée) pour la journalisation.
 <li>Une partition <tt>/home</tt> peut être intéressante. Nouvelle version
   de l'OS ? Supprimez et rechargez tout le reste, conservez votre
   partition <tt>/home</tt> intacte. Rappelez vous de garder une copie
   de vos fichiers de configuration tout de même.
 <li>Une partition séparée pour tout ce qui risque d'accumuler une grosse
   quantité de fichiers qui devront être supprimés peut être plus rapide
   à reformater puis re-créér que de supprimer les fichiers. Regardez la
   <a href="faq5.html#ProbObjPt">FAQ de la compilation du code source</a>
   pour un exemple (<tt>/usr/obj</tt>).
 <li>Si vous souhaitez reconstruire votre système depuis les sources pour
   quelque raison que ce soit, les sources seront dans <tt>/usr/src</tt>. Si vous
   ne faites pas une partition séparée pour <tt>/usr/src</tt>, soyez sûr
   que <tt>/usr</tt> est suffisamment grand.
 <li>Un fait souvent oublié : vous n'avez <b>pas</b> besoin d'allouer toute
   la place sur un disque quand vous configurez un système ! Etant donné
   qu'il est maintenant compliqué de trouver un disque dur plus petit que 100Go, il
   devient sensé de laisser une certaine portion du disque non allouée.
   Si vous dépassez la taille d'une partition, vous pouvez allouer une
   nouvelle partition dans l'espace non utilisé,
   <a href="faq10.html#DupFS">dupliquer</a> votre partition existante sur
   la nouvelle, changer
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab</a>
   pour pointer vers votre nouvelle partition, la remonter, vous disposez maintenant
   de plus d'espace.
 <li>Si vous créez vos partitions avec une taille trop proche de la taille
   minimum requise, vous allez probablement le regretter plus tard lorsqu'il
   sera temps de mettre à jour votre système.
 <li>Si vous créez des partitions très larges, il est à signaler que la
     vérification des systèmes de fichiers à l'aide de
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fsck&amp;sektion=8">fsck(8)</a>
     nécessite approximativement 1Mo de RAM par gigaoctet, et peut être
     très consommatrice en temps voire infaisable sur des systèmes
     anciens et lents (merci de consulter <a
     href="faq14.html#LargeDrive">cette section</a>).
 <li>Si vous autorisez les utilisateurs à écrire dans <tt>/var/www</tt>
     (ex. pages web personnelles), vous devriez le placer dans une
     partition séparée, vous pouvez par exemple utiliser les <a
     href="faq10.html#Quotas">quotas</a> pour restreindre la place
     qu'ils utiliseront, de manière à ce que s'ils remplissent la
     partition, les autres parties du système ne seront pas affectées.
 <li>Vous pourrez éventuellement créer une partition <tt>/altroot</tt>
     tel que décrit dans
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=daily&amp;sektion=8">daily(8)</a>.
     Ceci fera une copie quotidienne de votre partition <tt>/</tt>, vous
     fournissant ainsi une copie supplémentaire de votre noyau et de vos
     fichiers de configuration <tt>/etc</tt> si jamais quelque chose
     devait arriver à votre partition racine.
     Bien évidemment, la partition <tt>/altroot</tt> devrait être aussi
     grande que <tt>/</tt>.
     Si vous disposez d'un second disque et vous avez quelque chose qui
duplique le reste de votre disque, soit du
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=raid&amp;sektion=4">raid(4)</a>
     logiciel ou une une copie périodique utilisant
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>/
   <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>,
     ce disque peut être amorcé après le retrait du disque principal.
 <li>Compiler certains <a href="faq15.html#Ports">ports</a> des sources peut
     utiliser beaucoup d'espace disque sur vos partitions <tt>/usr</tt> et
     <tt>/tmp</tt>.
     C'est une autre raison de vous suggérer d'utiliser les 
     <a href="faq15.html#PkgMgmt">paquetages pré-compilés</a> à la place.
 <li>Certains éditeurs utilisent <tt>/var/tmp</tt> pour de l'espace en cas
     de plantage, et nécessite donc qu'elle soit aussi grande que le plus
     grand fichier que vous éditez.
     Si vous pensez éditer des fichiers de 500M, votre partition
     <tt>/var</tt> ou <tt>/var/tmp</tt> doit être plus grande que les
     fichiers que vous pensez éditer.
      
</ul>

<p>
<a name= "Multibooting"></a>
<h2>4.9 - Multiboot OpenBSD</h2>

Le "Multibooting" est le fait d'avoir plusieurs systèmes d'exploitation
sur le même ordinateur, et de pouvoir choisir depuis lequel vous
souhaitez démarrer.
Ce n'est <i>pas</i> une tâche triviale ! Si vous ne comprenez pas ce que
vous êtes en train de faire, vous finirez par perdre une somme
conséquente de données sur votre ordinateur. Les nouveaux utilisateurs OpenBSD
sont <i>vivement</i> encouragés a démarrer avec un disque dur vierge et sur une
machine dédiée, afin d'essayer la configuration désirée sur un
système qui n'est pas en production avant d'installer une configuration
"multiboot" sur une machine de production. <a href="faq14.html">La FAQ 14</a>
donne plus d'informations sur la procédure d'amorçage d'OpenBSD.

<p>
Seule une partition parmi les quatre partitions MBR <i>primaires</i>
peut être utilisée pour démarrer OpenBSD (i.e., les partitions étendues
ne fonctionneront pas).

<p>
Voici plusieurs options pour le "multiboot" :

<h3>Configurer la partition active</h3>

C'est probablement la solution la plus négligée, et parfois la plus
intéressante pour le "multiboot".
Configurez simplement comme partition active, la partition d'OS depuis
laquelle vous souhaitez démarrer par défaut au prochain démarrage.
Chaque OS offre un programme pour faire ceci ; celui
d'OpenBSD est <a href="faq14.html#fdisk">fdisk(8)</a>, des programmes
portant des noms similaires sont disponibles sous Windows 9x et DOS,
et la plupart des autres systèmes d'exploitation. Ceci peut être très
utile pour les OS ou systèmes long à s'arrêter et redémarrer -- vous
pouvez le configurer et lancer la procédure de redémarrage,  ensuite
aller faire un tour, prendre une tasse de café, et revenir devant le
système démarré comme vous le souhaitiez -- pas d'attente du Moment
Magique pour choisir le système d'exploitation désiré.

<h3>Disquette d'amorçage</h3>
Si vous avez un système qui utilise OpenBSD peu fréquemment (ou que vous
ne voulez pas que les autres utilisateurs de l'ordinateur notent que quoi
que ce soit ai changé), vous pouvez utiliser une disquette d'amorçage.
Utilisez simplement l'une des <a href="#MkFlop">disquettes d'installation
standard d'OpenBSD</a>, et créez un fichier <tt>/etc/boot.conf</tt>
(oui, vous devrez aussi créer un dossier <tt>/etc</tt> sur la disquette)
ayant le contenu suivant :

<pre>
     boot hd0a:/bsd
</pre>

pour que le système démarre sur le disque dur 0, la partition OpenBSD
'a' et le fichier de noyau <tt>/bsd</tt>. Notez que vous pouvez aussi
démarrer d'autres disques avec une ligne comme :
"<tt>boot hd2a:/bsd</tt>" pour lancer le troisième disque dur de votre
système. Pour lancer OpenBSD, insérez la disquette dans le lecteur et
redémarrez. Pour lancer un autre système d'exploitation, éjectez la
disquette et redémarrez.
(Vous pouvez, bien évidemment, utilisez cette disquette pour créer un CD
démarrable aussi)

<p>
Le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>
chargé depuis la disquette, cherche et lit
<tt>/etc/boot.conf</tt>. L'instruction "<tt>boot hd0a:/bsd</tt>" indique
à boot(8) depuis quel endroit charger le noyau -- dans ce cas, le premier
disque dur que le BIOS voit. Gardez à l'esprit que seulement un petit
fichier (<tt>/boot</tt>) est chargé depuis la disquette -- le système
charge le noyau entier depuis le disque dur, cela ne ralentit que de
quelques secondes la procédure de démarrage.

<h3>Windows NT/2000/XP NTLDR</h3>

Pour un "multiboot" entre OpenBSD et Windows NT/2000/XP, vous pouvez
utiliser NTLDR, le chargeur de démarrage que NT utilise. Pour "multi-booter"
avec NT, vous aurez besoin d'une copie de votre "Partition Boot Record" (PBR)
OpenBSD. Après avoir lancé "installboot" vous pouvez en obtenir une copie dans un
fichier en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>,
en suivant une procédure similaire à la procédure suivante :

<pre>
        # <strong>dd if=/dev/rsd0a of=openbsd.pbr bs=512 count=1</strong>
</pre>

Remarque : ceci est une excellente occasion pour vous rappeler que
saisir bêtement des commandes auxquelles vous ne comprenez rien est
vraiment une mauvaise idée. La commande ci-dessus ne fonctionnera pas
directement sur la plupart des machines. Au lecteur de l'adapter à son
équipement.

<p>
Maintenant démarrez sous NT et mettez <tt>openbsd.pbr</tt> dans C:. Ajoutez
une ligne comme celle-ci à la fin du fichier <tt>C:\BOOT.INI</tt> :

<pre>
        c:\openbsd.pbr="OpenBSD"
</pre>

<p>
Quand vous redémarrerez, vous devriez être en mesure de choisir OpenBSD
dans le menu de chargement NT. D'autres informations sur le NTLDR sont
disponibles dans le
<a href="http://www.tburke.net/info/ntldr/ntldr_hacking_guide.htm">"NTLDR
Hacking Guide"</a>.

<p>
Sur Windows XP vous pouvez aussi éditer les informations en utilisant la
"GUI" ; consultez le
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;289022">XP
Boot.ini HOWTO</a>.
 

<p>
Des programmes faisant la plupart de ce travail sont à votre disposition,
par exemple
<a href="http://www.winimage.com/bootpart.htm">BootPart</a>.
Ce programme peut être lancé depuis Windows NT/2000/XP, et ira chercher
le PBR OpenBSD, le mettra dans votre partition NT/2000/XP partition et
le rajoutera dans <tt>C:\BOOT.INI</tt>.

<p>
Note : Le chargeur de démarrage Windows NT/2000/XP est seulement capable
de démarrer des systèmes depuis le premier disque dur.
Vous ne pouvez pas l'utiliser pour charger OpenBSD depuis le second
disque sur un système.

<h3>Windows Vista</h3>

<p>
Avec Vista, Microsoft a supprimé le support de NTLDR en faveur de leur
nouveau stockage des données de configuration de démarrage (BCD) utilisé
pour contrôler l'environnement de démarrage. Depuis que <tt>BOOT.INI</tt>
n'est plus disponible pour la configuration, un utilitaire en ligne de
commande, <tt>bcdedit</tt>, le remplace.

<p>
Des que la PBR OpenBSD est copiée dans la partition système Vista, les trois
commandes suivantes sont nécessaires pour sélectionner et démarrer OpenBSD
quand le système redémarre :

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /create /d "OpenBSD/i386 4.6" /application bootsector
The entry {05a763ce-d81b-11db-b3ec-000000000000} was successfully created.

C:\Windows\System32>
</pre></blockquote>

<p>
Le GUID retourné ici, <tt>05a763ce-d81b-11db-b3ec-000000000000</tt>,
est affiché pour l'exemple. Il faut noter que le GUID affiché quand vous
utiliserez cet commande devra être copié dans les commandes suivantes. En
copiant simplement le GUID affiché ici ne fonctionnera pas.

<p>
Les deux commandes suivantes sont aussi nécessaires :

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /set {05a763ce-d81b-11db-b3ec-000000000000} device boot
The operation completed successfully.

C:\Windows\system32> bcdedit /set {05a763ce-d81b-11db-b3ec-000000000000} path \openbsd.pbr
The operation completed successfully.

C:\Windows\system32>
</pre></blockquote>

<p>
Il faut remarquer que le chemin absolu du fichier PBR importé. N'ajoutez pas
de lettre de lecteur car il est acqui que le fichier est placé dans la
partition système.
<tt>bcdedit</tt> ne se plaindra pas de la fourniture d'un lecteur
spécifique, mais le gestionnaire de démarrage se plaindra plus tard qu'il ne
peut pas résoudre le chemin fourni.

<p>
Aprés redémarrage, Vista sera le premier affiché dans le gestionnaire de
démarrage suivi de OpenBSD. En sélectionnant ll'une des deux entrée vous
démarrerez le système d'exploitation selectionné.

<p>
Pour plus d'informations, consultez l'aide de <tt>bcdedit</tt> en tapant :

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /?
</pre></blockquote>

<p>
ou en cherchant dans la documentation de Microsoft ou sur le site Web. Une
bonne introduction peut-être trouvée sur cet article TechNet
<a href="http://technet.microsoft.com/en-us/library/cc721886%28WS.10%29.aspx">
Frequently Asked Questions</a>.
 
<p>
Pour ceux qui trouvent cette configuration manuelle compliquée,
<a href="http://neosmart.net/dl.php?id=1">EasyBCD</a> fournit une
alternative GUI.

<h3>Windows 7</h3>

<p>
Ce qui suit a été vérifié en utilisant Windows 7 Release Candidate Build 7100.

<p>
Microsoft a amélioré BCD depuis Vista en permettant plusieurs versions de
Windows de démarrer à travers<tt>bcdedit</tt>.  A cause de ce plus grand
contrôle, cinq commandes sont nécessaires pour configurer un environnement
multiboot avec OpenBSD.

<p>
Apres la copie de la PBR OpenBSD dans la partition système de Windows 7, il
faut taper les commandes suivantes pour initialiser les registres
nécessaires :

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /create /d "OpenBSD/i386 4.6" /application bootsector
The entry {0154a872-3d41-11de-bd67-a7060316bbb1} was successfully created.

C:\Windows\system32>
</pre></blockquote>

<p>
Comme signalé précedemment, le GUID 
<tt>{0154a872-3d41-11de-bd67-a7060316bbb1}</tt> est dépendent du système.
Conservez la valeur que vous avez lors de l'execution et copiez la dans les
commandes suivantes : 

<p>
<blockquote><pre>
C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} device boot
The operation completed successfully.

C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} path \openbsd.pbr
The operation completed successfully.

C:\Windows\system32> bcdedit /set {0154a872-3d41-11de-bd67-a7060316bbb1} device partition=c:
The operation completed successfully.

C:\Windows\system32> bcdedit /displayorder {0154a872-3d41-11de-bd67-7060316bbb1} /addlast
The operation completed successfully.

C:\Windows\system32>
</pre></blockquote>

<p>
A l'écriture de cette FAQ, Windows 7 n'est pas encore officiellement sortie.
Il serait prudent pour les utilisateurs de consulter la documentation
Microsoft et le site Web pour plus d'informations. Des détails peuvent être
modifiés.

<p>
<h3>Autres chargeurs de démarrage</h3>

<p>
D'autres utilisateurs de chargeurs de démarrage OpenBSD ont inclus avec
succès
<a href="http://gag.sourceforge.net/">GAG</a>,
<a href="http://www.ranish.com/part/">The Ranish Partition Manager</a>,
<a href="http://refit.sourceforge.net/">rEFIt</a>
et <a href="http://www.gnu.org/software/grub/">GRUB</a>.

<p>
<h3>OpenBSD et Linux (i386)</h3>
<!-- XXXversion -->

<p>
Veuillez vous référer au
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/4.6/i386/INSTALL.linux">INSTALL.linux</a>,
qui donne les instructions en profondeur pour faire fonctionner OpenBSD avec Linux.

<h3>Problèmes de fuseau horaire</h3>
OpenBSD s'attend à ce que l'horloge de la machine soit réglée sur UTC
("Universal Coordinated Time" - Temps universel coordonné).
D'autres systèmes d'exploitation s'attendent au contraire que celle-ci
soit réglée sur le fuseau local.
Bien évidemment, cela peut engendrer un certain problème si vous
utilisez ces deux types de systèmes sur une seule et même machine.
L'un ou l'autre aura besoin d'être configuré en conséquence.
Plus d'informations sur cette manipulation sont disponibles dans la
<a href="faq8.html#TimeZone">FAQ 8 - Pourquoi mon horloge
avance/retarde-t-elle de plusieurs</a>

<a name= "SendDmesg"></a>
<h2>4.10 - Envoyer votre dmesg à dmesg@openbsd.org après l'installation</h2>

<p>
Rappelez vous, il est important pour les développeurs OpenBSD de garder une
trace de quels matériels fonctionnent, et de quels matériels ne fonctionnent 
pas parfaitement, incluant les capteurs matériels qui sont trouvés dans ces
machines.

<p>
Un commentaire de /usr/src/etc/root/root.mail
<blockquote><pre>
If you wish to ensure that OpenBSD runs better on your machines, please do us
a favor (after you have your mail system configured!) and type something like:
 # (dmesg; sysctl hw.sensors) | \
        mail -s "Sony VAIO 505R laptop, apm works OK" dmesg@openbsd.org
so that we can see what kinds of configurations people are running.  As shown,
including a bit of information about your machine in the subject or the body
can help us even further.  We will use this information to improve device driver
support in future releases.  (Please do this using the supplied GENERIC kernel,
not for a custom compiled kernel, unless you're unable to boot the GENERIC
kernel. If you have a multi-processor machine, dmesg results of both GENERIC.MP
and GENERIC kernels are appreciated.)  The device driver information we get from
this helps us fix existing drivers. Thank you!
</pre></blockquote>

<p>
Soyez sûr d'envoyer le mail depuis un compte sous lequel pour serez habilité
à recevoir pour que les développeurs puissent vous contacter s'il ont quelque
chose qu'il voudraient que vous testiez ou changiez afin que votre
configuration fonctionne. Il n'est pas important d'envoyer le mail depuis
la même machine que celle sur laquelle tourne OpenBSD, donc si cette
dernière n'est pas en mesure de recevoir des mails, faites simplement :

<pre>
$ (dmesg; sysctl hw.sensors) | mail your-account@yourmail.dom
</pre>
et transférez le message à
<pre>
 dmesg@openbsd.org
</pre>
Où <tt>your-account@yourmail.dom</tt> est votre compte de messagerie
régulier.

<p>
<b>NOTE</b>

<ul>
<li>Merci de n'envoyer que des dmesg concernant les noyaux GENERIC. Les
noyaux personnalisés qui ont des drivers de matériels en moins ne sont
pas utiles.
<li>Si vous avez un système multi-processeurs et utilisez généralement
le noyau GENERIC.MP, il est utile pour les développeurs d'avoir le dmesg
des deux noyaux GENERIC et GENERIC.MP ; merci de les envoyer dans des
emails différents.
<li>Les dmesgs sont reçus sur une machine utilisant le système de
filtrage de spam
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8">spamd</a>.
Cela peut causer le rejet temporaire de votre dmesg par les serveurs de mails.
Soyez patient, après une demi-heure voire une heure, il sera reçu.
</ul>

<p>
La méthode précédente est très simple mais si vous avez choisi de ne pas
configurer le système de messagerie de votre machine OpenBSD, vous
devriez toutefois envoyer votre dmesg aux développeurs. Sauvegardez
simplement la sortie de votre dmesg dans un fichier texte.

<pre>
$ (dmesg; sysctl hw.sensors) > ~/dmesg.txt
</pre>

Puis transférez ce fichier (en utilisant FTP/scp/floppydisk/pigeon
voyageur/...) vers le système depuis lequel vous utilisez votre
messagerie. Puisque la réception des messages dmesg est gérée
automatiquement, merci de vous référer aux recommandations suivantes
lors de l'utilisation de systèmes/clients de messagerie alternatifs :
<ul>
<li>Configurez votre client de messagerie afin que celui-ci envoie les
messages en tant que texte simple ("plain text") ; n'utilisez pas le
format HTML
<li>Désactivez le retour à la ligne automatique. De nombreux clients de
messagerie sont configurés pour effectuer un renvoi à la ligne
automatiquement à la 72è colonne (la norme pour les listes de diffusion).
<li>Soyez certains que votre client de reformatte pas les messages en
"text-flow"
<li>N'envoyez pas la sortie du dmesg en tant que fichier joint. Mettez
le dmesg directement dans le corps du message.
</ul>

<a name="AddFileSet"></a>
<h2>4.11 - Ajouter un paquetage après l'installation</h2>
<!-- XXXversion -->
"Oh non ! J'ai oublié de rajouter un paquetage quand j'ai fait l'installation !"
<p>
Parfois, vous réalisez que vous AURIEZ vraiment eu besoin de
<tt>comp46.tgz</tt> (ou de n'importe quel composant système) après tout,
mais vous ne l'avez pas réalisé quand vous avez installé votre système.
Bonne nouvelle : Il y a deux voies relativement simples pour rajouter un
paquetage après l'installation initiale :

<h3>En utilisant la procédure de mise à jour</h3>
Démarrez simplement votre média d'installation (CD-ROM ou disquette), et
choisissez "Upgrade" (plutôt que "Install"). Quand vous aurez la liste
des paquetages, sélectionnez simplement celui que vous avez oublié
d'installer la première fois, choisissez la source, et laissez-le
l'installer pour vous.

<h3>En utilisant tar(1)</h3>
Les paquetages d'installation sont de simples fichiers compressés tar, et
vous pouvez les décompresser vous même manuellement depuis la racine
du système de fichiers.

<p>
<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  # cd /
  # tar xzvpf comp46.tgz
</pre></td></tr></table>

<p>
N'oubliez PAS l'option <tt>'p'</tt> ci-dessus qui restaurera correctement
les permissions sur les fichiers !
<p>
Une méprise courante est de croire qu'il est possible d'utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pkg_add&amp;sektion=1">pkg_add(1)</a>
pour rajouter des sets d'installation manquants. Cela ne fonctionne pas.
pkg_add(1) est l'<a href="faq15.html#PkgMgmt">outil de gestion des
paquetages</a> pour installer des applications tierces.
Cet outil prend en compte les fichiers paquetages et non des archives tar
génériques telles que les ensembles d'installation.

<p>
Si vous installez l'ensemble de fichier <tt>xbase</tt> sur votre système
pour la première fois en utilisant tar(1) et sans redémarrer, le cache
des librairies partagées devra être mis à jour après installation en
utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ldconfig&amp;sektion=8"
>ldconfig(8)</a>.
Pour ajouter toutes les librairies X au cache :

<blockquote><pre>
# <b>ldconfig -m /usr/X11R6/lib</b>
</pre></blockquote>

Alternativement, vous pouvez juste redémarrer votre système, et ceci
sera fait automatiquement par le script de démarrage
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8"
>rc(8)</a>.

<a name="bsd.rd"></a>
<h2>4.12 - Qu'est ce que 'bsd.rd' ?</h2>

<b><tt>bsd.rd</tt></b> est un noyau "RAM Disk". Ce fichier peut
être vraiment intéressant ; beaucoup de développeurs prudents
en conservent un tout le temps à la racine de leur système.

<p>
Le noyau "RAM Disk" définit la racine du système de fichiers
du noyau -- plutôt qu'être stockés sur un disque physique, les utilitaires
disponibles après l'amorçage de <tt>bsd.rd</tt> sont enregistrés
dans le kernel, et lancés depuis un système de fichiers basé en
mémoire RAM.
<tt>bsd.rd</tt> comporte aussi une floppée d'utilitaires 
vous permettant de faire de la maintenance système et de lancer une
installation.
<p>
Sur certaines architectures, <tt>bsd.rd</tt> est actuellement la
méthode d'installation privilégiée -- vous placez ce noyau sur un
système de fichiers, vous le démarrez, et lancez l'installation
depuis ce dernier. Sur la plupart des architectures, si vous
utilisez une ancienne version d'OpenBSD, vous pouvez obtenir
une nouvelle version de <tt>bsd.rd</tt>  par FTP, redémarrer
à partir de lui, et installer la nouvelle version d'OpenBSD
sans avoir besoin de quelque média amovible que ce soit.

<p>
Voici un exemple d'amorçage de <tt>bsd.rd</tt> sur un système
i386 :

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>
  Using Drive: 0 Partition: 3
  reading boot.....
  probing: pc0 com0 com1 apm mem[639k 255M a20=on]
  disk: fd0 hd0+
  &gt;&gt; OpenBSD/i386 BOOT 3.02
  boot&gt; <b>boot hd0a:/bsd.rd</b>
<i>. . . normal boot to install . . .</i>
</pre></td></tr></table>

Comme indiqué, vous allez être amené au programme d'installation,
mais vous pouvez aussi aller à une invite de shell pour faire de
la maintenance sur votre système.
<p>
La règle générale en lançant <tt>bsd.rd</tt> est de changer votre
noyau d'amorçage de <tt>/bsd</tt> à <tt>bsd.rd</tt> quelle que soit
la méthode pour votre architecture.


<a name="InstProb"></a>
<h2>4.13 - Problèmes d'installation courants</h2>

<a name="cpq16m"></a>
<h3>4.13.1 - Mon Compaq ne reconnaît que 16Mo de RAM</h3>
<i>Certains</i> systèmes Compaq rencontrent un problème où la mémoire
RAM n'est pas complètement détectée par le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">Chargeur d'amorçage de second niveau OpenBSD</a>
et seulement 16Mo seront détectés et utilisés par OpenBSD.
Ceci peut être corrigé en créant/éditant le fichier
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot.conf&amp;sektion=8&amp;arch=i386"><tt>/etc/boot.conf</tt></a>,
ou en entrant des commandes à l'invite "<tt>boot></tt>" avant
qu'OpenBSD ne se charge. Si vous avez une machine avec 64Mo
de RAM, mais qu'OpenBSD n'en a détecté que 16Mo, la commande
devrait être :

<pre>
     machine mem +0x3000000@0x1000000
</pre>

pour ajouter 48Mo (<tt>0x3000000</tt>) après les premiers 16Mo
(<tt>0x1000000</tt>). Typiquement, si vous avez une machine avec
ce problème, vous devriez entrer la commande précédente d'abord
dans l'invite <tt>boot></tt> du CD-ROM ou de la Disquette, charger
la disquette, redémarrer et créer un fichier <tt>/etc/boot.conf</tt>
avec la ligne précédente pour que dans les démarrages suivants
OpenBSD reconnaisse toute la mémoire disponible.

<p>
Une mise à jour ROM règlera ce problème sur
<i>certains</i> systèmes.

<a name="noboot"></a>
<h3>4.13.2 - Mon i386 ne démarre pas après l'installation</h3>
Votre installation a eu l'air de bien se dérouler, mais lors
de votre premier démarrage, vous ne voyez aucun signe montrant
qu'OpenBSD essaye de démarrer. Plusieurs problèmes courants
peuvent expliquer ce phénomène :

<ul>
<li><b>Aucune partition n'a été définie active dans fdisk(8).</b>
Pour corriger cela, relancez la machine en utilisant une disquette
de démarrage ou tout autre média, et marquez une partition comme active.
Regardez
<a href="faq14.html#fdisk">ici</a> et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">ici</a>.

<li><b>Aucun chargeur de démarrage valide n'a été installé sur le disque.</b>
Si vous avez tapé "Enter" ou répondu "Y" à la question
"Use (W)hole disk or (E)dit the MBR?" pendant
l'installation, ou utilisé l'option "<tt>reinit</tt>"
de fdisk(8), l'amorce OpenBSD a été installée sur le "Master Boot Record"
du disque ; autrement, le programme d'amorce est conservé intact.
Ce sera un problème si aucun autre programme d'amorce n'existe.
Une solution est de démarrer le média d'installation une nouvelle fois,
basculer dans le shell et invoquer la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a> pour mettre à jour le MBR depuis la ligne de commande :
<pre>
  # fdisk -u wd0
</pre>
Note : l'option "update" du mode ("-e") interactif de fdisk n'écrira pas les
bits de signature requis pour rendre le disque amorçable.

<li><b>Dans quelques rares cas, quelque chose s'est mal déroulé dans
l'installation du chargeur de démarrage de stage 2.</b> La
réinstallation du chargeur de démarrage de stage 2
est vue <a href="faq14.html#InstBoot">ici</a>.

</ul>

<a name="sshhang"></a>
<h3>4.13.3 - Ma (vieille et lente) machine a démarré, mais bloque pendant
la procédure ssh-keygen</h3>
Il semble que votre machine fonctionne correctement, mais prend juste
beaucoup de temps pendant la procédure de génération de clés ssh.
Une SPARCStation2 ou un Macintosh Quadra peut prendre <i>plusieurs
heures</i> ou plus pour terminer les trois étapes
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-keygen&amp;sektion=1">ssh-keygen(1)</a>,
Laissez le simplement terminer ; cela n'est réalisé qu'une fois par
installation.

<p>
La taille de la clé par défaut a été augmentée pour OpenBSD 3.8, en
conséquence de quoi les temps de génération de clés sont beaucoup plus
élevés que ce qu'ils furent.
Les utilisateurs possédant des machines très lentes souhaiteront
peut-être générer leurs clés sur une autre machine, les placer dans
l'archive <a href="#site">site46.tgz</a>, et les installer avec le reste
des "file sets".


<a name="noftplist"></a>
<h3>4.13.4 - J'ai le message "Failed to change directory" pendant
     l'installation</h3>

Quand vous faites l'installation d'un
<a href="faq5.html#Flavors">snapshot</a> durant la
phase <i>-beta</i> du cycle de développement OpenBSD, vous devriez voir
ceci :

<table border=0 width="90%"><tr><td nowrap bgcolor="#EEEEEE"><pre>

  Display the list of known ftp servers? [no] <b>yes</b>
  Getting the list from 192.128.5.191 (ftp.openbsd.org)... FAILED
  Failed to change directory.
  Server IP address or hostname? 
</pre></td></tr></table>

Cela est normal et souhaité pendant la version précédant la sortie officielle
dans le cycle. Le programme d'installation cherche la liste FTP sur le
premier serveur FTP dans un dossier qui ne sera pas disponible avant
<a href="faq1.html#Next">la date de "release"</a>, vous obtiendrez
donc les messages précédents.

<p>
Utilisez simplement la
<a href="../../fr/ftp.html">liste de miroirs FTP</a> pour trouver votre
site miroir FTP favori, et entrez manuellement son nom lorsque
cela vous est demandé.

<p>
<b>Note : Vous ne devriez pas voir cela si vous installez une version
<i>"-release"</i> ou depuis un CD-ROM.</b>

<a name="blankfdisk"></a>
<h3>4.13.5 - Ma table de partition fdisk est corrompue ou vide !</h3>
Occasionnellement, un utilisateur trouvera un système fonctionnant, mais
en faisant un <tt>fdisk wd0</tt>, il trouvera une table de partitions
vide (ou polluée).
Cela est usuellement du à la création d'une partition dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386">fdisk(8)</a>
ayant un offset de zero secteur, au lieu de <a href="#trackoffset">l'offset
d'une piste</a> qu'elle est sensée avoir.
(note : cela ne concerne que les plates-formes
<a href="../../fr/i386.html">i386</a> et <a
href="../../fr/amd64.html">amd64</a>.
Les autres plates-formes requièrent des offsets différents, certaines n'en
requièrent pas).
Le système <a href="faq14.html#Boot386">démarre</a> ensuite en utilisant
le PBR, pas le MBR.

<p>
Bien que cette configuration peut fonctionner, cela peut causer des
problèmes de maintenance et devrait être corrigé. Pour corriger ce
problème, le système de fichiers doit généralement être recréé depuis
le début (si vous savez VRAIMENT ce que vous faites, vous devriez être
en mesure de recréer juste le disklabel et le MBR et ne perdre que la
première partition OpenBSD du disque).

<a name="noflopcd"></a>
<h3>4.13.6 - Je ne posséde pas de lecteur de disquette ou de CD-ROM sur ma
machine</h3>
Certaines personnes possédant un ordinateur pourraient vouloir utiliser OpenBSD
avec une absence évidente de moyen pour installer OpenBSD, n'ayant aucun
lecteur de disquette ou de lecteur de CD-ROM.
Soit la machine a été conçue sans eux (par exemple plusieurs portables ou
machines basées sur des "flash", comme les systèmes Soekris ou l'ALIX), ou
le périphérique de démarrage est défectueux ou absent, et est difficile à
remplacer.
Voici quelques conseils et techniques que vous pouvez utiliser pour installer
OpenBSD sur ces systèmes. 
<ul>
<li>Démarrage Réseau utilisant <a href="faq6.html#PXE">PXE</a> (i386 ou amd64) 
ou <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=diskless&amp;sektion=8">diskless(8)</a>
(autres plateformes).

<li>Lecteur de CD-ROM USB ou lecteur de disquette USB, si votre machine peut 
démarrer de l'un d'eux.

<li>Disque Flash USB ou disque dur, encore si votre ordinateur peut démarrer
d'un périphérique USB.
Préparez le périphérique sur un autre ordinateur comme décrit dans
<a href="faq14.html#flashmemLive">FAQ 14</a>.
Démarrez le mais choisissez le kernel bsd.rd, puis installez le normalement.
Vous pouvez aussi avoir les groupes de fichiers pré-chargés sur un média 
flash bien évidemment.

<li>Dans le pire de cas, si rien de ce qui a été décrit précedemment n'est
valable, vous pouvez eventuellement sortir le disque du système cible,
utiliser un adaptateur adapté pour l'installer dans un ordinateur "normal",
installer OpenBSD et replacer le disque dans le système cible.
OpenBSD démarrera bien maintenant dans la machine cible, vous devrez
peut-être trés probablement adapter la configuration réseau. 
Vous devrez aussi modifier <tt>/etc/fstab</tt> si vous avez (par exemple)
utilisé un adaptateur USB->IDE/SATA ou votre cible ou la machine utilise  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&amp;sektion=4">ahci(4)</a>
et l'autre pas.
Les disques IDE et certains SATA sont reconnus normalement comme des périphériques 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wd&amp;sektion=4">wd(4)</a>
, mais si ils sont connectés à un adaptateur USB, ils deviendront 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sd&amp;sektion=4">sd(4)</a>.
Un disque SATA connecté à une interface
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pciide&amp;sektion=4">pciide(4)</a>
sera vu comme wd(4), mais connecté à une interface 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ahci&amp;sektion=4">ahci(4)</a>
, deviendra un périphérique sd(4).
Cependant, des que vous aurez corrigé le fichier <tt>/etc/fstab</tt>, le
système démarrera normalement.

</ul>

Dans tous les cas, rappelez vous que la machine a eu un OS installé avant
cela et donc que cet OS pouvait être reinstallé.
Comment cela a été réalisé initialement vous donnera surement une bonne idée
de la façon d'installer OpenBSD maintenant.


<a name="site"></a>
<h2>4.14 - Personnaliser la procédure d'installation</h2>
<!-- XXXversion -->

<h3>Fichier <tt>siteXX.tgz</tt></h3>
Les scripts d'installation/mise à jour d'OpenBSD autorisent la création
d'un set utilisateur nommé "<tt>siteXX.tgz</tt>", où XX représente la
version (ex. 46). Le fichier <tt>siteXX.tgz</tt> est, comme les autres
<a href="#FilesNeeded">paquetages</a>, une compression
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gzip&amp;sektion=1">gzip(1)</a>
d'archive
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tar&amp;sektion=1">tar(1)</a>
dont la racine est '/' et est décompressé comme les autres avec les
options <tt>xzphf</tt>. Ce paquetage sera installé en dernier, après tous
les autres paquetages.

<p>
Ce paquetage vous permet d'ajouter et/ou écraser des fichiers installés
dans les paquetages 'normaux' et donc de personnaliser l'installation ou
la mise à jour.

<p>
Vous pouvez également créer des sets d'installation spécifiques à un
hôte, nommés <tt>siteXX-<i>&lt;hostname&gt;.tgz</i></tt>, par exemple,
"<tt>site46-puffy.tgz</tt>".
Cela facilite les installations customisées, mises à jour ou
récupération après désastre.

<p>
Quelques exemples d'utilisation de fichier <tt>siteXX.tgz</tt> :
<ul>
<li>Créer un fichier siteXX.tgz qui contient tous les changements
que vous avez fait depuis la première installation de OpenBSD. Ensuite,
si vous avez à récréer le système, sélectionnez simplement siteXX.tgz
pendant la procédure de réinstallation et toutes les modifications que
vous avez faites seront répliquées sur le nouveau système.

<li>Créer une série de dossiers spécifiques machine qui
contiennent chacun un fichier siteXX.tgz dans lequel se trouvent les
fichiers spécifiques à la machine.
L'installation de machines (ex. machines avec des cartes graphiques
différentes) d'une catégorie particulière peut être faite en choisissant
le fichier siteXX.tgz approprié.

<li>Mettez les fichiers que vous paramétrez constamment dans un fichier
siteXX.tgz similaire -- fichiers
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=adduser&amp;sektion=8"
><tt>/etc/skel</tt></a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"
><tt>/etc/pf.conf</tt></a>, 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=httpd&amp;sektion=8"
><tt>/var/www/conf/httpd.conf</tt></a>,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf.local&amp;sektion=8"
><tt>/etc/rc.conf.local</tt></a>,
etc.
</ul>

<h3>Scripts <tt>install.site</tt>/<tt>upgrade.site</tt></h3>
A la dernière étape de la procédure d'installation/mise à jour, le
script cherche dans la racine un <tt>install.site</tt> ou un
<tt>upgrade.site</tt> d'un nouveau système ou d'une nouvelle mise à
jour, selon la procédure en cours, et lance le script dans un
environnement
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=chroot&amp;sektion=8">chroot</a>é
de la racine système de l'installation/de la mise à jour.
Rappelez-vous, la mise à jour est faite depuis un système de fichiers
démarré donc votre système de fichiers cible est actuellement monté dans
<tt>/mnt</tt>.
Cependant, votre script peut être écrit tel quel à cause du chroot,
comme s'il était écrit dans la racine normale de votre système de
fichiers. Comme ce script est lancé après que tous les fichiers aient
été installés, vous avez la plupart des fonctionnalités d'un système 
complet quand votre script est executé.
Gardez en mémoire que vous exécutez un noyau minimal, toutes les
fonctionnalités ne sont pas disponibles, et à cause des contraintes
d'espaces, les choses qui fonctionnent aujourd'hui peuvent ne pas
fonctionner dans les prochaines versions.

<p>
Notez que le script <tt>install.site</tt> devra être placé dans un
fichier <tt>siteXX.tgz</tt>, tandis que le script <tt>upgrade.site</tt>
pourra être placé à la racine du système de fichiers avant la mise à jour
ou bien être placé lui aussi dans fichier <tt>siteXX.tgz</tt>.

<p>
Ce script peut être utilisé pour faire de nombreuses choses.
<ul>
<li> Supprimer des fichiers qui sont installés/mis à jour et que vous ne
souhaitez pas présents dans votre système.
<li> Supprimer/mettre à jour/installer les
<a href="faq15.html#PkgMgmt">paquetages</a> que vous souhaitez sur le système
installé (peut ne pas fonctionner pour tous les paquetages !).
<li> Faire une <a href="faq14.html#Backup">sauvegarde/archive immédiate</a>
de votre nouveau système avant de l'exposer au reste du monde.
<li>Utilisez
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rdate&amp;sektion=8">rdate(8)</a>
pour paramétrer l'horloge du système.
</ul>

<p>
La combinaison de <tt>siteXX.tgz</tt> et de
<tt>install.site/upgrade.site</tt> a pour but de donner de larges
capacités de personnalisation sans avoir à créer ses propres paquetages
d'installation.

<p>
Remarque : Si vous comptez effectuer votre installation à partir d'un
serveur HTTP, vous devez ajouter votre ou vos fichier(s)
<tt>site*.tgz</tt> au fichier <tt>index.txt</tt> se trouvant dans le
répertoire source afin que ce ou ces fichier(s) soi(en)t proposé(s) en
option durant l'installation.
Cette opération n'est pas nécessaire pour les installations à partir de
FTP ou toute autre type d'installation.


<a name="Multiple"></a>
<h2>4.15 - Comment puis-je installer plusieurs systèmes identiques ?</h2>
Voici quelques utilitaires que vous pouvez utiliser lorsque vous avez
plusieurs systèmes OpenBSD identiques à déployer.

<h3>Les fichiers <tt>siteXX.tgz</tt> et <tt>install/upgrade.site</tt></h3>
Voir l'article <a href="#site">précédent</a>.

<h3>Restauration depuis dump(8)</h3>
Sur la plupart des architectures, le média de démarrage inclut le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore(8)</a>
qui peut être utilisé pour restaurer une sauvegarde faite par
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&amp;sektion=8">dump(8)</a>.
Ainsi, vous pouvez démarrer depuis
<a href="#MkFlop">disquettes</a>,
<a href="../../orders.html">CD</a>, ou
fichier <a href="#bsd.rd">bsd.rd</a>, ensuite
<a href="faq14.html#fdisk">fdisk</a>,
<a href="faq14.html#disklabel">disklabel</a>, et
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&amp;sektion=8">restore</a>
pour restaurer la configuration désirée depuis une bande ou autre média, et installer les
<a href="faq14.html#InstBoot">blocs de d'amorce</a>. Plus de détails
<a href="faq14.html#Backup">ici</a>.

<h3>Image de disque</h3>
Malheureusement, il n'existe pas de paquetage d'image de disque reconnaissant
le FFS, et qui pourrait faire une image contenant simplement l'espace de
disque utilisé. La plupart des solutions d'image de disque traiteront
la partition OpenBSD comme une partition "générique", et pourront
simplement faire l'image de l'intégralité du disque. Cela rejoint
souvent notre but, mais souvent avec d'énormes quantités d'espace
perdu -- une partition <tt>/home</tt> de 10Go vide demandera 10Go
d'espace dans l'image, même s'il n'y a aucun fichier à l'intérieur.
Tandis que vous pouvez typiquement installer une image de disque sur un
disque plus grand, vous ne pourrez pas l'installer sur un disque de plus
petite taille.

<p>
Si cela est pour vous acceptable, vous devriez trouver dans la
commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd</a>
tout ce dont vous avez besoin, autorisant la copie d'un disque vers un
autre, secteur-par-secteur. Celui-ci vous fournira souvent les mêmes fonctionnalités que
les programmes commerciaux, sans le prix.

<a name="getdmesg"></a>
<h2>4.16 - Comment puis-je obtenir un dmesg(8) pour rapporter un
  problème d'installation ?</h2>
Lorsque vous <a href="../../fr/report.html">rapportez un problème</a>,
il est important d'inclure le
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a>
complet du système.
Souvent cependant, vous en avez besoin parce que le système ne fonctionne pas
correctement ou ne s'installe pas, donc vous n'aurez pas de disque, pas de réseau
ou manquerez d'une autre ressource vous permettant d'envoyer votre dmesg à la 
<a href="../../fr/mail.html">mailing liste</a> appropriée.
Il y a d'autres façons de faire cela, cependant :

<ul>
<li><b>Disquette :</b> Les disques d'amorçage et les CD-ROM ont assez d'outils
pour permettre d'enregistrer votre dmesg sur une disquette MSDOS afin de
le lire sur une autre machine. Mettez une disquette MSDOS formatée dans
votre lecteur de disquette et tapez les commandes suivantes :

<pre>
     mount -t msdos /dev/fd0a /mnt
     dmesg >/mnt/dmesg.txt
     umount /mnt
</pre>
Si vous avez un autre système OpenBSD, vous pouvez aussi écrire sur une
disquette compatible OpenBSD -- souvent, la disquette d'amorce a encore
assez d'espace libre pour contenir le dmesg. Dans ce cas, retirez le
"<tt>-t msdos</tt>" ci-dessus.

<p>
<li><b>Console série :</b>
Utiliser une console série et capturer la sortie sur un autre ordinateur
est souvent la meilleure solution pour obtenir des informations de
diagnostic - particulièrement si l'ordinateur "panic" immédiatement
après le démarrage.
Aussi bien qu'un second ordinateur, vous aurez besoin d'un câble série
(souvent un câble null-modem), et d'un émulateur de terminal pouvant
capturer la sortie de l'écran dans un fichier.

<p>
Des informations sur la configuration d'une console série sont données
<a href="faq7.html#SerCon">ailleurs dans la FAQ</a>; dans le but de
capturer le log de l'installation, les commandes suivantes sont souvent
suffisantes.

<p><b>i386</b>

<p>
A l'invite de démarrage tapez :
<p>
<blockquote>
<pre>
boot> <b>set tty com0</b>
</pre>
</blockquote>

<p>
Cela indiquera à OpenBSD d'utiliser le premier port série (souvent
appelé COM1 ou COMA dans la documentation du PC) en tant que console série.
La bande passante par défaut est 9600 bauds.

<p><b>Sparc/Sparc64</b>

<p>
Ces machines utiliseront automatiquement une console série si elles sont
lancées sans clavier.
Si vous avez un clavier et un écran attachés, vous pouvez toujours
forcer le système à utiliser une console série avec l'invocation
suivante à l'invite <tt>ok</tt>.

<p>
<blockquote>
<pre>
ok <b>setenv input-device ttya</b>
ok <b>setenv out-device ttya</b>
ok <b>reset</b>
</pre>
</blockquote>

</ul>

<p>

<font color= "#0000e0">
<a href= "index.html">[Retour à l'Index principal]</a>
<a href= "faq3.html">[Section 3 - Démarrer avec OpenBSD]</a>
<a href= "faq5.html">[Section 5 - Construire le Système à partir des Sources]</a>
</font>

<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[back]"></a> 
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq4.html,v 1.295 ]<br>
$Translation: faq4.html,v 1.119 2010/03/08 22:15:39 benoit Exp $<br>
-->
$OpenBSD: faq4.html,v 1.96 2010/03/09 08:43:35 ajacoutot Exp $
</small>
</body>
</html>
